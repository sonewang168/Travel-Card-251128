<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ—…éŠç§˜æ›¸">
    <meta name="theme-color" content="#0f172a">
    <title>æ—…éŠç§˜æ›¸ v4 - é»æ»´ç‰ˆ</title>
    
    <link rel="manifest" href="data:application/json;charset=utf-8,%7B%22name%22%3A%22%E6%97%85%E9%81%8A%E7%A7%98%E6%9B%B8%22%2C%22short_name%22%3A%22%E6%97%85%E9%81%8A%E7%A7%98%E6%9B%B8%22%2C%22start_url%22%3A%22.%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%230f172a%22%2C%22theme_color%22%3A%22%2306b6d4%22%7D">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%2306b6d4'/%3E%3Cstop offset='100%25' stop-color='%23ec4899'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='180' height='180' fill='%230f172a' rx='40'/%3E%3Ccircle cx='90' cy='90' r='60' fill='url(%23g)'/%3E%3Ctext x='90' y='105' font-size='60' text-anchor='middle'%3Eâœˆï¸%3C/text%3E%3C/svg%3E">
    
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-card-hover: #334155;
            --cyan: #06b6d4;
            --cyan-glow: rgba(6, 182, 212, 0.3);
            --purple: #a855f7;
            --purple-glow: rgba(168, 85, 247, 0.3);
            --emerald: #10b981;
            --emerald-glow: rgba(16, 185, 129, 0.3);
            --orange: #f59e0b;
            --orange-glow: rgba(245, 158, 11, 0.3);
            --pink: #ec4899;
            --pink-glow: rgba(236, 72, 153, 0.3);
            --red: #ef4444;
            --text-light: #e2e8f0;
            --text-dim: #94a3b8;
            --text-muted: #64748b;
            --border: #334155;
            --nav-height: 70px;
            --header-height: 60px;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html, body { height: 100%; overflow: hidden; touch-action: manipulation; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif; background: var(--bg-dark); color: var(--text-light); line-height: 1.5; }
        
        .app-container { height: 100%; display: flex; flex-direction: column; padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); }
        
        .app-header { height: var(--header-height); background: linear-gradient(135deg, var(--cyan) 0%, var(--purple) 100%); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; flex-shrink: 0; }
        .app-logo { display: flex; align-items: center; gap: 10px; font-size: 1.2em; font-weight: 700; }
        .header-actions { display: flex; gap: 8px; }
        .header-btn { width: 40px; height: 40px; border: none; background: rgba(255,255,255,0.2); border-radius: 12px; color: white; font-size: 1.3em; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        
        .app-content { flex: 1; overflow: hidden; position: relative; }
        .page { position: absolute; top: 0; left: 0; right: 0; bottom: 0; overflow-y: auto; padding: 16px; padding-bottom: calc(var(--nav-height) + 20px); display: none; -webkit-overflow-scrolling: touch; }
        .page.active { display: block; }
        
        .bottom-nav { height: var(--nav-height); background: var(--bg-card); border-top: 1px solid var(--border); display: flex; flex-shrink: 0; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; border: none; background: transparent; color: var(--text-muted); padding: 8px 0; cursor: pointer; position: relative; }
        .nav-item::before { content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 0; height: 3px; background: var(--cyan); border-radius: 0 0 3px 3px; transition: width 0.3s; }
        .nav-item.active { color: var(--cyan); }
        .nav-item.active::before { width: 30px; }
        .nav-icon { font-size: 1.5em; }
        .nav-label { font-size: 0.7em; font-weight: 500; }
        
        .card { background: var(--bg-card); border-radius: 16px; padding: 16px; margin-bottom: 16px; border: 1px solid var(--border); }
        .card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .card-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2em; }
        .card-icon.cyan { background: var(--cyan-glow); }
        .card-icon.purple { background: var(--purple-glow); }
        .card-icon.emerald { background: var(--emerald-glow); }
        .card-icon.orange { background: var(--orange-glow); }
        .card-icon.pink { background: var(--pink-glow); }
        .card-title { font-size: 1em; font-weight: 600; }
        .card-subtitle { font-size: 0.8em; color: var(--text-dim); }
        
        .stats-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 16px; }
        .stat-card { background: var(--bg-card); border-radius: 12px; padding: 12px; text-align: center; border: 1px solid var(--border); }
        .stat-value { font-size: 1.4em; font-weight: 700; }
        .stat-value.cyan { color: var(--cyan); }
        .stat-value.orange { color: var(--orange); }
        .stat-value.emerald { color: var(--emerald); }
        .stat-label { font-size: 0.7em; color: var(--text-muted); margin-top: 2px; }
        
        .input-group { margin-bottom: 14px; }
        .input-label { display: block; font-size: 0.85em; font-weight: 500; color: var(--text-dim); margin-bottom: 6px; }
        .input-field { width: 100%; padding: 12px 14px; background: var(--bg-dark); border: 2px solid var(--border); border-radius: 10px; color: var(--text-light); font-size: 1em; -webkit-appearance: none; }
        .input-field:focus { outline: none; border-color: var(--cyan); }
        select.input-field { cursor: pointer; }
        textarea.input-field { min-height: 80px; resize: vertical; }
        
        .input-row { display: flex; gap: 10px; }
        .input-row .input-group { flex: 1; margin-bottom: 0; }
        .input-row-btn { display: flex; gap: 8px; }
        .input-row-btn .input-field { flex: 1; }
        .input-btn { width: 50px; height: 48px; border: none; background: var(--bg-card-hover); border-radius: 10px; color: var(--text-dim); font-size: 1.2em; cursor: pointer; flex-shrink: 0; }
        
        .btn { width: 100%; padding: 14px 20px; border: none; border-radius: 12px; font-size: 1em; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer; }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background: linear-gradient(135deg, var(--cyan) 0%, var(--purple) 100%); color: white; }
        .btn-secondary { background: linear-gradient(135deg, var(--emerald) 0%, #059669 100%); color: white; }
        .btn-orange { background: linear-gradient(135deg, var(--orange) 0%, #d97706 100%); color: white; }
        .btn-pink { background: linear-gradient(135deg, var(--pink) 0%, #db2777 100%); color: white; }
        .btn-outline { background: transparent; border: 2px solid var(--cyan); color: var(--cyan); }
        .btn-danger { background: var(--red); color: white; }
        .btn-sm { padding: 10px 14px; font-size: 0.9em; }
        .btn-xs { padding: 8px 12px; font-size: 0.8em; border-radius: 8px; }
        
        .action-row { display: flex; gap: 10px; margin-top: 14px; }
        .action-row .btn { flex: 1; }
        
        .trip-banner { background: linear-gradient(135deg, var(--cyan-glow) 0%, var(--purple-glow) 100%); border-radius: 16px; padding: 20px; margin-bottom: 16px; border: 1px solid var(--border); text-align: center; }
        .trip-name { font-size: 1.5em; font-weight: 700; margin-bottom: 4px; }
        .trip-dest { font-size: 1em; color: var(--cyan); margin-bottom: 8px; }
        .trip-dates { font-size: 0.85em; color: var(--text-dim); }
        
        .day-card { background: var(--bg-card); border-radius: 14px; margin-bottom: 14px; border: 1px solid var(--border); overflow: hidden; }
        .day-header { padding: 14px; background: linear-gradient(135deg, var(--cyan-glow) 0%, var(--purple-glow) 100%); display: flex; align-items: center; justify-content: space-between; cursor: pointer; }
        .day-title { font-weight: 600; }
        .day-date { font-size: 0.8em; color: var(--text-dim); }
        .day-content { padding: 14px; display: none; }
        .day-content.show { display: block; }
        
        .schedule-item { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; border-left: 3px solid var(--cyan); }
        .schedule-item.has-reminder { border-left-color: var(--orange); }
        .schedule-item.synced { border-left-color: var(--emerald); }
        .schedule-time { font-size: 0.8em; color: var(--cyan); font-weight: 600; }
        .schedule-title { font-size: 0.95em; font-weight: 500; margin: 4px 0; }
        .schedule-location { font-size: 0.8em; color: var(--text-dim); }
        .schedule-actions { display: flex; gap: 6px; margin-top: 8px; flex-wrap: wrap; }
        .schedule-badge { font-size: 0.7em; padding: 2px 8px; border-radius: 10px; }
        .schedule-badge.reminder { background: var(--orange-glow); color: var(--orange); }
        .schedule-badge.synced { background: var(--emerald-glow); color: var(--emerald); }
        
        .expense-item { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .expense-info { flex: 1; }
        .expense-category { font-size: 0.75em; color: var(--text-muted); }
        .expense-name { font-size: 0.95em; font-weight: 500; }
        .expense-meta { font-size: 0.75em; color: var(--text-dim); margin-top: 2px; }
        .expense-amount { font-size: 1.1em; font-weight: 700; }
        .expense-amount.jpy { color: var(--orange); }
        .expense-amount.twd { color: var(--emerald); }
        .expense-delete { color: var(--text-muted); padding: 8px; cursor: pointer; }
        
        .shop-item { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; display: flex; align-items: center; gap: 12px; }
        .shop-item.bought { opacity: 0.5; }
        .shop-checkbox { width: 24px; height: 24px; border: 2px solid var(--border); border-radius: 6px; display: flex; align-items: center; justify-content: center; cursor: pointer; flex-shrink: 0; }
        .shop-item.bought .shop-checkbox { background: var(--emerald); border-color: var(--emerald); }
        .shop-info { flex: 1; }
        .shop-name { font-size: 0.95em; font-weight: 500; }
        .shop-item.bought .shop-name { text-decoration: line-through; }
        .shop-meta { font-size: 0.75em; color: var(--text-dim); }
        .shop-priority { font-size: 0.7em; padding: 2px 8px; border-radius: 10px; }
        .shop-priority.high { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .shop-priority.medium { background: var(--orange-glow); color: var(--orange); }
        .shop-priority.low { background: var(--emerald-glow); color: var(--emerald); }
        
        .reminder-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 10px; }
        .reminder-option { display: flex; align-items: center; gap: 8px; padding: 10px; background: var(--bg-dark); border: 2px solid var(--border); border-radius: 10px; cursor: pointer; font-size: 0.85em; }
        .reminder-option.checked { border-color: var(--cyan); background: var(--cyan-glow); }
        .reminder-checkbox { width: 20px; height: 20px; border: 2px solid var(--border); border-radius: 4px; display: flex; align-items: center; justify-content: center; }
        .reminder-option.checked .reminder-checkbox { background: var(--cyan); border-color: var(--cyan); }
        
        .setting-item { display: flex; align-items: center; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid var(--border); }
        .setting-item:last-child { border-bottom: none; }
        .setting-info { flex: 1; }
        .setting-label { font-size: 0.95em; font-weight: 500; }
        .setting-status { font-size: 0.8em; color: var(--text-dim); }
        
        .toggle { width: 50px; height: 28px; background: var(--border); border-radius: 14px; position: relative; cursor: pointer; transition: background 0.3s; }
        .toggle.active { background: var(--cyan); }
        .toggle::after { content: ''; position: absolute; top: 3px; left: 3px; width: 22px; height: 22px; background: white; border-radius: 50%; transition: transform 0.3s; }
        .toggle.active::after { transform: translateX(22px); }
        
        .auth-status { margin-top: 8px; padding: 10px; border-radius: 8px; font-size: 0.85em; }
        .auth-status.success { background: var(--emerald-glow); color: var(--emerald); }
        .auth-status.error { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: none; align-items: flex-end; justify-content: center; z-index: 1000; }
        .modal-overlay.show { display: flex; }
        .modal { background: var(--bg-card); border-radius: 20px 20px 0 0; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; padding: 20px; padding-bottom: calc(20px + env(safe-area-inset-bottom)); animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .modal-handle { width: 40px; height: 4px; background: var(--border); border-radius: 2px; margin: 0 auto 16px; }
        .modal-title { font-size: 1.1em; font-weight: 600; text-align: center; margin-bottom: 16px; }
        
        .toast { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); background: var(--bg-card); color: var(--text-light); padding: 12px 20px; border-radius: 10px; font-size: 0.9em; z-index: 2000; opacity: 0; transition: opacity 0.3s; border: 1px solid var(--border); max-width: calc(100% - 40px); text-align: center; }
        .toast.show { opacity: 1; }
        .toast.success { border-color: var(--emerald); }
        .toast.error { border-color: var(--red); }
        
        .progress-bar { height: 8px; background: var(--bg-dark); border-radius: 4px; overflow: hidden; margin-top: 8px; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--cyan), var(--purple)); border-radius: 4px; transition: width 0.5s ease; }
        
        .empty-state { text-align: center; padding: 40px 20px; color: var(--text-muted); }
        .empty-icon { font-size: 3em; margin-bottom: 12px; }
        
        .fab { position: fixed; bottom: calc(var(--nav-height) + 20px + env(safe-area-inset-bottom)); right: 20px; width: 56px; height: 56px; border-radius: 50%; background: linear-gradient(135deg, var(--cyan), var(--purple)); color: white; border: none; font-size: 1.5em; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 20px rgba(6, 182, 212, 0.4); cursor: pointer; z-index: 100; }
        
        /* å»ºè­°é¸å–®æ¨£å¼ */
        .suggest-section { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 14px; }
        .suggest-title { font-size: 0.85em; color: var(--cyan); margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
        .suggest-chips { display: flex; flex-wrap: wrap; gap: 8px; }
        .suggest-chip { padding: 8px 12px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 20px; font-size: 0.85em; cursor: pointer; transition: all 0.2s; }
        .suggest-chip:hover, .suggest-chip:active { background: var(--cyan-glow); border-color: var(--cyan); }
        .suggest-chip.selected { background: var(--cyan); color: white; border-color: var(--cyan); }
        
        /* è‡ªå‹•ç”¢ç”ŸæŒ‰éˆ• */
        .auto-generate-btn { background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%); margin-bottom: 10px; }
        
        /* ğŸ’° é ç®—å®ˆè­·ç’°æ¨£å¼ */
        .budget-ring-section { display: flex; align-items: center; gap: 20px; padding: 15px; background: var(--bg-dark); border-radius: 16px; margin-bottom: 15px; }
        .budget-ring-container { position: relative; width: 100px; height: 100px; flex-shrink: 0; }
        .budget-ring { width: 100%; height: 100%; transform: rotate(-90deg); }
        .ring-bg { fill: none; stroke: var(--bg-card); stroke-width: 10; }
        .ring-progress { fill: none; stroke: var(--emerald); stroke-width: 10; stroke-linecap: round; stroke-dasharray: 264; stroke-dashoffset: 264; transition: stroke-dashoffset 0.8s ease, stroke 0.3s ease; }
        .ring-progress.warning { stroke: var(--orange); }
        .ring-progress.danger { stroke: var(--pink); }
        .ring-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .ring-percent { font-size: 1.3em; font-weight: 700; color: var(--text-light); }
        .ring-label { font-size: 0.65em; color: var(--text-dim); }
        .budget-info { flex: 1; }
        .budget-row { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px solid var(--border); font-size: 0.85em; }
        .budget-row:last-of-type { border-bottom: none; }
        .budget-value { font-weight: 600; color: var(--text-light); }
        .budget-value.spent { color: var(--orange); }
        .budget-value.remain { color: var(--emerald); }
        .budget-value.over { color: var(--pink); }
        .btn-sm { padding: 8px 12px; font-size: 0.8em; }
        
        /* ğŸ—ºï¸ åœ°åœ–å°èˆªæŒ‰éˆ• */
        .map-btn { display: inline-flex; align-items: center; justify-content: center; width: 26px; height: 26px; background: var(--bg-dark); border-radius: 50%; font-size: 0.9em; cursor: pointer; margin-left: 6px; transition: all 0.2s; vertical-align: middle; text-decoration: none; }
        .map-btn:hover, .map-btn:active { background: var(--cyan); transform: scale(1.1); }
        
        /* ğŸ“¸ æ¯æ—¥å°é¢ç…§ç‰‡ */
        .day-cover { position: relative; width: 100%; aspect-ratio: 16/9; border-radius: 12px 12px 0 0; overflow: hidden; background: var(--bg-dark); }
        .day-cover img { width: 100%; height: 100%; object-fit: cover; }
        .day-cover-placeholder { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-dim); cursor: pointer; transition: background 0.2s; }
        .day-cover-placeholder:hover { background: var(--bg-card); }
        .day-cover-placeholder .icon { font-size: 2em; margin-bottom: 5px; }
        .cover-edit-btn { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); padding: 6px 10px; border-radius: 20px; font-size: 0.75em; color: white; cursor: pointer; border: none; }
        .cover-edit-btn:hover { background: rgba(0,0,0,0.8); }
        .day-card-with-cover { border-radius: 12px; overflow: hidden; }
        .day-card-with-cover .card-header { border-radius: 0; }
        
        /* âœï¸ æ—…éŠé»æ»´æ¨£å¼ */
        .notes-btn { display: flex; align-items: center; gap: 6px; background: var(--purple-glow); border: 1px solid var(--purple); padding: 6px 12px; border-radius: 20px; font-size: 0.8em; color: var(--purple); cursor: pointer; transition: all 0.2s; margin-top: 8px; }
        .notes-btn:hover { background: var(--purple); color: white; }
        .notes-btn .count { background: var(--purple); color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.85em; }
        .note-item { background: var(--bg-dark); border-radius: 12px; padding: 14px; margin-bottom: 12px; border-left: 3px solid var(--purple); position: relative; }
        .note-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .note-time { font-size: 0.8em; color: var(--text-dim); display: flex; align-items: center; gap: 6px; }
        .note-mood { font-size: 1.2em; }
        .note-content { font-size: 0.95em; line-height: 1.7; color: var(--text-light); white-space: pre-wrap; word-break: break-word; }
        .note-delete { position: absolute; top: 10px; right: 10px; background: transparent; border: none; color: var(--text-muted); cursor: pointer; font-size: 1em; padding: 4px; transition: color 0.2s; }
        .note-delete:hover { color: var(--pink); }
        .note-empty { text-align: center; padding: 30px 20px; color: var(--text-muted); }
        .note-empty .icon { font-size: 2.5em; margin-bottom: 10px; }
        .mood-picker { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; }
        .mood-option { width: 44px; height: 44px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 1.4em; cursor: pointer; transition: all 0.2s; }
        .mood-option:hover { transform: scale(1.15); border-color: var(--purple); }
        .mood-option.selected { border-color: var(--purple); background: var(--purple-glow); transform: scale(1.1); }
        .notes-day-header { background: linear-gradient(135deg, var(--purple-glow), var(--cyan-glow)); padding: 15px; border-radius: 12px; margin-bottom: 15px; text-align: center; }
        .notes-day-title { font-size: 1.1em; font-weight: 600; }
        .notes-day-date { font-size: 0.85em; color: var(--text-dim); margin-top: 4px; }
        
        /* ğŸ‘¥ æ—…ä¼´ç®¡ç†èˆ‡åˆ†å¸³æ¨£å¼ */
        .member-tag { display: inline-flex; align-items: center; gap: 6px; background: var(--bg-card); padding: 6px 12px; border-radius: 20px; margin: 4px; font-size: 0.85em; }
        .member-tag .remove { cursor: pointer; opacity: 0.6; transition: opacity 0.2s; }
        .member-tag .remove:hover { opacity: 1; color: var(--pink); }
        .member-tag.me { background: var(--cyan-glow); border: 1px solid var(--cyan); }
        .split-checkbox { display: inline-flex; align-items: center; gap: 6px; background: var(--bg-card); padding: 8px 12px; border-radius: 20px; cursor: pointer; font-size: 0.85em; transition: all 0.2s; border: 1px solid transparent; }
        .split-checkbox:hover { background: var(--bg-card-hover); }
        .split-checkbox.checked { background: var(--emerald-glow); border-color: var(--emerald); }
        .split-checkbox input { display: none; }
        .split-checkbox .check { width: 18px; height: 18px; border-radius: 50%; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 0.7em; }
        .split-checkbox.checked .check { background: var(--emerald); border-color: var(--emerald); color: white; }
        
        /* åˆ†å¸³çµç®— */
        .split-person { background: var(--bg-dark); border-radius: 10px; padding: 12px; margin-bottom: 10px; }
        .split-person-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .split-person-name { font-weight: 600; font-size: 1em; }
        .split-person-stats { display: flex; gap: 15px; font-size: 0.85em; }
        .split-stat { display: flex; flex-direction: column; }
        .split-stat-label { color: var(--text-dim); font-size: 0.75em; }
        .split-stat-value { font-weight: 600; }
        .split-stat-value.paid { color: var(--cyan); }
        .split-stat-value.owe { color: var(--orange); }
        .split-stat-value.receive { color: var(--emerald); }
        .split-transactions { margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border); }
        .split-tx { display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; background: var(--bg-card); border-radius: 8px; margin-bottom: 6px; font-size: 0.9em; }
        .split-tx-arrow { color: var(--text-dim); margin: 0 10px; }
        .split-tx-amount { font-weight: 600; color: var(--emerald); }
        
        /* ğŸ“¸ æ™¯é»æ‰“å¡åŠŸèƒ½æ¨£å¼ */
        .checkin-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px; }
        .checkin-stat { background: var(--bg-card); border-radius: 12px; padding: 12px 8px; text-align: center; border: 1px solid var(--border); }
        .checkin-stat-icon { font-size: 1.3em; margin-bottom: 4px; }
        .checkin-stat-value { font-size: 1.4em; font-weight: 700; }
        .checkin-stat-value.pink { color: var(--pink); }
        .checkin-stat-value.gold { color: #ffd700; }
        .checkin-stat-value.cyan { color: var(--cyan); }
        .checkin-stat-label { font-size: 0.7em; color: var(--text-dim); }
        
        .spot-card { background: var(--bg-card); border-radius: 14px; padding: 14px; margin-bottom: 10px; border: 1px solid var(--border); display: flex; align-items: center; gap: 12px; transition: all 0.3s; cursor: pointer; }
        .spot-card:hover { transform: translateX(4px); border-color: var(--pink); }
        .spot-card.checked { background: linear-gradient(135deg, rgba(236,72,153,0.15), rgba(255,215,0,0.1)); border-color: rgba(255,215,0,0.4); }
        .spot-checkbox { width: 28px; height: 28px; border-radius: 50%; border: 2px solid var(--text-muted); display: flex; align-items: center; justify-content: center; font-size: 0.85em; flex-shrink: 0; transition: all 0.3s; }
        .spot-card.checked .spot-checkbox { background: linear-gradient(135deg, var(--pink), #ffd700); border-color: transparent; box-shadow: 0 0 12px rgba(236,72,153,0.4); }
        .spot-info { flex: 1; min-width: 0; }
        .spot-name { font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .spot-meta { font-size: 0.8em; color: var(--text-dim); display: flex; align-items: center; gap: 8px; margin-top: 3px; }
        .spot-delete { width: 32px; height: 32px; border: none; background: rgba(239,68,68,0.15); border-radius: 8px; color: #ef4444; cursor: pointer; display: flex; align-items: center; justify-content: center; opacity: 0.6; transition: all 0.2s; }
        .spot-delete:hover { opacity: 1; background: rgba(239,68,68,0.25); }
        
        .checkin-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .checkin-photo { position: relative; aspect-ratio: 1; border-radius: 12px; overflow: hidden; cursor: pointer; }
        .checkin-photo img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .checkin-photo:hover img { transform: scale(1.05); }
        .checkin-photo-overlay { position: absolute; bottom: 0; left: 0; right: 0; padding: 6px; background: linear-gradient(transparent, rgba(0,0,0,0.8)); font-size: 0.7em; }
        
        .badge-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .badge-card { background: var(--bg-card); border-radius: 14px; padding: 14px 10px; text-align: center; border: 1px solid var(--border); transition: all 0.3s; }
        .badge-card.locked { opacity: 0.5; filter: grayscale(0.8); }
        .badge-card.unlocked { background: linear-gradient(135deg, rgba(236,72,153,0.1), rgba(6,182,212,0.1)); border-color: var(--pink); box-shadow: 0 0 15px rgba(236,72,153,0.2); }
        .badge-icon { font-size: 2em; margin-bottom: 6px; }
        .badge-name { font-size: 0.8em; font-weight: 600; margin-bottom: 4px; }
        .badge-desc { font-size: 0.7em; color: var(--text-dim); }
        .badge-progress { margin-top: 8px; height: 4px; background: var(--bg-dark); border-radius: 2px; overflow: hidden; }
        .badge-progress-fill { height: 100%; background: linear-gradient(90deg, var(--pink), var(--cyan)); border-radius: 2px; transition: width 0.5s; }
        
        .photo-upload-area { border: 2px dashed var(--border); border-radius: 14px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.3s; margin-bottom: 15px; }
        .photo-upload-area:hover { border-color: var(--pink); background: rgba(236,72,153,0.05); }
        .photo-upload-area.has-photo { padding: 0; border: none; }
        .photo-upload-area.has-photo img { width: 100%; max-height: 200px; object-fit: cover; border-radius: 14px; }
        .photo-upload-icon { font-size: 2.5em; margin-bottom: 10px; }
        .photo-upload-text { color: var(--text-dim); font-size: 0.9em; }
        
        .photo-viewer-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 9999; display: none; flex-direction: column; }
        .photo-viewer-overlay.show { display: flex; }
        .photo-viewer-header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .photo-viewer-close { width: 40px; height: 40px; border: none; background: rgba(255,255,255,0.1); border-radius: 50%; color: white; font-size: 1.2em; cursor: pointer; }
        .photo-viewer-content { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .photo-viewer-content img { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 12px; }
        .photo-viewer-info { padding: 20px; text-align: center; }
        .photo-viewer-spot { font-size: 1.1em; font-weight: 600; margin-bottom: 8px; }
        .photo-viewer-note { color: var(--text-dim); font-size: 0.9em; }
        
        .memoir-day { margin-bottom: 25px; }
        .memoir-day-title { font-size: 1em; font-weight: 700; color: var(--pink); padding-bottom: 8px; border-bottom: 2px solid var(--pink); margin-bottom: 12px; }
        .memoir-entry { background: var(--bg-card); border-radius: 14px; overflow: hidden; margin-bottom: 12px; }
        .memoir-entry-photo { width: 100%; height: 200px; object-fit: cover; }
        .memoir-entry-content { padding: 12px; }
        .memoir-entry-spot { font-weight: 600; margin-bottom: 4px; }
        .memoir-entry-note { color: var(--text-dim); font-size: 0.9em; }
        
        .checkin-tab-bar { display: flex; gap: 8px; margin-bottom: 15px; }
        .checkin-tab { flex: 1; padding: 10px; border: none; background: var(--bg-card); border-radius: 10px; color: var(--text-dim); font-size: 0.85em; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .checkin-tab.active { background: linear-gradient(135deg, var(--pink), var(--purple)); color: white; }
        .checkin-section { display: none; }
        .checkin-section.active { display: block; }
        
        /* ğŸ¬ å•Ÿå‹•ç•«é¢æ¨£å¼ */
        .splash-screen {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        .splash-screen.hide {
            opacity: 0;
            visibility: hidden;
        }
        .splash-content {
            text-align: center;
        }
        .splash-logo {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
        }
        .logo-circle {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #06b6d4, #ec4899, #a855f7);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 40px rgba(236, 72, 153, 0.4);
            animation: pulse 2s ease-in-out infinite;
        }
        .logo-plane {
            font-size: 3.5em;
            animation: float 3s ease-in-out infinite;
        }
        .logo-ring {
            position: absolute;
            top: -10px; left: -10px; right: -10px; bottom: -10px;
            border: 3px solid rgba(6, 182, 212, 0.3);
            border-radius: 50%;
            animation: ring-rotate 4s linear infinite;
        }
        .logo-ring::before {
            content: '';
            position: absolute;
            top: 5px; left: 50%;
            width: 10px; height: 10px;
            background: #06b6d4;
            border-radius: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 10px #06b6d4;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-8px) rotate(5deg); }
        }
        @keyframes ring-rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .splash-title {
            font-size: 2em;
            font-weight: 700;
            background: linear-gradient(135deg, #06b6d4, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            letter-spacing: 2px;
        }
        .splash-subtitle {
            color: #94a3b8;
            font-size: 0.95em;
            margin-bottom: 40px;
        }
        .splash-loading {
            display: flex;
            justify-content: center;
        }
        .loading-dots {
            display: flex;
            gap: 8px;
        }
        .loading-dots span {
            width: 10px;
            height: 10px;
            background: linear-gradient(135deg, #06b6d4, #ec4899);
            border-radius: 50%;
            animation: bounce 1.4s ease-in-out infinite;
        }
        .loading-dots span:nth-child(1) { animation-delay: 0s; }
        .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
        .loading-dots span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0.6); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        .splash-footer {
            position: absolute;
            bottom: 30px;
            color: #475569;
            font-size: 0.8em;
            letter-spacing: 1px;
        }
    </style>
</head>
<body>
    <!-- ğŸ¬ å•Ÿå‹•ç•«é¢ -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <div class="splash-logo">
                <div class="logo-circle">
                    <div class="logo-plane">âœˆï¸</div>
                </div>
                <div class="logo-ring"></div>
            </div>
            <div class="splash-title">æ—…éŠç§˜æ›¸</div>
            <div class="splash-subtitle">æ‚¨çš„è²¼å¿ƒæ—…éŠåŠ©ç†</div>
            <div class="splash-loading">
                <div class="loading-dots">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
        <div class="splash-footer">Travel Secretary v4.0</div>
    </div>
    
    <div class="app-container">
        <header class="app-header">
            <div class="app-logo">âœˆï¸ æ—…éŠç§˜æ›¸</div>
            <div class="header-actions">
                <button class="header-btn" onclick="showModal('exportModal')">ğŸ“Š</button>
                <button class="header-btn" onclick="switchPage('settings')">âš™ï¸</button>
            </div>
        </header>
        
        <main class="app-content">
            <!-- é¦–é  -->
            <div id="page-home" class="page active">
                <div class="trip-banner">
                    <div class="trip-name" id="displayTripName">æˆ‘çš„æ—…è¡Œ</div>
                    <div class="trip-dest" id="displayDestination">ğŸŒ é»æ“Šä¸‹æ–¹è¨­å®šç›®çš„åœ°</div>
                    <div class="trip-dates" id="displayDates">ğŸ“… å°šæœªè¨­å®šæ—¥æœŸ</div>
                </div>
                
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-value cyan" id="statDays">0</div>
                        <div class="stat-label">å¤©æ•¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value orange" id="statExpenseJPY">Â¥0</div>
                        <div class="stat-label">æ—¥å¹£èŠ±è²»</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value emerald" id="statExpenseTWD">$0</div>
                        <div class="stat-label">å°å¹£èŠ±è²»</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon cyan">ğŸ¯</div>
                        <div><div class="card-title">æ—…éŠè¨­å®š</div><div class="card-subtitle">è¨­å®šæ‚¨çš„æ—…è¡Œè³‡è¨Š</div></div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">æ—…éŠåç¨±</label>
                        <input type="text" class="input-field" id="tripName" placeholder="ä¾‹ï¼š2025 æ±äº¬è‡ªç”±è¡Œ" onchange="updateTripInfo()">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ç›®çš„åœ°</label>
                        <select class="input-field" id="destination" onchange="handleDestinationChange()">
                            <option value="">è«‹é¸æ“‡ç›®çš„åœ°</option>
                            <optgroup label="ğŸŒ äºæ´²">
                                <option value="ğŸ‡¯ğŸ‡µ æ±äº¬">ğŸ‡¯ğŸ‡µ æ±äº¬</option>
                                <option value="ğŸ‡¯ğŸ‡µ å¤§é˜ª">ğŸ‡¯ğŸ‡µ å¤§é˜ª</option>
                                <option value="ğŸ‡¯ğŸ‡µ äº¬éƒ½">ğŸ‡¯ğŸ‡µ äº¬éƒ½</option>
                                <option value="ğŸ‡¯ğŸ‡µ åŒ—æµ·é“">ğŸ‡¯ğŸ‡µ åŒ—æµ·é“</option>
                                <option value="ğŸ‡¯ğŸ‡µ æ²–ç¹©">ğŸ‡¯ğŸ‡µ æ²–ç¹©</option>
                                <option value="ğŸ‡°ğŸ‡· é¦–çˆ¾">ğŸ‡°ğŸ‡· é¦–çˆ¾</option>
                                <option value="ğŸ‡°ğŸ‡· é‡œå±±">ğŸ‡°ğŸ‡· é‡œå±±</option>
                                <option value="ğŸ‡°ğŸ‡· æ¿Ÿå·å³¶">ğŸ‡°ğŸ‡· æ¿Ÿå·å³¶</option>
                                <option value="ğŸ‡¹ğŸ‡­ æ›¼è°·">ğŸ‡¹ğŸ‡­ æ›¼è°·</option>
                                <option value="ğŸ‡¹ğŸ‡­ æ¸…é‚">ğŸ‡¹ğŸ‡­ æ¸…é‚</option>
                                <option value="ğŸ‡¹ğŸ‡­ æ™®å‰å³¶">ğŸ‡¹ğŸ‡­ æ™®å‰å³¶</option>
                                <option value="ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡">ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡</option>
                                <option value="ğŸ‡»ğŸ‡³ æ²³å…§">ğŸ‡»ğŸ‡³ æ²³å…§</option>
                                <option value="ğŸ‡»ğŸ‡³ èƒ¡å¿—æ˜å¸‚">ğŸ‡»ğŸ‡³ èƒ¡å¿—æ˜å¸‚</option>
                                <option value="ğŸ‡­ğŸ‡° é¦™æ¸¯">ğŸ‡­ğŸ‡° é¦™æ¸¯</option>
                                <option value="ğŸ‡²ğŸ‡´ æ¾³é–€">ğŸ‡²ğŸ‡´ æ¾³é–€</option>
                                <option value="ğŸ‡²ğŸ‡¾ å‰éš†å¡">ğŸ‡²ğŸ‡¾ å‰éš†å¡</option>
                                <option value="ğŸ‡®ğŸ‡© å³‡é‡Œå³¶">ğŸ‡®ğŸ‡© å³‡é‡Œå³¶</option>
                                <option value="ğŸ‡µğŸ‡­ é•·ç˜å³¶">ğŸ‡µğŸ‡­ é•·ç˜å³¶</option>
                                <option value="ğŸ‡¨ğŸ‡³ ä¸Šæµ·">ğŸ‡¨ğŸ‡³ ä¸Šæµ·</option>
                                <option value="ğŸ‡¨ğŸ‡³ åŒ—äº¬">ğŸ‡¨ğŸ‡³ åŒ—äº¬</option>
                            </optgroup>
                            <optgroup label="ğŸŒ æ­æ´²">
                                <option value="ğŸ‡«ğŸ‡· å·´é»">ğŸ‡«ğŸ‡· å·´é»</option>
                                <option value="ğŸ‡¬ğŸ‡§ å€«æ•¦">ğŸ‡¬ğŸ‡§ å€«æ•¦</option>
                                <option value="ğŸ‡®ğŸ‡¹ ç¾…é¦¬">ğŸ‡®ğŸ‡¹ ç¾…é¦¬</option>
                                <option value="ğŸ‡®ğŸ‡¹ å¨å°¼æ–¯">ğŸ‡®ğŸ‡¹ å¨å°¼æ–¯</option>
                                <option value="ğŸ‡ªğŸ‡¸ å·´å¡éš†ç´">ğŸ‡ªğŸ‡¸ å·´å¡éš†ç´</option>
                                <option value="ğŸ‡©ğŸ‡ª æ…•å°¼é»‘">ğŸ‡©ğŸ‡ª æ…•å°¼é»‘</option>
                                <option value="ğŸ‡³ğŸ‡± é˜¿å§†æ–¯ç‰¹ä¸¹">ğŸ‡³ğŸ‡± é˜¿å§†æ–¯ç‰¹ä¸¹</option>
                                <option value="ğŸ‡¨ğŸ‡­ è˜‡é»ä¸–">ğŸ‡¨ğŸ‡­ è˜‡é»ä¸–</option>
                                <option value="ğŸ‡¦ğŸ‡¹ ç¶­ä¹Ÿç´">ğŸ‡¦ğŸ‡¹ ç¶­ä¹Ÿç´</option>
                                <option value="ğŸ‡¨ğŸ‡¿ å¸ƒæ‹‰æ ¼">ğŸ‡¨ğŸ‡¿ å¸ƒæ‹‰æ ¼</option>
                                <option value="ğŸ‡¬ğŸ‡· é›…å…¸">ğŸ‡¬ğŸ‡· é›…å…¸</option>
                                <option value="ğŸ‡¬ğŸ‡· è–æ‰˜é‡Œå°¼">ğŸ‡¬ğŸ‡· è–æ‰˜é‡Œå°¼</option>
                                <option value="ğŸ‡µğŸ‡¹ é‡Œæ–¯æœ¬">ğŸ‡µğŸ‡¹ é‡Œæ–¯æœ¬</option>
                            </optgroup>
                            <optgroup label="ğŸŒ åŒ—ç¾æ´²">
                                <option value="ğŸ‡ºğŸ‡¸ ç´ç´„">ğŸ‡ºğŸ‡¸ ç´ç´„</option>
                                <option value="ğŸ‡ºğŸ‡¸ æ´›æ‰ç£¯">ğŸ‡ºğŸ‡¸ æ´›æ‰ç£¯</option>
                                <option value="ğŸ‡ºğŸ‡¸ èˆŠé‡‘å±±">ğŸ‡ºğŸ‡¸ èˆŠé‡‘å±±</option>
                                <option value="ğŸ‡ºğŸ‡¸ æ‹‰æ–¯ç¶­åŠ æ–¯">ğŸ‡ºğŸ‡¸ æ‹‰æ–¯ç¶­åŠ æ–¯</option>
                                <option value="ğŸ‡ºğŸ‡¸ å¤å¨å¤·">ğŸ‡ºğŸ‡¸ å¤å¨å¤·</option>
                                <option value="ğŸ‡¨ğŸ‡¦ æº«å“¥è¯">ğŸ‡¨ğŸ‡¦ æº«å“¥è¯</option>
                                <option value="ğŸ‡¨ğŸ‡¦ å¤šå€«å¤š">ğŸ‡¨ğŸ‡¦ å¤šå€«å¤š</option>
                                <option value="ğŸ‡²ğŸ‡½ åæ˜†">ğŸ‡²ğŸ‡½ åæ˜†</option>
                            </optgroup>
                            <optgroup label="ğŸŒ å¤§æ´‹æ´²">
                                <option value="ğŸ‡¦ğŸ‡º é›ªæ¢¨">ğŸ‡¦ğŸ‡º é›ªæ¢¨</option>
                                <option value="ğŸ‡¦ğŸ‡º å¢¨çˆ¾æœ¬">ğŸ‡¦ğŸ‡º å¢¨çˆ¾æœ¬</option>
                                <option value="ğŸ‡³ğŸ‡¿ å¥§å…‹è˜­">ğŸ‡³ğŸ‡¿ å¥§å…‹è˜­</option>
                                <option value="ğŸ‡³ğŸ‡¿ çš‡åé®">ğŸ‡³ğŸ‡¿ çš‡åé®</option>
                            </optgroup>
                            <optgroup label="ğŸŒ éæ´²">
                                <option value="ğŸ‡¿ğŸ‡¦ é–‹æ™®æ•¦">ğŸ‡¿ğŸ‡¦ é–‹æ™®æ•¦</option>
                                <option value="ğŸ‡ªğŸ‡¬ é–‹ç¾…">ğŸ‡ªğŸ‡¬ é–‹ç¾…</option>
                                <option value="ğŸ‡²ğŸ‡¦ é¦¬æ‹‰å–€ä»€">ğŸ‡²ğŸ‡¦ é¦¬æ‹‰å–€ä»€</option>
                                <option value="ğŸ‡°ğŸ‡ª å¥ˆæ´›æ¯”">ğŸ‡°ğŸ‡ª å¥ˆæ´›æ¯”</option>
                            </optgroup>
                            <optgroup label="âœï¸ è‡ªè¨‚">
                                <option value="custom">âœï¸ è‡ªè¨‚ç›®çš„åœ°...</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="input-group" id="customDestGroup" style="display:none;">
                        <input type="text" class="input-field" id="customDestination" placeholder="è¼¸å…¥è‡ªè¨‚ç›®çš„åœ°" onchange="updateTripInfo()">
                    </div>
                    
                    <div class="input-row" style="margin-bottom:14px;">
                        <div class="input-group">
                            <label class="input-label">å‡ºç™¼æ—¥æœŸ</label>
                            <input type="date" class="input-field" id="startDate" onchange="updateTripInfo()">
                        </div>
                        <div class="input-group">
                            <label class="input-label">çµæŸæ—¥æœŸ</label>
                            <input type="date" class="input-field" id="endDate" onchange="updateTripInfo()">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">ä¸»è¦å¹£åˆ¥</label>
                        <select class="input-field" id="mainCurrency" onchange="saveData()">
                            <optgroup label="ğŸŒ äºæ´²">
                                <option value="JPY">ğŸ‡¯ğŸ‡µ æ—¥å¹£ (JPY)</option>
                                <option value="KRW">ğŸ‡°ğŸ‡· éŸ“å…ƒ (KRW)</option>
                                <option value="THB">ğŸ‡¹ğŸ‡­ æ³°éŠ– (THB)</option>
                                <option value="SGD">ğŸ‡¸ğŸ‡¬ æ–°å¹£ (SGD)</option>
                                <option value="VND">ğŸ‡»ğŸ‡³ è¶Šç›¾ (VND)</option>
                                <option value="HKD">ğŸ‡­ğŸ‡° æ¸¯å¹£ (HKD)</option>
                                <option value="MOP">ğŸ‡²ğŸ‡´ æ¾³é–€å¹£ (MOP)</option>
                                <option value="MYR">ğŸ‡²ğŸ‡¾ é¦¬å¹£ (MYR)</option>
                                <option value="IDR">ğŸ‡®ğŸ‡© å°å°¼ç›¾ (IDR)</option>
                                <option value="PHP">ğŸ‡µğŸ‡­ æŠ«ç´¢ (PHP)</option>
                                <option value="CNY">ğŸ‡¨ğŸ‡³ äººæ°‘å¹£ (CNY)</option>
                            </optgroup>
                            <optgroup label="ğŸŒ æ­æ´²">
                                <option value="EUR">ğŸ‡ªğŸ‡º æ­å…ƒ (EUR)</option>
                                <option value="GBP">ğŸ‡¬ğŸ‡§ è‹±éŠ (GBP)</option>
                                <option value="CHF">ğŸ‡¨ğŸ‡­ ç‘å£«æ³•éƒ (CHF)</option>
                                <option value="CZK">ğŸ‡¨ğŸ‡¿ æ·å…‹å…‹æœ— (CZK)</option>
                            </optgroup>
                            <optgroup label="ğŸŒ ç¾æ´²/å¤§æ´‹æ´²">
                                <option value="USD">ğŸ‡ºğŸ‡¸ ç¾é‡‘ (USD)</option>
                                <option value="CAD">ğŸ‡¨ğŸ‡¦ åŠ å¹£ (CAD)</option>
                                <option value="MXN">ğŸ‡²ğŸ‡½ å¢¨è¥¿å“¥æŠ«ç´¢ (MXN)</option>
                                <option value="AUD">ğŸ‡¦ğŸ‡º æ¾³å¹£ (AUD)</option>
                                <option value="NZD">ğŸ‡³ğŸ‡¿ ç´å¹£ (NZD)</option>
                            </optgroup>
                            <optgroup label="ğŸŒ éæ´²">
                                <option value="ZAR">ğŸ‡¿ğŸ‡¦ å—éè˜­ç‰¹ (ZAR)</option>
                                <option value="EGP">ğŸ‡ªğŸ‡¬ åŸƒåŠéŠ (EGP)</option>
                                <option value="MAD">ğŸ‡²ğŸ‡¦ æ‘©æ´›å“¥è¿ªæ‹‰å§† (MAD)</option>
                                <option value="KES">ğŸ‡°ğŸ‡ª è‚¯äºå…ˆä»¤ (KES)</option>
                            </optgroup>
                            <optgroup label="ğŸ‡¹ğŸ‡¼ å°ç£">
                                <option value="TWD">ğŸ‡¹ğŸ‡¼ å°å¹£ (TWD)</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                
                <!-- ğŸ†• è‡ªå‹•ç”¢ç”Ÿè¡Œç¨‹æŒ‰éˆ• -->
                <button class="btn auto-generate-btn" onclick="showAutoGenerateModal()">
                    âœ¨ è‡ªå‹•ç”¢ç”Ÿå»ºè­°è¡Œç¨‹
                </button>
                
                <!-- ğŸ†• æ‰‹å‹•å»ºç«‹è¡Œç¨‹è¡¨æŒ‰éˆ• -->
                <button class="btn btn-outline" style="width:100%;margin-top:10px;" onclick="manualGenerateDays()">
                    ğŸ“… å»ºç«‹/æ›´æ–°è¡Œç¨‹è¡¨
                </button>
                
                <!-- ğŸ†• æ¸…é™¤æ­¤æ¬¡æ—…è¡ŒæŒ‰éˆ• -->
                <button class="btn btn-outline" style="width:100%;margin-top:10px;border-color:#ef4444;color:#ef4444;" onclick="clearCurrentTrip()">
                    ğŸ—‘ï¸ æ¸…é™¤æ­¤æ¬¡æ—…è¡Œï¼ˆé–‹å§‹æ–°æ—…éŠï¼‰
                </button>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon purple">âš¡</div>
                        <div><div class="card-title">å¿«é€ŸåŠŸèƒ½</div></div>
                    </div>
                    <div class="stats-row" style="margin-bottom:0;">
                        <div class="stat-card" style="cursor:pointer;" onclick="switchPage('itinerary')">
                            <div style="font-size:1.5em;">ğŸ“…</div>
                            <div class="stat-label">è¡Œç¨‹</div>
                        </div>
                        <div class="stat-card" style="cursor:pointer;" onclick="switchPage('expense')">
                            <div style="font-size:1.5em;">ğŸ’°</div>
                            <div class="stat-label">è¨˜å¸³</div>
                        </div>
                        <div class="stat-card" style="cursor:pointer;" onclick="switchPage('shopping')">
                            <div style="font-size:1.5em;">ğŸ›’</div>
                            <div class="stat-label">è³¼ç‰©</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- è¡Œç¨‹é é¢ -->
            <div id="page-itinerary" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon cyan">ğŸ“…</div>
                        <div><div class="card-title">æ¯æ—¥è¡Œç¨‹</div><div class="card-subtitle">è¦åŠƒæ‚¨çš„æ—…éŠè¡Œç¨‹</div></div>
                    </div>
                    <div class="action-row" style="margin-bottom:10px;">
                        <button class="btn btn-primary btn-sm" onclick="showAddScheduleModalGlobal()" style="flex:1;">â• æ–°å¢è¡Œç¨‹</button>
                    </div>
                    <div class="action-row" style="margin-bottom:0;">
                        <button class="btn btn-outline btn-sm" onclick="showBatchReminderModal()">ğŸ”” æ‰¹æ¬¡è¨­å®šæé†’</button>
                        <button class="btn btn-secondary btn-sm" onclick="syncAllToGoogleCalendar()">ğŸ“† åŒæ­¥å…¨éƒ¨</button>
                    </div>
                </div>
                
                <div id="itineraryList"></div>
                
                <button class="btn btn-outline" onclick="showAddDayModal()" style="margin-top:10px;">â• æ–°å¢ä¸€å¤©</button>
            </div>
            
            <!-- è¨˜å¸³é é¢ -->
            <div id="page-expense" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon orange">ğŸ’°</div>
                        <div><div class="card-title">æ—…éŠè¨˜å¸³</div><div class="card-subtitle">è¨˜éŒ„æ‚¨çš„èŠ±è²»ï¼Œè‡ªå‹•æ›ç®—å°å¹£</div></div>
                    </div>
                    
                    <!-- ğŸ’° é ç®—å®ˆè­·ç’° Budget Ring -->
                    <div class="budget-ring-section">
                        <div class="budget-ring-container">
                            <svg class="budget-ring" viewBox="0 0 100 100">
                                <circle class="ring-bg" cx="50" cy="50" r="42" />
                                <circle class="ring-progress" id="budgetRingProgress" cx="50" cy="50" r="42" />
                            </svg>
                            <div class="ring-center">
                                <div class="ring-percent" id="budgetPercent">0%</div>
                                <div class="ring-label">å·²ä½¿ç”¨</div>
                            </div>
                        </div>
                        <div class="budget-info">
                            <div class="budget-row">
                                <span>ğŸ’ ç¸½é ç®—</span>
                                <span class="budget-value" id="budgetTotal">NT$0</span>
                            </div>
                            <div class="budget-row">
                                <span>ğŸ’¸ å·²èŠ±è²»</span>
                                <span class="budget-value spent" id="budgetSpent">NT$0</span>
                            </div>
                            <div class="budget-row">
                                <span>ğŸ’° å‰©é¤˜</span>
                                <span class="budget-value remain" id="budgetRemain">NT$0</span>
                            </div>
                            <button class="btn btn-sm" onclick="showBudgetModal()" style="margin-top:8px;width:100%;">âš™ï¸ è¨­å®šé ç®—</button>
                        </div>
                    </div>
                    
                    <div class="stats-row">
                        <div class="stat-card">
                            <div class="stat-value orange" id="expenseJPY">Â¥0</div>
                            <div class="stat-label" id="expenseForeignLabel">å¤–å¹£</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value emerald" id="expenseTWD">NT$0</div>
                            <div class="stat-label">â‰ˆ å°å¹£ç¸½è¨ˆ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value pink" id="expenseCount">0</div>
                            <div class="stat-label">ç­†</div>
                        </div>
                    </div>
                    
                    <!-- æ”¯ä»˜æ–¹å¼çµ±è¨ˆ -->
                    <div id="paymentSummary" style="display:none;margin-bottom:12px;">
                        <div style="font-size:0.85em;color:var(--text-dim);margin-bottom:8px;">ğŸ“Š æ”¯ä»˜æ–¹å¼çµ±è¨ˆ</div>
                        <div id="paymentBreakdown" style="display:flex;flex-wrap:wrap;gap:8px;"></div>
                    </div>
                    
                    <div class="input-group">
                        <select class="input-field" id="expenseFilterDate" onchange="renderExpenses()">
                            <option value="all">å…¨éƒ¨æ—¥æœŸ</option>
                        </select>
                    </div>
                </div>
                
                <!-- ğŸ‘¥ åˆ†å¸³çµç®—å€å¡Š -->
                <div class="card" id="splitSummaryCard" style="display:none;">
                    <div class="card-header">
                        <div class="card-icon orange">ğŸ‘¥</div>
                        <div><div class="card-title">åˆ†å¸³çµç®—</div><div class="card-subtitle">èª°è©²çµ¦èª°å¤šå°‘éŒ¢</div></div>
                    </div>
                    <div id="splitSummary"></div>
                </div>
                
                <div id="expenseList"></div>
                <button class="fab" onclick="showAddExpenseModal()">â•</button>
            </div>
            
            <!-- è³¼ç‰©æ¸…å–®é é¢ -->
            <div id="page-shopping" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon pink">ğŸ›’</div>
                        <div><div class="card-title">è³¼ç‰©æ¸…å–®</div><div class="card-subtitle">æƒ³è²·çš„æ±è¥¿</div></div>
                    </div>
                    <div style="display:flex;justify-content:space-between;font-size:0.85em;color:var(--text-dim);">
                        <span>å®Œæˆé€²åº¦</span>
                        <span id="shoppingProgress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="shoppingProgressBar" style="width:0%"></div>
                    </div>
                </div>
                <div id="shoppingList"></div>
                <button class="fab" onclick="showAddShoppingModal()">â•</button>
            </div>
            
            <!-- ğŸ“¸ æ™¯é»æ‰“å¡é é¢ -->
            <div id="page-checkin" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon pink">ğŸ“¸</div>
                        <div><div class="card-title">æ™¯é»æ‰“å¡</div><div class="card-subtitle">è¨˜éŒ„æ—…é€”ä¸­çš„æ¯ä¸€åˆ»</div></div>
                    </div>
                    
                    <!-- çµ±è¨ˆå¡ç‰‡ -->
                    <div class="checkin-stats">
                        <div class="checkin-stat">
                            <div class="checkin-stat-icon">ğŸ“·</div>
                            <div class="checkin-stat-value pink" id="checkinPhotoCount">0</div>
                            <div class="checkin-stat-label">å¼µç…§ç‰‡</div>
                        </div>
                        <div class="checkin-stat">
                            <div class="checkin-stat-icon">ğŸ“</div>
                            <div class="checkin-stat-value gold" id="checkinSpotCount">0/0</div>
                            <div class="checkin-stat-label">æ™¯é»æ‰“å¡</div>
                        </div>
                        <div class="checkin-stat">
                            <div class="checkin-stat-icon">ğŸ†</div>
                            <div class="checkin-stat-value cyan" id="checkinBadgeCount">0</div>
                            <div class="checkin-stat-label">æˆå°±</div>
                        </div>
                    </div>
                </div>
                
                <!-- åˆ†é æ¨™ç±¤ -->
                <div class="checkin-tab-bar">
                    <button class="checkin-tab active" onclick="switchCheckinTab('spots')">ğŸ“ æ™¯é»</button>
                    <button class="checkin-tab" onclick="switchCheckinTab('photos')">ğŸ“· ç…§ç‰‡</button>
                    <button class="checkin-tab" onclick="switchCheckinTab('badges')">ğŸ† æˆå°±</button>
                    <button class="checkin-tab" onclick="switchCheckinTab('memoir')">ğŸ“– å›æ†¶</button>
                </div>
                
                <!-- æ™¯é»æ¸…å–® -->
                <div id="checkinSectionSpots" class="checkin-section active">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                        <span style="font-weight:600;">ğŸ“ æˆ‘çš„æ™¯é»æ¸…å–®</span>
                        <button class="btn btn-primary btn-sm" onclick="showAddSpotModal()">â• æ–°å¢</button>
                    </div>
                    <div id="spotList">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“</div>
                            <div>é‚„æ²’æœ‰æ™¯é»</div>
                            <div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">æ–°å¢æƒ³å»çš„æ™¯é»é–‹å§‹æ‰“å¡å§ï¼</div>
                        </div>
                    </div>
                </div>
                
                <!-- ç…§ç‰‡ç‰† -->
                <div id="checkinSectionPhotos" class="checkin-section">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                        <span style="font-weight:600;">ğŸ“· æ‰“å¡ç…§ç‰‡</span>
                        <button class="btn btn-primary btn-sm" onclick="showAddCheckinModal()">ğŸ“¸ æ‹ç…§æ‰“å¡</button>
                    </div>
                    <div id="checkinPhotoGrid" class="checkin-grid">
                        <div class="empty-state" style="grid-column:1/-1;">
                            <div class="empty-icon">ğŸ“·</div>
                            <div>é‚„æ²’æœ‰ç…§ç‰‡</div>
                            <div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">ä¸Šå‚³ç…§ç‰‡è¨˜éŒ„ç¾å¥½æ™‚åˆ»ï¼</div>
                        </div>
                    </div>
                </div>
                
                <!-- æˆå°±å¾½ç«  -->
                <div id="checkinSectionBadges" class="checkin-section">
                    <div style="font-weight:600;margin-bottom:12px;">ğŸ† æ—…éŠæˆå°±</div>
                    <div id="badgeGrid" class="badge-grid"></div>
                </div>
                
                <!-- å›æ†¶éŒ„ -->
                <div id="checkinSectionMemoir" class="checkin-section">
                    <div style="font-weight:600;margin-bottom:12px;">ğŸ“– æ—…éŠå›æ†¶éŒ„</div>
                    <div id="memoirTimeline"></div>
                    
                    <!-- ğŸ“¤ åŒ¯å‡ºåŠŸèƒ½å€ -->
                    <div class="card" style="margin-top:20px;">
                        <div style="font-size:0.9em;font-weight:600;margin-bottom:12px;">ğŸ“¤ åŒ¯å‡ºå›æ†¶</div>
                        <div style="display:flex;flex-direction:column;gap:10px;">
                            <button class="btn btn-primary btn-sm" style="width:100%;" onclick="exportMemoirHtml()">
                                ğŸ“„ åŒ¯å‡º HTML å›æ†¶éŒ„ï¼ˆå«ç…§ç‰‡ï¼Œå¯é›¢ç·šï¼‰
                            </button>
                            <button class="btn btn-secondary btn-sm" style="width:100%;" onclick="exportMemoirToGoogleDoc()">
                                ğŸ“ åŒ¯å‡ºåˆ° Google Docï¼ˆå«ç…§ç‰‡+é»æ»´ï¼‰
                            </button>
                            <button class="btn btn-outline btn-sm" style="width:100%;" onclick="downloadAllPhotos()">
                                ğŸ“¸ ä¸‹è¼‰æ‰€æœ‰ç…§ç‰‡ï¼ˆZIP æ‰“åŒ…ï¼‰
                            </button>
                        </div>
                        <p style="font-size:0.75em;color:var(--text-dim);margin-top:10px;text-align:center;">
                            ğŸ’¡ Google Doc æœƒå°‡ç…§ç‰‡å’Œæ—…éŠé»æ»´æ•´åˆåœ¨ä¸€èµ·ï¼Œæ°¸ä¹…ä¿å­˜åœ¨é›²ç«¯
                        </p>
                    </div>
                    
                    <!-- å›æ†¶ç®¡ç†å€ -->
                    <div class="card" style="margin-top:15px;background:var(--bg-dark);">
                        <div style="font-size:0.9em;color:var(--text-dim);margin-bottom:10px;">ğŸ“¸ å›æ†¶ç®¡ç†</div>
                        <p style="font-size:0.8em;color:var(--text-dim);margin-bottom:12px;">
                            ğŸ’¡ æ‰“å¡ç…§ç‰‡ã€æ—…éŠé»æ»´å’Œæˆå°±æœƒæ°¸ä¹…ä¿ç•™ï¼Œä¸æœƒå› ç‚ºã€Œæ¸…é™¤æ—…ç¨‹ã€è€Œæ¶ˆå¤±
                        </p>
                        <button class="btn btn-outline btn-sm" style="width:100%;border-color:#ef4444;color:#ef4444;" onclick="clearCheckinMemories()">
                            ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰æ‰“å¡å›æ†¶ï¼ˆåƒ…åœ¨éœ€è¦æ™‚ä½¿ç”¨ï¼‰
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- è¨­å®šé é¢ -->
            <div id="page-settings" class="page">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon cyan">ğŸ“†</div>
                        <div><div class="card-title">Google æ—¥æ›†</div><div class="card-subtitle">åŒæ­¥è¡Œç¨‹åˆ° Google Calendar</div></div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Google OAuth Client ID</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="googleClientId" placeholder="è¼¸å…¥ Client ID" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('googleClientId')">ğŸ‘ï¸</button>
                        </div>
                    </div>
                    <button class="btn btn-outline btn-sm" onclick="handleGoogleAuthorize()">ğŸ” æˆæ¬Š Google æ—¥æ›†</button>
                    <button class="btn btn-outline btn-sm" onclick="reauthorizeGoogle()" style="margin-top:8px;border-color:var(--orange);color:var(--orange);">ğŸ”„ é‡æ–°æˆæ¬Š Googleï¼ˆå« Driveï¼‰</button>
                    <div id="googleAuthStatus" class="auth-status" style="display:none;"></div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon emerald">ğŸ””</div>
                        <div><div class="card-title">LINE æé†’è¨­å®š</div><div class="card-subtitle">è¨­å®šè¡Œç¨‹æé†’é€šçŸ¥</div></div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">LINE Channel Access Token</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="lineToken" placeholder="è²¼ä¸Šæ‚¨çš„ Token" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('lineToken')">ğŸ‘ï¸</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">LINE User ID</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="lineUserId" placeholder="æ‚¨çš„ LINE User ID" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('lineUserId')">ğŸ‘ï¸</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">GAS Web App URL</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="gasUrl" placeholder="https://script.google.com/..." onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('gasUrl')">ğŸ‘ï¸</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">GAS Secret Key</label>
                        <div class="input-row-btn">
                            <input type="password" class="input-field" id="gasSecret" placeholder="æ‚¨è¨­å®šçš„æš—è™Ÿ" onchange="saveSettings()">
                            <button class="input-btn" onclick="toggleVisibility('gasSecret')">ğŸ‘ï¸</button>
                        </div>
                    </div>
                    <div class="action-row">
                        <button class="btn btn-outline btn-sm" onclick="testLineNotification()">ğŸ“¨ æ¸¬è©¦é€šçŸ¥</button>
                        <button class="btn btn-secondary btn-sm" onclick="viewSchedules()">ğŸ“‹ æŸ¥çœ‹æ’ç¨‹</button>
                    </div>
                    <button class="btn btn-danger btn-sm" style="margin-top:10px;" onclick="clearAllSchedules()">ğŸ—‘ï¸ æ¸…é™¤å…¨éƒ¨æ’ç¨‹</button>
                </div>
                
                <!-- ğŸ‘¥ æ—…ä¼´ç®¡ç† -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon orange">ğŸ‘¥</div>
                        <div><div class="card-title">æ—…ä¼´ç®¡ç†</div><div class="card-subtitle">è¨­å®šåˆ†å¸³æˆå“¡</div></div>
                    </div>
                    <div id="membersList" style="margin-bottom:12px;"></div>
                    <div class="input-row-btn">
                        <input type="text" class="input-field" id="newMemberName" placeholder="è¼¸å…¥æ—…ä¼´åç¨±">
                        <button class="input-btn" onclick="addMember()" style="background:var(--emerald);">â•</button>
                    </div>
                    <p style="color:var(--text-dim);font-size:0.75em;margin-top:8px;">ğŸ’¡ æ–°å¢æ—…ä¼´å¾Œï¼Œè¨˜å¸³æ™‚å¯é¸æ“‡å¢Šä»˜äººèˆ‡åˆ†æ”¤å°è±¡</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon purple">ğŸ’¾</div>
                        <div><div class="card-title">è³‡æ–™ç®¡ç†</div></div>
                    </div>
                    <div class="setting-item">
                        <div style="display:flex;align-items:center;">
                            <span style="font-size:1.2em;margin-right:12px;">ğŸ’¾</span>
                            <div class="setting-info">
                                <div class="setting-label">æœ¬æ©Ÿå„²å­˜</div>
                                <div class="setting-status">è‡ªå‹•ä¿å­˜è³‡æ–™</div>
                            </div>
                        </div>
                        <div class="toggle active" id="storageToggle" onclick="toggleStorage()"></div>
                    </div>
                    <div class="action-row">
                        <button class="btn btn-outline btn-sm" onclick="exportToExcel()">ğŸ“Š åŒ¯å‡º Excel</button>
                        <button class="btn btn-danger btn-sm" onclick="clearAllData()">ğŸ—‘ï¸ æ¸…é™¤è³‡æ–™</button>
                    </div>
                </div>
            </div>
        </main>
        
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="switchPage('home')">
                <span class="nav-icon">ğŸ </span><span class="nav-label">é¦–é </span>
            </button>
            <button class="nav-item" onclick="switchPage('itinerary')">
                <span class="nav-icon">ğŸ“…</span><span class="nav-label">è¡Œç¨‹</span>
            </button>
            <button class="nav-item" onclick="switchPage('expense')">
                <span class="nav-icon">ğŸ’°</span><span class="nav-label">è¨˜å¸³</span>
            </button>
            <button class="nav-item" onclick="switchPage('checkin')">
                <span class="nav-icon">ğŸ“¸</span><span class="nav-label">æ‰“å¡</span>
            </button>
            <button class="nav-item" onclick="switchPage('settings')">
                <span class="nav-icon">âš™ï¸</span><span class="nav-label">è¨­å®š</span>
            </button>
        </nav>
    </div>
    
    <div class="toast" id="toast"></div>
    
    <!-- Modal: è‡ªå‹•ç”¢ç”Ÿè¡Œç¨‹ -->
    <div class="modal-overlay" id="autoGenerateModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">âœ¨ è‡ªå‹•ç”¢ç”Ÿå»ºè­°è¡Œç¨‹</div>
            
            <div id="autoGenerateContent">
                <p style="color:var(--text-dim);text-align:center;padding:20px;">
                    è«‹å…ˆåœ¨é¦–é è¨­å®š<strong>ç›®çš„åœ°</strong>å’Œ<strong>æ—¥æœŸ</strong>
                </p>
            </div>
            
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('autoGenerateModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" id="confirmAutoGenerate" onclick="confirmAutoGenerate()">ğŸš€ ç”¢ç”Ÿè¡Œç¨‹</button>
            </div>
        </div>
    </div>
    
    <!-- Modal: æ–°å¢è¡Œç¨‹ï¼ˆå«å»ºè­°é¸å–®ï¼‰ -->
    <div class="modal-overlay" id="scheduleModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ“ æ–°å¢è¡Œç¨‹</div>
            
            <!-- ğŸ†• å»ºè­°æ™¯é»å€ -->
            <div class="suggest-section" id="suggestSection">
                <div class="suggest-title">ğŸ’¡ ç†±é–€æ™¯é»æ¨è–¦</div>
                <div class="suggest-chips" id="suggestChips"></div>
            </div>
            
            <div class="input-group">
                <label class="input-label">é¸æ“‡æ—¥æœŸ</label>
                <select class="input-field" id="scheduleDay"></select>
            </div>
            
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group">
                    <label class="input-label">é–‹å§‹æ™‚é–“</label>
                    <input type="time" class="input-field" id="scheduleStartTime" value="09:00">
                </div>
                <div class="input-group">
                    <label class="input-label">çµæŸæ™‚é–“</label>
                    <input type="time" class="input-field" id="scheduleEndTime" value="10:00">
                </div>
            </div>
            
            <div class="input-group">
                <label class="input-label">æ´»å‹•åç¨±</label>
                <input type="text" class="input-field" id="scheduleTitle" placeholder="ä¾‹ï¼šåƒè§€æ±äº¬éµå¡”">
            </div>
            
            <div class="input-group">
                <label class="input-label">é¡å‹</label>
                <select class="input-field" id="scheduleType">
                    <option value="æ™¯é»">ğŸ›ï¸ æ™¯é»</option>
                    <option value="ç¾é£Ÿ">ğŸœ ç¾é£Ÿ</option>
                    <option value="äº¤é€š">ğŸšƒ äº¤é€š</option>
                    <option value="ä½å®¿">ğŸ¨ ä½å®¿</option>
                    <option value="è³¼ç‰©">ğŸ›ï¸ è³¼ç‰©</option>
                    <option value="å…¶ä»–">ğŸ“Œ å…¶ä»–</option>
                </select>
            </div>
            
            <div class="input-group">
                <label class="input-label">åœ°é» (é¸å¡«)</label>
                <input type="text" class="input-field" id="scheduleLocation" placeholder="ä¾‹ï¼šæ±äº¬éƒ½æ¸¯å€">
            </div>
            
            <div class="input-group">
                <label class="input-label">å‚™è¨» (é¸å¡«)</label>
                <textarea class="input-field" id="scheduleNote" placeholder="å…¶ä»–å‚™è¨»..." style="min-height:60px;"></textarea>
            </div>
            
            <div class="input-group">
                <label class="input-label">ğŸ”” LINE æé†’</label>
                <div class="reminder-grid">
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 1 å¤©</span>
                        <input type="checkbox" value="1440">
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 2 å°æ™‚</span>
                        <input type="checkbox" value="120">
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 1 å°æ™‚</span>
                        <input type="checkbox" value="60">
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 30 åˆ†é˜</span>
                        <input type="checkbox" value="30">
                    </label>
                </div>
            </div>
            
            <div class="input-group">
                <label class="reminder-option" onclick="toggleReminder(this)" style="width:100%;">
                    <div class="reminder-checkbox">âœ“</div>
                    <span>ğŸ“† åŒæ­¥åˆ° Google æ—¥æ›†</span>
                    <input type="checkbox" id="syncToGoogle" value="google">
                </label>
            </div>
            
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('scheduleModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveSchedule()">å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <!-- Modal: å…¶ä»– (è¨˜å¸³ã€è³¼ç‰©ã€å¤©æ•¸ã€åŒ¯å‡º) -->
    <div class="modal-overlay" id="expenseModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ’° æ–°å¢èŠ±è²»</div>
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group"><label class="input-label">æ—¥æœŸ</label><select class="input-field" id="expenseDay"></select></div>
                <div class="input-group"><label class="input-label">é¡åˆ¥</label>
                    <select class="input-field" id="expenseCategory">
                        <option value="é£²é£Ÿ">ğŸœ é£²é£Ÿ</option><option value="äº¤é€š">ğŸšƒ äº¤é€š</option><option value="ä½å®¿">ğŸ¨ ä½å®¿</option>
                        <option value="è³¼ç‰©">ğŸ›ï¸ è³¼ç‰©</option><option value="é–€ç¥¨">ğŸ« é–€ç¥¨</option><option value="å…¶ä»–">ğŸ“Œ å…¶ä»–</option>
                    </select>
                </div>
            </div>
            <div class="input-group"><label class="input-label">é …ç›®åç¨±</label><input type="text" class="input-field" id="expenseItem" placeholder="ä¾‹ï¼šæ‹‰éºµåˆé¤"></div>
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group"><label class="input-label">é‡‘é¡</label><input type="number" class="input-field" id="expenseAmount" placeholder="0"></div>
                <div class="input-group"><label class="input-label">å¹£åˆ¥</label>
                    <select class="input-field" id="expenseCurrency">
                        <optgroup label="äºæ´²">
                            <option value="JPY">ğŸ‡¯ğŸ‡µ JPY</option>
                            <option value="KRW">ğŸ‡°ğŸ‡· KRW</option>
                            <option value="THB">ğŸ‡¹ğŸ‡­ THB</option>
                            <option value="SGD">ğŸ‡¸ğŸ‡¬ SGD</option>
                            <option value="VND">ğŸ‡»ğŸ‡³ VND</option>
                            <option value="HKD">ğŸ‡­ğŸ‡° HKD</option>
                            <option value="MOP">ğŸ‡²ğŸ‡´ MOP</option>
                            <option value="MYR">ğŸ‡²ğŸ‡¾ MYR</option>
                            <option value="IDR">ğŸ‡®ğŸ‡© IDR</option>
                            <option value="PHP">ğŸ‡µğŸ‡­ PHP</option>
                            <option value="CNY">ğŸ‡¨ğŸ‡³ CNY</option>
                        </optgroup>
                        <optgroup label="æ­æ´²">
                            <option value="EUR">ğŸ‡ªğŸ‡º EUR</option>
                            <option value="GBP">ğŸ‡¬ğŸ‡§ GBP</option>
                            <option value="CHF">ğŸ‡¨ğŸ‡­ CHF</option>
                            <option value="CZK">ğŸ‡¨ğŸ‡¿ CZK</option>
                        </optgroup>
                        <optgroup label="ç¾æ´²/å¤§æ´‹æ´²">
                            <option value="USD">ğŸ‡ºğŸ‡¸ USD</option>
                            <option value="CAD">ğŸ‡¨ğŸ‡¦ CAD</option>
                            <option value="MXN">ğŸ‡²ğŸ‡½ MXN</option>
                            <option value="AUD">ğŸ‡¦ğŸ‡º AUD</option>
                            <option value="NZD">ğŸ‡³ğŸ‡¿ NZD</option>
                        </optgroup>
                        <optgroup label="éæ´²">
                            <option value="ZAR">ğŸ‡¿ğŸ‡¦ ZAR</option>
                            <option value="EGP">ğŸ‡ªğŸ‡¬ EGP</option>
                            <option value="MAD">ğŸ‡²ğŸ‡¦ MAD</option>
                            <option value="KES">ğŸ‡°ğŸ‡ª KES</option>
                        </optgroup>
                        <optgroup label="å°ç£">
                            <option value="TWD">ğŸ‡¹ğŸ‡¼ TWD</option>
                        </optgroup>
                    </select>
                </div>
            </div>
            <div class="input-group"><label class="input-label">æ”¯ä»˜æ–¹å¼</label>
                <select class="input-field" id="expensePayment">
                    <optgroup label="ğŸ’µ ç¾é‡‘">
                        <option value="ç¾é‡‘">ğŸ’µ ç¾é‡‘</option>
                    </optgroup>
                    <optgroup label="ğŸ’³ ä¿¡ç”¨å¡">
                        <option value="ä¿¡ç”¨å¡">ğŸ’³ ä¿¡ç”¨å¡</option>
                        <option value="ç°½å¸³é‡‘èå¡">ğŸ’³ ç°½å¸³é‡‘èå¡</option>
                    </optgroup>
                    <optgroup label="ğŸ“± é›»å­æ”¯ä»˜">
                        <option value="Apple Pay">ğŸ“± Apple Pay</option>
                        <option value="Google Pay">ğŸ“± Google Pay</option>
                        <option value="LINE Pay">ğŸ“± LINE Pay</option>
                        <option value="è¡—å£æ”¯ä»˜">ğŸ“± è¡—å£æ”¯ä»˜</option>
                        <option value="PayPay">ğŸ“± PayPay</option>
                        <option value="å¾®ä¿¡/æ”¯ä»˜å¯¶">ğŸ“± å¾®ä¿¡/æ”¯ä»˜å¯¶</option>
                    </optgroup>
                    <optgroup label="ğŸšƒ äº¤é€šå¡">
                        <option value="Suica/ICOCA">ğŸšƒ Suica/ICOCA</option>
                        <option value="æ‚ éŠå¡">ğŸšƒ æ‚ éŠå¡</option>
                        <option value="T-money">ğŸšƒ T-money</option>
                        <option value="å…«é”é€š">ğŸšƒ å…«é”é€š</option>
                    </optgroup>
                    <optgroup label="ğŸ“Œ å…¶ä»–">
                        <option value="å…¶ä»–">ğŸ“Œ å…¶ä»–</option>
                    </optgroup>
                </select>
            </div>
            
            <!-- ğŸ‘¥ åˆ†å¸³è¨­å®š -->
            <div class="split-section" style="background:var(--bg-dark);border-radius:10px;padding:12px;margin-bottom:14px;">
                <div style="font-size:0.85em;color:var(--orange);margin-bottom:10px;display:flex;align-items:center;gap:6px;">ğŸ‘¥ åˆ†å¸³è¨­å®š</div>
                <div class="input-row" style="margin-bottom:10px;">
                    <div class="input-group" style="flex:1;">
                        <label class="input-label">ğŸ’³ å¢Šä»˜äºº</label>
                        <select class="input-field" id="expensePaidBy"></select>
                    </div>
                </div>
                <div class="input-group">
                    <label class="input-label">ğŸ‘« åˆ†æ”¤å°è±¡ï¼ˆå¯å¤šé¸ï¼‰</label>
                    <div id="splitWithCheckboxes" style="display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;"></div>
                </div>
            </div>
            
            <div class="input-group"><label class="input-label">å‚™è¨» (é¸å¡«)</label><input type="text" class="input-field" id="expenseNote" placeholder="å‚™è¨»..."></div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('expenseModal')">å–æ¶ˆ</button>
                <button class="btn btn-orange" onclick="saveExpense()">å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="shoppingModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ›’ æ–°å¢è³¼ç‰©é …ç›®</div>
            <div class="input-group"><label class="input-label">å•†å“åç¨±</label><input type="text" class="input-field" id="shopItem" placeholder="ä¾‹ï¼šè—¥å¦ã€é›¶é£Ÿ..."></div>
            <div class="input-row" style="margin-bottom:14px;">
                <div class="input-group"><label class="input-label">é ç®—</label><input type="number" class="input-field" id="shopBudget" placeholder="0"></div>
                <div class="input-group"><label class="input-label">å„ªå…ˆåº¦</label>
                    <select class="input-field" id="shopPriority"><option value="high">ğŸ”´ å¿…è²·</option><option value="medium">ğŸŸ¡ æƒ³è²·</option><option value="low">ğŸŸ¢ éš¨æ„</option></select>
                </div>
            </div>
            <div class="input-group"><label class="input-label">è³¼è²·åœ°é» (é¸å¡«)</label>
                <select class="input-field" id="shopStore">
                    <option value="">æœªæŒ‡å®š</option><option value="è—¥å¦åº—">ğŸ’Š è—¥å¦åº—</option><option value="ä¾¿åˆ©å•†åº—">ğŸª ä¾¿åˆ©å•†åº—</option>
                    <option value="ç™¾è²¨å…¬å¸">ğŸ¬ ç™¾è²¨å…¬å¸</option><option value="Outlet">ğŸ›ï¸ Outlet</option><option value="æ©Ÿå ´å…ç¨…">âœˆï¸ æ©Ÿå ´å…ç¨…</option>
                </select>
            </div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('shoppingModal')">å–æ¶ˆ</button>
                <button class="btn btn-pink" onclick="saveShopping()">å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="dayModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ“… æ–°å¢è¡Œç¨‹æ—¥</div>
            <div class="input-group"><label class="input-label">æ—¥æœŸ</label><input type="date" class="input-field" id="newDayDate"></div>
            <div class="input-group"><label class="input-label">æ¨™é¡Œ (é¸å¡«)</label><input type="text" class="input-field" id="newDayTitle" placeholder="ä¾‹ï¼šæŠµé”æ—¥"></div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('dayModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveNewDay()">å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="exportModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ“Š åŒ¯å‡ºè³‡æ–™</div>
            <div style="text-align:center;padding:20px 0;"><div style="font-size:3em;margin-bottom:12px;">ğŸ“Š</div><p style="color:var(--text-dim);">åŒ¯å‡ºå®Œæ•´çš„æ—…éŠç´€éŒ„</p></div>
            <button class="btn btn-secondary" onclick="exportToExcel()">ğŸ“¥ ä¸‹è¼‰ Excel (.xlsx)</button>
            <button class="btn btn-primary" style="margin-top:10px;" id="btnExportGoogleDoc">ğŸ“ åŒ¯å‡ºæ—…éŠç´€éŒ„ (Google Doc)</button>
            <button class="btn btn-outline" style="margin-top:10px;" onclick="closeModal('exportModal')">å–æ¶ˆ</button>
        </div>
    </div>
    
    <!-- Modal: æ¯æ—¥æ—…éŠé»æ»´ -->
    <div class="modal-overlay" id="dailyNotesModal">
        <div class="modal" style="max-height:95vh;">
            <div class="modal-handle"></div>
            <div class="modal-title">âœï¸ æ—…éŠé»æ»´</div>
            
            <div class="notes-day-header">
                <div class="notes-day-title" id="notesModalDayTitle">Day 1</div>
                <div class="notes-day-date" id="notesModalDayDate">2025/01/01</div>
            </div>
            
            <!-- æ–°å¢å¿ƒå¾—å€ -->
            <div class="card" style="margin-bottom:15px;">
                <div class="input-group">
                    <label class="input-label">é¸æ“‡å¿ƒæƒ…</label>
                    <div class="mood-picker" id="moodPicker">
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ˜Š">ğŸ˜Š</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ˜">ğŸ˜</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ¥°">ğŸ¥°</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ˜‹">ğŸ˜‹</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ¤©">ğŸ¤©</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ˜">ğŸ˜</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ¥±">ğŸ¥±</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ˜…">ğŸ˜…</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸ˜¢">ğŸ˜¢</div>
                        <div class="mood-option" onclick="selectMood(this)" data-mood="ğŸŒ§ï¸">ğŸŒ§ï¸</div>
                    </div>
                </div>
                <div class="input-group">
                    <label class="input-label">è¨˜éŒ„ç•¶ä¸‹çš„å¿ƒæƒ…èˆ‡æ„Ÿå—</label>
                    <textarea class="input-field" id="noteContent" rows="4" placeholder="ä»Šå¤©å»äº†å“ªè£¡ï¼Ÿåƒäº†ä»€éº¼ï¼Ÿæœ‰ä»€éº¼é›£å¿˜çš„ç¬é–“ï¼Ÿ&#10;&#10;å¯«ä¸‹æ—…é€”ä¸­çš„é»é»æ»´æ»´..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="addDailyNote()">âœï¸ æ–°å¢é»æ»´</button>
            </div>
            
            <!-- å·²æœ‰å¿ƒå¾—åˆ—è¡¨ -->
            <div id="dailyNotesList">
                <!-- å‹•æ…‹å¡«å…¥ -->
            </div>
            
            <input type="hidden" id="currentNoteDate" value="">
            <input type="hidden" id="currentNoteDayTitle" value="">
            <input type="hidden" id="selectedMood" value="ğŸ˜Š">
            
            <button class="btn btn-outline" style="margin-top:10px;" onclick="closeModal('dailyNotesModal')">é—œé–‰</button>
        </div>
    </div>
    
    <!-- Modal: æ‰¹æ¬¡è¨­å®šæé†’ -->
    <div class="modal-overlay" id="batchReminderModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ”” æ‰¹æ¬¡è¨­å®š LINE æé†’</div>
            
            <p style="color:var(--text-dim);font-size:0.9em;text-align:center;margin-bottom:15px;">
                ç‚ºæ‰€æœ‰<strong>å°šæœªè¨­å®šæé†’</strong>çš„è¡Œç¨‹åŠ å…¥ LINE æé†’
            </p>
            
            <div id="batchReminderStats" style="background:var(--bg-dark);border-radius:10px;padding:12px;margin-bottom:15px;text-align:center;">
                <!-- å‹•æ…‹å¡«å…¥çµ±è¨ˆ -->
            </div>
            
            <div class="input-group">
                <label class="input-label">é¸æ“‡æé†’æ™‚é–“</label>
                <div class="reminder-grid" id="batchReminderOptions">
                    <label class="reminder-option checked" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 1 å¤©</span>
                        <input type="checkbox" value="1440" checked>
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 2 å°æ™‚</span>
                        <input type="checkbox" value="120">
                    </label>
                    <label class="reminder-option checked" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 1 å°æ™‚</span>
                        <input type="checkbox" value="60" checked>
                    </label>
                    <label class="reminder-option" onclick="toggleReminder(this)">
                        <div class="reminder-checkbox">âœ“</div><span>å‰ 30 åˆ†é˜</span>
                        <input type="checkbox" value="30">
                    </label>
                </div>
            </div>
            
            <div class="input-group" style="margin-top:10px;">
                <label class="reminder-option checked" onclick="toggleReminder(this)" style="width:100%;">
                    <div class="reminder-checkbox">âœ“</div>
                    <span>è¦†è“‹å·²æœ‰æé†’è¨­å®šçš„è¡Œç¨‹</span>
                    <input type="checkbox" id="overwriteReminders" value="overwrite" checked>
                </label>
            </div>
            
            <div class="input-group" style="margin-top:10px;">
                <label class="reminder-option checked" onclick="toggleReminder(this)" style="width:100%;">
                    <div class="reminder-checkbox">âœ“</div>
                    <span>ğŸ—‘ï¸ å…ˆæ¸…é™¤ GAS è³‡æ–™åº«ä¸­çš„èˆŠæ’ç¨‹</span>
                    <input type="checkbox" id="clearOldSchedules" value="clear" checked>
                </label>
            </div>
            
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('batchReminderModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="applyBatchReminders()">ğŸ”” å¥—ç”¨æé†’</button>
            </div>
        </div>
    </div>
    
    <!-- ğŸ“ Google Doc é€£çµ Modal -->
    <div class="modal-overlay" id="docLinkModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">âœ… Google Doc å·²å»ºç«‹</div>
            <div style="text-align:center;padding:20px 0;">
                <div style="font-size:3em;margin-bottom:15px;">ğŸ“„</div>
                <p id="docLinkTitle" style="color:var(--text);margin-bottom:20px;font-weight:600;"></p>
                <a id="docLinkUrl" href="#" target="_blank" rel="noopener noreferrer" 
                   style="display:inline-block;background:linear-gradient(135deg,var(--cyan),var(--emerald));color:white;padding:15px 30px;border-radius:12px;text-decoration:none;font-weight:600;font-size:1.1em;">
                    ğŸ“ é–‹å•Ÿ Google Doc
                </a>
                <p style="color:var(--text-dim);font-size:0.85em;margin-top:15px;">
                    é»æ“Šä¸Šæ–¹æŒ‰éˆ•é–‹å•Ÿæ–‡ä»¶
                </p>
            </div>
            <div id="docLinkActions">
                <button class="btn btn-outline" style="width:100%;" onclick="closeDocLinkModal()">é—œé–‰</button>
            </div>
        </div>
    </div>
    
    <!-- ğŸ’° é ç®—è¨­å®š Modal -->
    <div class="modal-overlay" id="budgetModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ’ è¨­å®šæ—…éŠé ç®—</div>
            <div class="input-group">
                <label class="input-label">ç¸½é ç®—ï¼ˆå°å¹£ NT$ï¼‰</label>
                <input type="number" class="input-field" id="budgetAmount" placeholder="ä¾‹ï¼š50000">
            </div>
            <p style="color:var(--text-dim);font-size:0.8em;text-align:center;margin:10px 0;">
                æ‰€æœ‰è²¨å¹£å°‡è‡ªå‹•æ›ç®—ç‚ºå°å¹£é€²è¡Œé ç®—ç›£æ§
            </p>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('budgetModal')">å–æ¶ˆ</button>
                <button class="btn btn-orange" onclick="saveBudget()">ğŸ’¾ å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <!-- ğŸ“¸ æ¯æ—¥å°é¢ç…§ç‰‡ Modal -->
    <div class="modal-overlay" id="photoModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ“¸ è¨­å®šæœ¬æ—¥å°é¢</div>
            <input type="file" id="photoInput" accept="image/*" style="display:none" onchange="handlePhotoSelect(event)">
            <div id="photoPreview" style="width:100%;aspect-ratio:16/9;background:var(--bg-dark);border-radius:12px;margin-bottom:15px;display:flex;align-items:center;justify-content:center;overflow:hidden;cursor:pointer;" onclick="document.getElementById('photoInput').click()">
                <div style="text-align:center;color:var(--text-dim);">
                    <div style="font-size:2em;">ğŸ“·</div>
                    <div>é»æ“Šé¸æ“‡ç…§ç‰‡</div>
                </div>
            </div>
            <p style="color:var(--text-dim);font-size:0.75em;text-align:center;margin-bottom:10px;">
                å»ºè­°ä½¿ç”¨æ©«å‘ç…§ç‰‡ï¼Œæœƒè‡ªå‹•å£“ç¸®ä»¥ç¯€çœç©ºé–“
            </p>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('photoModal')">å–æ¶ˆ</button>
                <button class="btn btn-outline" onclick="removeDayCover()" style="color:var(--pink);">ğŸ—‘ï¸ ç§»é™¤</button>
                <button class="btn btn-primary" onclick="saveDayCover()">ğŸ’¾ å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <!-- ğŸ“ æ–°å¢æ™¯é» Modal -->
    <div class="modal-overlay" id="spotModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ“ æ–°å¢æ™¯é»</div>
            <div class="input-group">
                <label class="input-label">æ™¯é»åç¨±</label>
                <input type="text" class="input-field" id="newSpotName" placeholder="ä¾‹ï¼šæ±äº¬éµå¡”">
            </div>
            <div class="input-group">
                <label class="input-label">é¡å‹</label>
                <select class="input-field" id="newSpotType">
                    <option value="æ™¯é»">ğŸ›ï¸ æ™¯é»</option>
                    <option value="ç¾é£Ÿ">ğŸœ ç¾é£Ÿ</option>
                    <option value="è³¼ç‰©">ğŸ›ï¸ è³¼ç‰©</option>
                    <option value="ä½å®¿">ğŸ¨ ä½å®¿</option>
                    <option value="äº¤é€š">ğŸšƒ äº¤é€š</option>
                    <option value="å…¶ä»–">ğŸ“Œ å…¶ä»–</option>
                </select>
            </div>
            <div class="input-group">
                <label class="input-label">å‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
                <input type="text" class="input-field" id="newSpotNote" placeholder="ç‡Ÿæ¥­æ™‚é–“ã€åœ°å€ç­‰">
            </div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('spotModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="addSpot()">â• æ–°å¢</button>
            </div>
        </div>
    </div>
    
    <!-- ğŸ“¸ æ‹ç…§æ‰“å¡ Modal -->
    <div class="modal-overlay" id="checkinModal">
        <div class="modal">
            <div class="modal-handle"></div>
            <div class="modal-title">ğŸ“¸ æ‹ç…§æ‰“å¡</div>
            <input type="file" id="checkinPhotoInput" accept="image/*" capture="environment" style="display:none" onchange="handleCheckinPhoto(event)">
            <div class="photo-upload-area" id="checkinUploadArea" onclick="document.getElementById('checkinPhotoInput').click()">
                <div class="photo-upload-icon">ğŸ“·</div>
                <div class="photo-upload-text">é»æ“Šä¸Šå‚³ç…§ç‰‡æˆ–æ‹ç…§</div>
            </div>
            <div class="input-group">
                <label class="input-label">é¸æ“‡æ™¯é»ï¼ˆé¸å¡«ï¼‰</label>
                <select class="input-field" id="checkinSpot">
                    <option value="">-- ä¸é¸æ“‡ --</option>
                </select>
            </div>
            <div class="input-group">
                <label class="input-label">æ—¥æœŸ</label>
                <input type="date" class="input-field" id="checkinDate">
            </div>
            <div class="input-group">
                <label class="input-label">å¿ƒæƒ…ç­†è¨˜ï¼ˆé¸å¡«ï¼‰</label>
                <textarea class="input-field" id="checkinNote" placeholder="è¨˜éŒ„é€™ä¸€åˆ»çš„æ„Ÿå—..." rows="2"></textarea>
            </div>
            <div class="action-row">
                <button class="btn btn-outline" onclick="closeModal('checkinModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveCheckin()">âœ“ å„²å­˜</button>
            </div>
        </div>
    </div>
    
    <!-- ğŸ“· ç…§ç‰‡æª¢è¦–å™¨ -->
    <div class="photo-viewer-overlay" id="photoViewerOverlay">
        <div class="photo-viewer-header">
            <div></div>
            <button class="photo-viewer-close" onclick="closePhotoViewer()">âœ•</button>
        </div>
        <div class="photo-viewer-content">
            <img id="viewerPhoto" src="" alt="">
        </div>
        <div class="photo-viewer-info">
            <div class="photo-viewer-spot" id="viewerSpot"></div>
            <div class="photo-viewer-note" id="viewerNote"></div>
        </div>
    </div>
    
    <script>
        // ============================================
        // æ™¯é»è³‡æ–™åº«ï¼ˆå¯æ“´å……ï¼‰
        // ============================================
const ATTRACTIONS_DB = {
    // ============ äºæ´² (Asia) ============
    'ğŸ‡¯ğŸ‡µ æ±äº¬': {
        country: 'æ—¥æœ¬', continent: 'äºæ´²', currency: 'JPY',
        spots: [
            { name: 'æ±äº¬éµå¡”', type: 'æ™¯é»', location: 'æ±äº¬éƒ½æ¸¯å€', time: '09:00-11:00' },
            { name: 'æ·ºè‰å¯º', type: 'æ™¯é»', location: 'æ±äº¬éƒ½å°æ±å€', time: '10:00-12:00' },
            { name: 'æ™´ç©ºå¡”', type: 'æ™¯é»', location: 'æ±äº¬éƒ½å¢¨ç”°å€', time: '14:00-16:00' },
            { name: 'æ¶‰è°·åå­—è·¯å£', type: 'æ™¯é»', location: 'æ±äº¬éƒ½æ¸‹è°·å€', time: '15:00-17:00' },
            { name: 'æ–°å®¿å¾¡è‹‘', type: 'æ™¯é»', location: 'æ±äº¬éƒ½æ–°å®¿å€', time: '09:00-11:00' },
            { name: 'æ˜æ²»ç¥å®®', type: 'æ™¯é»', location: 'æ±äº¬éƒ½æ¸‹è°·å€', time: '08:00-10:00' },
            { name: 'ç§‹è‘‰åŸé›»å™¨è¡—', type: 'è³¼ç‰©', location: 'æ±äº¬éƒ½åƒä»£ç”°å€', time: '13:00-17:00' },
            { name: 'ä¸Šé‡å‹•ç‰©åœ’', type: 'æ™¯é»', location: 'æ±äº¬éƒ½å°æ±å€', time: '09:30-14:00' },
            { name: 'ç¯‰åœ°å¸‚å ´', type: 'ç¾é£Ÿ', location: 'æ±äº¬éƒ½ä¸­å¤®å€', time: '07:00-10:00' },
            { name: 'å°å ´æµ·æ¿±å…¬åœ’', type: 'æ™¯é»', location: 'æ±äº¬éƒ½æ¸¯å€', time: '14:00-18:00' }
        ],
        foods: ['ä¸€è˜­æ‹‰éºµ', 'å£½å¸å¤§', 'ç‰›ã‚«ãƒ„ã‚‚ã¨æ‘', 'æ•˜æ•˜è‹‘ç‡’è‚‰', 'AFURIæŸšå­æ‹‰éºµ', 'å¤©ä¸¼ã¦ã‚“ã‚„', 'é°»é­šé£¯', 'è¦ªå­ä¸¼', 'æŠ¹èŒ¶ç”œé»', 'ç« é­šç‡’'],
        defaultSchedule: [{ title: 'æŠµé”æˆç”°/ç¾½ç”°æ©Ÿå ´', type: 'äº¤é€š', time: '12:00-14:00' }, { title: 'é£¯åº— Check-in', type: 'ä½å®¿', time: '15:00-16:00' }]
    },
    'ğŸ‡¯ğŸ‡µ å¤§é˜ª': {
        country: 'æ—¥æœ¬', continent: 'äºæ´²', currency: 'JPY',
        spots: [
            { name: 'å¤§é˜ªåŸ', type: 'æ™¯é»', location: 'å¤§é˜ªå¸‚ä¸­å¤®å€', time: '09:00-12:00' },
            { name: 'é“é “å €', type: 'ç¾é£Ÿ', location: 'å¤§é˜ªå¸‚ä¸­å¤®å€', time: '17:00-21:00' },
            { name: 'å¿ƒé½‹æ©‹', type: 'è³¼ç‰©', location: 'å¤§é˜ªå¸‚ä¸­å¤®å€', time: '13:00-17:00' },
            { name: 'é€šå¤©é–£', type: 'æ™¯é»', location: 'å¤§é˜ªå¸‚æµªé€Ÿå€', time: '10:00-12:00' },
            { name: 'é»‘é–€å¸‚å ´', type: 'ç¾é£Ÿ', location: 'å¤§é˜ªå¸‚ä¸­å¤®å€', time: '08:00-11:00' },
            { name: 'ç’°çƒå½±åŸ', type: 'æ™¯é»', location: 'å¤§é˜ªå¸‚æ­¤èŠ±å€', time: '09:00-20:00' },
            { name: 'æµ·éŠé¤¨', type: 'æ™¯é»', location: 'å¤§é˜ªå¸‚æ¸¯å€', time: '10:00-15:00' },
            { name: 'æ¢…ç”°ç©ºä¸­åº­åœ’', type: 'æ™¯é»', location: 'å¤§é˜ªå¸‚åŒ—å€', time: '18:00-21:00' },
            { name: 'å¤©ç‹å¯ºå‹•ç‰©åœ’', type: 'æ™¯é»', location: 'å¤§é˜ªå¸‚å¤©ç‹å¯ºå€', time: '09:30-14:00' },
            { name: 'é›£æ³¢å…¬åœ’', type: 'è³¼ç‰©', location: 'å¤§é˜ªå¸‚æµªé€Ÿå€', time: '11:00-18:00' }
        ],
        foods: ['ç« é­šç‡’', 'å¤§é˜ªç‡’', 'ä¸²ã‚«ãƒ„ã ã‚‹ã¾', 'èŸ¹é“æ¨‚', 'ä¸€è˜­æ‹‰éºµ', 'é‡‘é¾æ‹‰éºµ', '551è“¬èŠè‚‰åŒ…', 'è‡ªç”±è»’å’–å“©', 'ç‚¸è±¬æ’', 'çƒé¾éºµ'],
        defaultSchedule: [{ title: 'æŠµé”é—œè¥¿æ©Ÿå ´', type: 'äº¤é€š', time: '12:00-14:00' }]
    },
    'ğŸ‡¯ğŸ‡µ äº¬éƒ½': {
        country: 'æ—¥æœ¬', continent: 'äºæ´²', currency: 'JPY',
        spots: [
            { name: 'æ¸…æ°´å¯º', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚æ±å±±å€', time: '06:00-09:00' },
            { name: 'ä¼è¦‹ç¨»è·å¤§ç¤¾', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚ä¼è¦‹å€', time: '08:00-11:00' },
            { name: 'é‡‘é–£å¯º', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚åŒ—å€', time: '09:00-11:00' },
            { name: 'åµå±±ç«¹æ—', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚å³äº¬å€', time: '08:00-12:00' },
            { name: 'äºŒæ¢åŸ', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚ä¸­äº¬å€', time: '09:00-11:00' },
            { name: 'ç¥‡åœ’èŠ±è¦‹å°è·¯', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚æ±å±±å€', time: '16:00-19:00' },
            { name: 'å…«å‚ç¥ç¤¾', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚æ±å±±å€', time: '09:00-10:00' },
            { name: 'éŒ¦å¸‚å ´', type: 'ç¾é£Ÿ', location: 'äº¬éƒ½å¸‚ä¸­äº¬å€', time: '10:00-13:00' },
            { name: 'éŠ€é–£å¯º', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚å·¦äº¬å€', time: '09:00-11:00' },
            { name: 'å“²å­¸ä¹‹é“', type: 'æ™¯é»', location: 'äº¬éƒ½å¸‚å·¦äº¬å€', time: '14:00-16:00' }
        ],
        foods: ['æ¹¯è±†è…', 'æŠ¹èŒ¶ç”œé»', 'äº¬éƒ½æ‹‰éºµ', 'æ‡·çŸ³æ–™ç†', 'æ¼¬ç‰©', 'å…«æ©‹é¤…', 'å®‡æ²»æŠ¹èŒ¶', 'é¯–é­šå£½å¸', 'æ¹¯è‘‰', 'äº¬é‡èœ'],
        defaultSchedule: []
    },
    'ğŸ‡¯ğŸ‡µ åŒ—æµ·é“': {
        country: 'æ—¥æœ¬', continent: 'äºæ´²', currency: 'JPY',
        spots: [
            { name: 'å°æ¨½é‹æ²³', type: 'æ™¯é»', location: 'å°æ¨½å¸‚', time: '10:00-14:00' },
            { name: 'å¤§é€šå…¬åœ’', type: 'æ™¯é»', location: 'æœ­å¹Œå¸‚ä¸­å¤®å€', time: '09:00-11:00' },
            { name: 'æœ­å¹Œé›»è¦–å¡”', type: 'æ™¯é»', location: 'æœ­å¹Œå¸‚ä¸­å¤®å€', time: '11:00-13:00' },
            { name: 'ç™½è‰²æˆ€äººå…¬åœ’', type: 'æ™¯é»', location: 'æœ­å¹Œå¸‚è¥¿å€', time: '09:00-12:00' },
            { name: 'ç‹¸å°è·¯å•†åº—è¡—', type: 'è³¼ç‰©', location: 'æœ­å¹Œå¸‚ä¸­å¤®å€', time: '14:00-18:00' },
            { name: 'äºŒæ¢å¸‚å ´', type: 'ç¾é£Ÿ', location: 'æœ­å¹Œå¸‚ä¸­å¤®å€', time: '07:00-10:00' },
            { name: 'å¯Œè‰¯é‡èŠ±ç”°', type: 'æ™¯é»', location: 'å¯Œè‰¯é‡å¸‚', time: '09:00-15:00' },
            { name: 'ç¾ç‘›é’æ± ', type: 'æ™¯é»', location: 'ç¾ç‘›ç”º', time: '10:00-12:00' },
            { name: 'å‡½é¤¨å±±å¤œæ™¯', type: 'æ™¯é»', location: 'å‡½é¤¨å¸‚', time: '18:00-21:00' },
            { name: 'ç™»åˆ¥åœ°ç„è°·', type: 'æ™¯é»', location: 'ç™»åˆ¥å¸‚', time: '09:00-12:00' }
        ],
        foods: ['æˆå‰æ€æ±—çƒ¤è‚‰', 'å‘³å™Œæ‹‰éºµ', 'æµ·é®®ä¸¼', 'æ¹¯å’–å“©', 'èƒèŸ¹æ–™ç†', 'ç™½è‰²æˆ€äºº', 'å¤•å¼µå“ˆå¯†ç“œ', 'çƒ¤ç‰ç±³', 'å¥¶æ²¹é¦¬éˆ´è–¯', 'æµ·è†½'],
        defaultSchedule: []
    },
    'ğŸ‡¯ğŸ‡µ æ²–ç¹©': {
        country: 'æ—¥æœ¬', continent: 'äºæ´²', currency: 'JPY',
        spots: [
            { name: 'é¦–é‡ŒåŸ', type: 'æ™¯é»', location: 'é‚£éœ¸å¸‚', time: '09:00-12:00' },
            { name: 'åœ‹éš›é€š', type: 'è³¼ç‰©', location: 'é‚£éœ¸å¸‚', time: '14:00-18:00' },
            { name: 'ç¾éº—æµ·æ°´æ—é¤¨', type: 'æ™¯é»', location: 'æœ¬éƒ¨ç”º', time: '09:00-15:00' },
            { name: 'å¤å®‡åˆ©å³¶', type: 'æ™¯é»', location: 'ä»Šæ­¸ä»æ‘', time: '10:00-14:00' },
            { name: 'è¬åº§æ¯›', type: 'æ™¯é»', location: 'æ©ç´æ‘', time: '15:00-17:00' },
            { name: 'æ³¢ä¸Šå®®', type: 'æ™¯é»', location: 'é‚£éœ¸å¸‚', time: '09:00-10:00' },
            { name: 'çŸ³å£å³¶', type: 'æ™¯é»', location: 'çŸ³å£å¸‚', time: '09:00-17:00' },
            { name: 'é’ä¹‹æ´çªŸ', type: 'æ™¯é»', location: 'æ©ç´æ‘', time: '10:00-12:00' },
            { name: 'ç‰æ³‰æ´', type: 'æ™¯é»', location: 'å—åŸå¸‚', time: '09:00-12:00' },
            { name: 'ç€¨é•·å³¶', type: 'æ™¯é»', location: 'è±è¦‹åŸå¸‚', time: '16:00-19:00' }
        ],
        foods: ['æ²–ç¹©éºµ', 'æµ·è‘¡è„', 'å¡”å¯é£¯', 'çŸ³å£ç‰›', 'è‹¦ç“œç‚’è›‹', 'ç´…èŠ‹å¡”', 'æ³¡ç››', 'è±¬è…³', 'æ²–ç¹©é»‘ç³–', 'æµ·é®®'],
        defaultSchedule: []
    },
    'ğŸ‡°ğŸ‡· é¦–çˆ¾': {
        country: 'éŸ“åœ‹', continent: 'äºæ´²', currency: 'KRW',
        spots: [
            { name: 'æ™¯ç¦å®®', type: 'æ™¯é»', location: 'é¦–çˆ¾é˜è·¯å€', time: '09:00-12:00' },
            { name: 'åŒ—æ‘éŸ“å±‹æ‘', type: 'æ™¯é»', location: 'é¦–çˆ¾é˜è·¯å€', time: '10:00-12:00' },
            { name: 'æ˜æ´', type: 'è³¼ç‰©', location: 'é¦–çˆ¾ä¸­å€', time: '14:00-18:00' },
            { name: 'Né¦–çˆ¾å¡”', type: 'æ™¯é»', location: 'é¦–çˆ¾é¾å±±å€', time: '18:00-21:00' },
            { name: 'å¼˜å¤§', type: 'è³¼ç‰©', location: 'é¦–çˆ¾éº»æµ¦å€', time: '15:00-20:00' },
            { name: 'æ±å¤§é–€', type: 'è³¼ç‰©', location: 'é¦–çˆ¾ä¸­å€', time: '20:00-24:00' },
            { name: 'å»£è—å¸‚å ´', type: 'ç¾é£Ÿ', location: 'é¦–çˆ¾é˜è·¯å€', time: '10:00-13:00' },
            { name: 'æ¢¨èŠ±å¥³å­å¤§å­¸', type: 'æ™¯é»', location: 'é¦–çˆ¾è¥¿å¤§é–€å€', time: '14:00-16:00' },
            { name: 'æ˜Œå¾·å®®', type: 'æ™¯é»', location: 'é¦–çˆ¾é˜è·¯å€', time: '09:00-11:00' },
            { name: 'æ±çŸ£å³¶', type: 'æ™¯é»', location: 'é¦–çˆ¾æ°¸ç™»æµ¦å€', time: '15:00-18:00' }
        ],
        foods: ['éŸ“å¼çƒ¤è‚‰', 'éƒ¨éšŠé‹', 'ç‚¸é›å•¤é…’', 'äººè”˜é›æ¹¯', 'è¾£ç‚’å¹´ç³•', 'çŸ³é‹æ‹Œé£¯', 'å†·éºµ', 'è±¬è…³', 'éŸ“å¼ç‚¸é†¬éºµ', 'ç´«èœé£¯æ²'],
        defaultSchedule: [{ title: 'æŠµé”ä»å·æ©Ÿå ´', type: 'äº¤é€š', time: '12:00-14:00' }]
    },
    'ğŸ‡°ğŸ‡· é‡œå±±': {
        country: 'éŸ“åœ‹', continent: 'äºæ´²', currency: 'KRW',
        spots: [
            { name: 'æµ·é›²å°æµ·æ°´æµ´å ´', type: 'æ™¯é»', location: 'é‡œå±±æµ·é›²å°å€', time: '09:00-12:00' },
            { name: 'ç”˜å·æ–‡åŒ–æ‘', type: 'æ™¯é»', location: 'é‡œå±±æ²™ä¸‹å€', time: '10:00-13:00' },
            { name: 'è¥¿é¢', type: 'è³¼ç‰©', location: 'é‡œå±±é‡œå±±é®å€', time: '14:00-18:00' },
            { name: 'æœ­å˜å…¶å¸‚å ´', type: 'ç¾é£Ÿ', location: 'é‡œå±±ä¸­å€', time: '08:00-11:00' },
            { name: 'å»£å®‰å¤§æ©‹', type: 'æ™¯é»', location: 'é‡œå±±æ°´ç‡Ÿå€', time: '18:00-21:00' },
            { name: 'é¾é ­å±±å…¬åœ’', type: 'æ™¯é»', location: 'é‡œå±±ä¸­å€', time: '09:00-11:00' },
            { name: 'å¤ªå®—å°', type: 'æ™¯é»', location: 'é‡œå±±å½±å³¶å€', time: '10:00-14:00' },
            { name: 'æµ·æ±é¾å®®å¯º', type: 'æ™¯é»', location: 'é‡œå±±æ©Ÿå¼µéƒ¡', time: '08:00-11:00' },
            { name: 'æ¢µé­šå¯º', type: 'æ™¯é»', location: 'é‡œå±±é‡‘äº•å€', time: '09:00-12:00' },
            { name: 'BIFFå»£å ´', type: 'è³¼ç‰©', location: 'é‡œå±±ä¸­å€', time: '15:00-19:00' }
        ],
        foods: ['è±¬è‚‰æ¹¯é£¯', 'ç”Ÿé­šç‰‡', 'çƒ¤è…¸', 'é­šç³•', 'é»‘è¼ª', 'æµ·é®®ç…é¤…', 'çƒ¤é¯–é­š', 'åˆ€å‰Šéºµ', 'ç´…è±†å†°', 'å¥¶å¥¶æ¹¯é£¯'],
        defaultSchedule: []
    },
    'ğŸ‡°ğŸ‡· æ¿Ÿå·å³¶': {
        country: 'éŸ“åœ‹', continent: 'äºæ´²', currency: 'KRW',
        spots: [
            { name: 'åŸå±±æ—¥å‡ºå³°', type: 'æ™¯é»', location: 'æ¿Ÿå·è¥¿æ­¸æµ¦å¸‚', time: '05:00-08:00' },
            { name: 'æ¼¢æ‹å±±', type: 'æ™¯é»', location: 'æ¿Ÿå·å¸‚', time: '06:00-14:00' },
            { name: 'å¤©å¸æ·µç€‘å¸ƒ', type: 'æ™¯é»', location: 'æ¿Ÿå·è¥¿æ­¸æµ¦å¸‚', time: '09:00-11:00' },
            { name: 'ç‰›å³¶', type: 'æ™¯é»', location: 'æ¿Ÿå·å¸‚', time: '09:00-16:00' },
            { name: 'æ¶‰åœ°å¯æ”¯', type: 'æ™¯é»', location: 'æ¿Ÿå·è¥¿æ­¸æµ¦å¸‚', time: '09:00-12:00' },
            { name: 'æ±é–€å¸‚å ´', type: 'ç¾é£Ÿ', location: 'æ¿Ÿå·å¸‚', time: '10:00-13:00' },
            { name: 'è¬ä¸ˆçªŸ', type: 'æ™¯é»', location: 'æ¿Ÿå·å¸‚', time: '09:00-11:00' },
            { name: 'ä¸­æ–‡è§€å…‰åœ’å€', type: 'æ™¯é»', location: 'æ¿Ÿå·è¥¿æ­¸æµ¦å¸‚', time: '10:00-16:00' },
            { name: 'å±±å›ä¸é›¢', type: 'æ™¯é»', location: 'æ¿Ÿå·å¸‚', time: '09:00-11:00' },
            { name: 'é¾é ­å²©', type: 'æ™¯é»', location: 'æ¿Ÿå·å¸‚', time: '16:00-18:00' }
        ],
        foods: ['é»‘è±¬è‚‰çƒ¤è‚‰', 'æµ·é®®é‹', 'é®‘é­šç²¥', 'æ©˜å­', 'ç”Ÿé­šç‰‡', 'å¸¶é­š', 'çƒ¤å¸¶é­š', 'æµ·è†½æ¹¯', 'è±¬è‚‰éºµ', 'ç¶ èŒ¶'],
        defaultSchedule: []
    },
    'ğŸ‡¹ğŸ‡­ æ›¼è°·': {
        country: 'æ³°åœ‹', continent: 'äºæ´²', currency: 'THB',
        spots: [
            { name: 'å¤§çš‡å®®', type: 'æ™¯é»', location: 'æ›¼è°·', time: '08:30-12:00' },
            { name: 'é„­ç‹å»Ÿ', type: 'æ™¯é»', location: 'æ›¼è°·', time: '08:00-10:00' },
            { name: 'æ°åœ–æ°é€±æœ«å¸‚å ´', type: 'è³¼ç‰©', location: 'æ›¼è°·', time: '09:00-17:00' },
            { name: 'è€ƒå±±è·¯', type: 'æ™¯é»', location: 'æ›¼è°·', time: '18:00-23:00' },
            { name: 'å››é¢ä½›', type: 'æ™¯é»', location: 'æ›¼è°·', time: '09:00-10:00' },
            { name: 'Terminal 21', type: 'è³¼ç‰©', location: 'æ›¼è°·', time: '11:00-20:00' },
            { name: 'æ°´ä¸Šå¸‚å ´', type: 'æ™¯é»', location: 'æ›¼è°·è¿‘éƒŠ', time: '07:00-12:00' },
            { name: 'è‡¥ä½›å¯º', type: 'æ™¯é»', location: 'æ›¼è°·', time: '08:00-10:00' },
            { name: 'Asiatiqueæ²³æ¿±å¤œå¸‚', type: 'è³¼ç‰©', location: 'æ›¼è°·', time: '17:00-23:00' },
            { name: 'é‡‘å±±å¯º', type: 'æ™¯é»', location: 'æ›¼è°·', time: '08:00-10:00' }
        ],
        foods: ['æ³°å¼ç‚’æ²³ç²‰', 'ç¶ å’–å“©', 'èŠ’æœç³¯ç±³é£¯', 'å†¬è”­åŠŸæ¹¯', 'æ³°å¼å¥¶èŒ¶', 'æ‰“æ‹‹è±¬è‚‰é£¯', 'æ¤°å­å†°æ·‡æ·‹', 'çƒ¤è‚‰ä¸²', 'é’æœ¨ç“œæ²™æ‹‰', 'é¦™è•‰ç…é¤…'],
        defaultSchedule: []
    },
    'ğŸ‡¹ğŸ‡­ æ¸…é‚': {
        country: 'æ³°åœ‹', continent: 'äºæ´²', currency: 'THB',
        spots: [
            { name: 'ç´ å¸–å±±é›™é¾å¯º', type: 'æ™¯é»', location: 'æ¸…é‚', time: '08:00-11:00' },
            { name: 'æ¸…é‚å¤åŸ', type: 'æ™¯é»', location: 'æ¸…é‚', time: '09:00-12:00' },
            { name: 'é€±æ—¥å¤œå¸‚', type: 'è³¼ç‰©', location: 'æ¸…é‚', time: '16:00-22:00' },
            { name: 'å¤§è±¡è‡ªç„¶å…¬åœ’', type: 'æ™¯é»', location: 'æ¸…é‚', time: '08:00-15:00' },
            { name: 'å¯§æ›¼è·¯', type: 'è³¼ç‰©', location: 'æ¸…é‚', time: '11:00-20:00' },
            { name: 'å¥‘è¿ªé¾å¯º', type: 'æ™¯é»', location: 'æ¸…é‚', time: '08:00-10:00' },
            { name: 'æ¸…é‚å¤œé–“å‹•ç‰©åœ’', type: 'æ™¯é»', location: 'æ¸…é‚', time: '18:00-22:00' },
            { name: 'å¸•è¾›å¯º', type: 'æ™¯é»', location: 'æ¸…é‚', time: '06:00-08:00' },
            { name: 'ç“¦æ´›æ´›å¸‚å ´', type: 'ç¾é£Ÿ', location: 'æ¸…é‚', time: '06:00-12:00' },
            { name: 'è’²å±çš‡å®®', type: 'æ™¯é»', location: 'æ¸…é‚', time: '09:00-12:00' }
        ],
        foods: ['å’–å“©éºµ', 'ç‚¸è±¬çš®', 'é’è¾£æ¤’é†¬', 'é¦™è…¸', 'æ³°åŒ—çƒ¤é›', 'ç«¹ç­’é£¯', 'æ¶¼æ‹Œè‚‰æœ«', 'æ³°å¼ç±³ç²‰æ¹¯', 'æ¸…é‚æ²™å—²', 'èŠ’æœå†°æ²™'],
        defaultSchedule: []
    },
    'ğŸ‡¹ğŸ‡­ æ™®å‰å³¶': {
        country: 'æ³°åœ‹', continent: 'äºæ´²', currency: 'THB',
        spots: [
            { name: 'å·´æ±æµ·ç˜', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '09:00-17:00' },
            { name: 'å¡å€«æµ·ç˜', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '09:00-17:00' },
            { name: 'æ™®å‰è€åŸå€', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '10:00-14:00' },
            { name: 'æŸ¥é¾å¯º', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '08:00-10:00' },
            { name: 'èŠ­æ±å¤œå¸‚', type: 'è³¼ç‰©', location: 'æ™®å‰å³¶', time: '18:00-23:00' },
            { name: 'æ”€ç‰™ç£', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '08:00-16:00' },
            { name: 'çš®çš®å³¶', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '07:00-17:00' },
            { name: 'å¡å¡”æµ·ç˜', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '09:00-17:00' },
            { name: 'æ™®å‰å¤§ä½›', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '08:00-10:00' },
            { name: 'å¹»å¤šå¥‡æ¨‚åœ’', type: 'æ™¯é»', location: 'æ™®å‰å³¶', time: '17:00-23:00' }
        ],
        foods: ['æµ·é®®å¤§é¤', 'æ³°å¼ç‚’é£¯', 'é³³æ¢¨ç‚’é£¯', 'çƒ¤æµ·é®®', 'æ¤°å­å†°', 'æ¶¼æ‹Œæµ·é®®', 'å’–å“©èŸ¹', 'ç‚’ç©ºå¿ƒèœ', 'æ¤°æ¼¿é›æ¹¯', 'æ³°å¼æ˜¥æ²'],
        defaultSchedule: []
    },
    'ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡': {
        country: 'æ–°åŠ å¡', continent: 'äºæ´²', currency: 'SGD',
        spots: [
            { name: 'é­šå°¾ç…å…¬åœ’', type: 'æ™¯é»', location: 'æ¿±æµ·ç£', time: '09:00-11:00' },
            { name: 'æ¿±æµ·ç£é‡‘æ²™', type: 'æ™¯é»', location: 'æ¿±æµ·ç£', time: '11:00-14:00' },
            { name: 'è–æ·˜æ²™å³¶', type: 'æ™¯é»', location: 'è–æ·˜æ²™', time: '09:00-18:00' },
            { name: 'ç‰›è»Šæ°´', type: 'ç¾é£Ÿ', location: 'ç‰›è»Šæ°´', time: '11:00-14:00' },
            { name: 'å°å°åº¦', type: 'æ™¯é»', location: 'å°å°åº¦', time: '10:00-12:00' },
            { name: 'çƒç¯€è·¯', type: 'è³¼ç‰©', location: 'çƒç¯€', time: '14:00-19:00' },
            { name: 'æ¿±æµ·ç£èŠ±åœ’', type: 'æ™¯é»', location: 'æ¿±æµ·ç£', time: '18:00-21:00' },
            { name: 'å…‹æ‹‰ç¢¼é ­', type: 'ç¾é£Ÿ', location: 'å…‹æ‹‰ç¢¼é ­', time: '18:00-22:00' },
            { name: 'æ–°åŠ å¡å‹•ç‰©åœ’', type: 'æ™¯é»', location: 'è¬ç¦®', time: '08:30-16:00' },
            { name: 'ç’°çƒå½±åŸ', type: 'æ™¯é»', location: 'è–æ·˜æ²™', time: '10:00-19:00' }
        ],
        foods: ['æµ·å—é›é£¯', 'è¾£æ¤’èƒèŸ¹', 'è‚‰éª¨èŒ¶', 'æ²™å—²', 'å»æ²™', 'ç‚’ç²¿æ¢', 'å’–æ¤°åå¸', 'æ¦´æ§¤', 'ç¾…æƒ¹', 'ç¦å»ºè¦éºµ'],
        defaultSchedule: []
    },
    'ğŸ‡»ğŸ‡³ æ²³å…§': {
        country: 'è¶Šå—', continent: 'äºæ´²', currency: 'VND',
        spots: [
            { name: 'é‚„åŠæ¹–', type: 'æ™¯é»', location: 'æ²³å…§', time: '07:00-09:00' },
            { name: 'èƒ¡å¿—æ˜ç´€å¿µå ‚', type: 'æ™¯é»', location: 'æ²³å…§', time: '08:00-11:00' },
            { name: 'ä¸‰åå…­å¤è¡—', type: 'è³¼ç‰©', location: 'æ²³å…§', time: '10:00-18:00' },
            { name: 'æ–‡å»Ÿ', type: 'æ™¯é»', location: 'æ²³å…§', time: '08:00-10:00' },
            { name: 'è¥¿æ¹–', type: 'æ™¯é»', location: 'æ²³å…§', time: '16:00-18:00' },
            { name: 'æ²³å…§å¤§æ•™å ‚', type: 'æ™¯é»', location: 'æ²³å…§', time: '09:00-10:00' },
            { name: 'ç«çˆç›£ç„', type: 'æ™¯é»', location: 'æ²³å…§', time: '08:00-11:00' },
            { name: 'æ²³å…§æ­ŒåŠ‡é™¢', type: 'æ™¯é»', location: 'æ²³å…§', time: '19:00-21:00' },
            { name: 'æ°´ä¸Šæœ¨å¶æˆ²', type: 'æ™¯é»', location: 'æ²³å…§', time: '17:00-18:00' },
            { name: 'é¾é‚Šæ©‹', type: 'æ™¯é»', location: 'æ²³å…§', time: '18:00-20:00' }
        ],
        foods: ['æ²³ç²‰', 'æ˜¥æ²', 'è¶Šå—å’–å•¡', 'æ³•åœ‹éºµåŒ…', 'çƒ¤è‚‰ç±³ç²‰', 'é›è›‹å’–å•¡', 'æ²³å…§çƒ¤è‚‰', 'èŸ¹è‚‰ç±³ç²‰', 'ç‚¸æ˜¥æ²', 'ç”˜è”—è¦'],
        defaultSchedule: []
    },
    'ğŸ‡»ğŸ‡³ èƒ¡å¿—æ˜å¸‚': {
        country: 'è¶Šå—', continent: 'äºæ´²', currency: 'VND',
        spots: [
            { name: 'çµ±ä¸€å®®', type: 'æ™¯é»', location: 'èƒ¡å¿—æ˜å¸‚', time: '08:00-11:00' },
            { name: 'æ¿±åŸå¸‚å ´', type: 'è³¼ç‰©', location: 'èƒ¡å¿—æ˜å¸‚', time: '07:00-18:00' },
            { name: 'è¥¿è²¢è–æ¯å¤§æ•™å ‚', type: 'æ™¯é»', location: 'èƒ¡å¿—æ˜å¸‚', time: '08:00-10:00' },
            { name: 'å¤èŠåœ°é“', type: 'æ™¯é»', location: 'èƒ¡å¿—æ˜å¸‚éƒŠ', time: '08:00-14:00' },
            { name: 'æˆ°çˆ­éºè·¡åšç‰©é¤¨', type: 'æ™¯é»', location: 'èƒ¡å¿—æ˜å¸‚', time: '08:00-12:00' },
            { name: 'èŒƒäº”è€è¡—', type: 'è³¼ç‰©', location: 'èƒ¡å¿—æ˜å¸‚', time: '18:00-23:00' },
            { name: 'è¥¿è²¢ä¸­å¤®éƒµå±€', type: 'æ™¯é»', location: 'èƒ¡å¿—æ˜å¸‚', time: '08:00-10:00' },
            { name: 'é‡‘èå¡”è§€æ™¯å°', type: 'æ™¯é»', location: 'èƒ¡å¿—æ˜å¸‚', time: '09:30-21:00' },
            { name: 'å¹³è¥¿å¸‚å ´', type: 'è³¼ç‰©', location: 'èƒ¡å¿—æ˜å¸‚', time: '06:00-18:00' },
            { name: 'æ°¸åš´å¯º', type: 'æ™¯é»', location: 'èƒ¡å¿—æ˜å¸‚', time: '08:00-17:00' }
        ],
        foods: ['ç¢è‚‰é£¯', 'ç‰›è‚‰æ²³ç²‰', 'è¶Šå—ä¸‰æ˜æ²»', 'ç”Ÿæ˜¥æ²', 'è¶Šå—ç…é¤…', 'ç”˜è”—æ±', 'æ»´æ¼å’–å•¡', 'æ¶¼æ‹Œé’æœ¨ç“œ', 'è“®å­ç”œæ¹¯', 'æ¤°å­å†°æ·‡æ·‹'],
        defaultSchedule: []
    },
    'ğŸ‡­ğŸ‡° é¦™æ¸¯': {
        country: 'é¦™æ¸¯', continent: 'äºæ´²', currency: 'HKD',
        spots: [
            { name: 'ç¶­å¤šåˆ©äºæ¸¯', type: 'æ™¯é»', location: 'å°–æ²™å’€', time: '19:00-21:00' },
            { name: 'å¤ªå¹³å±±é ‚', type: 'æ™¯é»', location: 'ä¸­ç’°', time: '18:00-21:00' },
            { name: 'è¿ªå£«å°¼æ¨‚åœ’', type: 'æ™¯é»', location: 'å¤§å¶¼å±±', time: '10:00-20:00' },
            { name: 'æ—ºè§’', type: 'è³¼ç‰©', location: 'æ—ºè§’', time: '14:00-22:00' },
            { name: 'å»Ÿè¡—å¤œå¸‚', type: 'è³¼ç‰©', location: 'æ²¹éº»åœ°', time: '18:00-23:00' },
            { name: 'å¤©å£‡å¤§ä½›', type: 'æ™¯é»', location: 'å¤§å¶¼å±±', time: '10:00-14:00' },
            { name: 'æµ·æ´‹å…¬åœ’', type: 'æ™¯é»', location: 'å—å€', time: '10:00-19:00' },
            { name: 'è˜­æ¡‚åŠ', type: 'æ™¯é»', location: 'ä¸­ç’°', time: '20:00-02:00' },
            { name: 'æ˜Ÿå…‰å¤§é“', type: 'æ™¯é»', location: 'å°–æ²™å’€', time: '19:00-21:00' },
            { name: 'é»ƒå¤§ä»™ç¥ ', type: 'æ™¯é»', location: 'é»ƒå¤§ä»™', time: '07:00-17:30' }
        ],
        foods: ['ç‡’è‡˜', 'æ¸¯å¼é»å¿ƒ', 'é›²åéºµ', 'çµ²è¥ªå¥¶èŒ¶', 'è è˜¿æ²¹', 'è›‹æ’»', 'ç…²ä»”é£¯', 'é¿é¢¨å¡˜ç‚’èŸ¹', 'é­šè›‹', 'æ¥Šæç”˜éœ²'],
        defaultSchedule: []
    },
    'ğŸ‡²ğŸ‡´ æ¾³é–€': {
        country: 'æ¾³é–€', continent: 'äºæ´²', currency: 'MOP',
        spots: [
            { name: 'å¤§ä¸‰å·´ç‰ŒåŠ', type: 'æ™¯é»', location: 'æ¾³é–€åŠå³¶', time: '09:00-18:00' },
            { name: 'å¨å°¼æ–¯äºº', type: 'è³¼ç‰©', location: 'è·¯æ°¹åŸ', time: '10:00-23:00' },
            { name: 'è­°äº‹äº­å‰åœ°', type: 'æ™¯é»', location: 'æ¾³é–€åŠå³¶', time: '10:00-18:00' },
            { name: 'æ¾³é–€æ—…éŠå¡”', type: 'æ™¯é»', location: 'å—ç£', time: '10:00-21:00' },
            { name: 'åª½é–£å»Ÿ', type: 'æ™¯é»', location: 'æ¾³é–€åŠå³¶', time: '07:00-18:00' },
            { name: 'å®˜ä¹Ÿè¡—', type: 'ç¾é£Ÿ', location: 'æ°¹ä»”', time: '10:00-22:00' },
            { name: 'æ–°æ¿ å¤©åœ°', type: 'æ™¯é»', location: 'è·¯æ°¹åŸ', time: '10:00-23:00' },
            { name: 'æ±æœ›æ´‹ç‡ˆå¡”', type: 'æ™¯é»', location: 'æ¾³é–€åŠå³¶', time: '09:00-17:30' },
            { name: 'é¾ç’°è‘¡éŸ»', type: 'æ™¯é»', location: 'æ°¹ä»”', time: '10:00-19:00' },
            { name: 'è·¯ç’°', type: 'æ™¯é»', location: 'è·¯ç’°', time: '10:00-18:00' }
        ],
        foods: ['è‘¡å¼è›‹æ’»', 'è±¬æ‰’åŒ…', 'æ°´èŸ¹ç²¥', 'æœ¨ç³ å¸ƒç”¸', 'è‘¡åœ‹é›', 'éæ´²é›', 'ç«¹æ˜‡éºµ', 'é›™çš®å¥¶', 'æä»é¤…', 'ç‰›é›œ'],
        defaultSchedule: []
    },
    'ğŸ‡²ğŸ‡¾ å‰éš†å¡': {
        country: 'é¦¬ä¾†è¥¿äº', continent: 'äºæ´²', currency: 'MYR',
        spots: [
            { name: 'é›™å³°å¡”', type: 'æ™¯é»', location: 'å‰éš†å¡', time: '09:00-21:00' },
            { name: 'èŒ¨å» è¡—', type: 'è³¼ç‰©', location: 'å‰éš†å¡', time: '10:00-22:00' },
            { name: 'é»‘é¢¨æ´', type: 'æ™¯é»', location: 'å‰éš†å¡', time: '06:00-19:00' },
            { name: 'ç¨ç«‹å»£å ´', type: 'æ™¯é»', location: 'å‰éš†å¡', time: '09:00-18:00' },
            { name: 'é˜¿ç¾…è¡—', type: 'ç¾é£Ÿ', location: 'å‰éš†å¡', time: '17:00-02:00' },
            { name: 'åœ‹å®¶æ¸…çœŸå¯º', type: 'æ™¯é»', location: 'å‰éš†å¡', time: '09:00-18:00' },
            { name: 'ä¸­å¤®è—è¡“åŠ', type: 'è³¼ç‰©', location: 'å‰éš†å¡', time: '10:00-21:00' },
            { name: 'å‰éš†å¡å¡”', type: 'æ™¯é»', location: 'å‰éš†å¡', time: '09:00-22:00' },
            { name: 'åœ‹å®¶çš‡å®®', type: 'æ™¯é»', location: 'å‰éš†å¡', time: '09:00-17:00' },
            { name: 'æ­¦å‰å…ç™»', type: 'è³¼ç‰©', location: 'å‰éš†å¡', time: '10:00-22:00' }
        ],
        foods: ['æ¤°æ¼¿é£¯', 'æ²™å—²', 'è‚‰éª¨èŒ¶', 'ç‚’ç²¿æ¢', 'å»æ²™', 'é›²åéºµ', 'å°åº¦ç…é¤…', 'æ¦´æ§¤', 'æ‹‰èŒ¶', 'å’–å“©éºµ'],
        defaultSchedule: []
    },
    'ğŸ‡®ğŸ‡© å³‡é‡Œå³¶': {
        country: 'å°å°¼', continent: 'äºæ´²', currency: 'IDR',
        spots: [
            { name: 'çƒå¸ƒçš‡å®®', type: 'æ™¯é»', location: 'çƒå¸ƒ', time: '08:00-17:00' },
            { name: 'æµ·ç¥å»Ÿ', type: 'æ™¯é»', location: 'å¡”å·´å—', time: '06:00-19:00' },
            { name: 'è–çŒ´æ£®æ—å…¬åœ’', type: 'æ™¯é»', location: 'çƒå¸ƒ', time: '08:30-18:00' },
            { name: 'å¾·æ ¼æ‹‰æœ—æ¢¯ç”°', type: 'æ™¯é»', location: 'çƒå¸ƒ', time: '08:00-18:00' },
            { name: 'åº«å¡”æµ·ç˜', type: 'æ™¯é»', location: 'åº«å¡”', time: '07:00-19:00' },
            { name: 'çƒé­¯ç“¦åœ–æ–·å´–', type: 'æ™¯é»', location: 'çƒé­¯ç“¦åœ–', time: '09:00-19:00' },
            { name: 'æ°´ç¥å»Ÿ', type: 'æ™¯é»', location: 'å¡”å·´å—', time: '08:00-18:00' },
            { name: 'é‡‘å·´è˜­æµ·ç˜', type: 'æ™¯é»', location: 'é‡‘å·´è˜­', time: '17:00-19:00' },
            { name: 'è–æ³‰å¯º', type: 'æ™¯é»', location: 'å¦å¸•è¥¿æ—', time: '08:00-18:00' },
            { name: 'åŠªæ²™æœç“¦æµ·ç˜', type: 'æ™¯é»', location: 'åŠªæ²™æœç“¦', time: '09:00-17:00' }
        ],
        foods: ['é«’é´¨é£¯', 'æ²™å—²', 'å°å°¼ç‚’é£¯', 'å·´æ¯”è±¬è‚‹æ’', 'åŠ å¤šåŠ å¤š', 'è˜‡å¤šé›æ¹¯', 'çƒ¤ä¹³è±¬', 'é»ƒè–‘é£¯', 'å°å°¼ç‚’éºµ', 'æ¤°å­å†°'],
        defaultSchedule: []
    },
    'ğŸ‡µğŸ‡­ é•·ç˜å³¶': {
        country: 'è²å¾‹è³“', continent: 'äºæ´²', currency: 'PHP',
        spots: [
            { name: 'ç™½æ²™ç˜', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '06:00-18:00' },
            { name: 'D Mall', type: 'è³¼ç‰©', location: 'é•·ç˜å³¶', time: '10:00-22:00' },
            { name: 'æ™®å¡æµ·ç˜', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '08:00-17:00' },
            { name: 'ç›§éœå±±', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '15:00-18:00' },
            { name: 'æ˜ŸæœŸäº”æµ·ç˜', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '09:00-17:00' },
            { name: 'é˜¿é‡ŒåŸƒçˆ¾è§’', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '08:00-17:00' },
            { name: 'æ°´æ™¶æ´', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '09:00-15:00' },
            { name: 'è™è æ´', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '16:00-18:00' },
            { name: 'Talipapaå¸‚å ´', type: 'ç¾é£Ÿ', location: 'é•·ç˜å³¶', time: '08:00-20:00' },
            { name: 'å¸ƒæ‹‰æ³¢æµ·ç˜', type: 'æ™¯é»', location: 'é•·ç˜å³¶', time: '09:00-17:00' }
        ],
        foods: ['çƒ¤ä¹³è±¬', 'ç‰›éª¨æ¹¯', 'é†‹ç‡œè±¬è‚‰', 'æµ·é®®', 'èŠ’æœå†°æ²™', 'ç‚¸é¦™è•‰', 'Halo-Halo', 'çƒ¤é­·é­š', 'è²å¼éµæ¿', 'æ¤°å­æ°´'],
        defaultSchedule: []
    },
    'ğŸ‡¨ğŸ‡³ ä¸Šæµ·': {
        country: 'ä¸­åœ‹', continent: 'äºæ´²', currency: 'CNY',
        spots: [
            { name: 'å¤–ç˜', type: 'æ™¯é»', location: 'ä¸Šæµ·é»ƒæµ¦å€', time: '18:00-22:00' },
            { name: 'æ±æ–¹æ˜ç å¡”', type: 'æ™¯é»', location: 'ä¸Šæµ·æµ¦æ±æ–°å€', time: '08:00-21:30' },
            { name: 'åŸéšå»Ÿ', type: 'æ™¯é»', location: 'ä¸Šæµ·é»ƒæµ¦å€', time: '08:30-16:30' },
            { name: 'å—äº¬è·¯æ­¥è¡Œè¡—', type: 'è³¼ç‰©', location: 'ä¸Šæµ·é»ƒæµ¦å€', time: '10:00-22:00' },
            { name: 'ç”°å­åŠ', type: 'è³¼ç‰©', location: 'ä¸Šæµ·é»ƒæµ¦å€', time: '10:00-22:00' },
            { name: 'ä¸Šæµ·è¿ªå£«å°¼', type: 'æ™¯é»', location: 'ä¸Šæµ·æµ¦æ±æ–°å€', time: '08:00-20:00' },
            { name: 'è±«åœ’', type: 'æ™¯é»', location: 'ä¸Šæµ·é»ƒæµ¦å€', time: '08:30-17:00' },
            { name: 'æ–°å¤©åœ°', type: 'è³¼ç‰©', location: 'ä¸Šæµ·é»ƒæµ¦å€', time: '10:00-24:00' },
            { name: 'éœå®‰å¯º', type: 'æ™¯é»', location: 'ä¸Šæµ·éœå®‰å€', time: '07:30-17:00' },
            { name: 'æœ±å®¶è§’å¤é®', type: 'æ™¯é»', location: 'ä¸Šæµ·é’æµ¦å€', time: '08:00-17:00' }
        ],
        foods: ['å°ç± åŒ…', 'ç”Ÿç…åŒ…', 'è”¥æ²¹æ‹Œéºµ', 'ç´…ç‡’è‚‰', 'å¤§é–˜èŸ¹', 'ç™½æ–¬é›', 'ç³–é†‹æ’éª¨', 'é†¬é´¨', 'æ²¹çˆ†è¦', 'å…«å¯¶é£¯'],
        defaultSchedule: []
    },
    'ğŸ‡¨ğŸ‡³ åŒ—äº¬': {
        country: 'ä¸­åœ‹', continent: 'äºæ´²', currency: 'CNY',
        spots: [
            { name: 'æ•…å®®', type: 'æ™¯é»', location: 'åŒ—äº¬æ±åŸå€', time: '08:30-17:00' },
            { name: 'é•·åŸ', type: 'æ™¯é»', location: 'åŒ—äº¬å»¶æ…¶å€', time: '07:30-17:30' },
            { name: 'å¤©å®‰é–€å»£å ´', type: 'æ™¯é»', location: 'åŒ—äº¬æ±åŸå€', time: '05:00-22:00' },
            { name: 'é ¤å’Œåœ’', type: 'æ™¯é»', location: 'åŒ—äº¬æµ·æ·€å€', time: '06:30-18:00' },
            { name: 'å¤©å£‡', type: 'æ™¯é»', location: 'åŒ—äº¬æ±åŸå€', time: '06:00-21:00' },
            { name: 'ä»€å‰æµ·', type: 'æ™¯é»', location: 'åŒ—äº¬è¥¿åŸå€', time: 'å…¨å¤©' },
            { name: 'å—é‘¼é¼“å··', type: 'è³¼ç‰©', location: 'åŒ—äº¬æ±åŸå€', time: '10:00-22:00' },
            { name: '798è—è¡“å€', type: 'æ™¯é»', location: 'åŒ—äº¬æœé™½å€', time: '10:00-18:00' },
            { name: 'é³¥å·¢', type: 'æ™¯é»', location: 'åŒ—äº¬æœé™½å€', time: '09:00-21:00' },
            { name: 'ç‹åºœäº•', type: 'è³¼ç‰©', location: 'åŒ—äº¬æ±åŸå€', time: '09:00-22:00' }
        ],
        foods: ['åŒ—äº¬çƒ¤é´¨', 'ç‚¸é†¬éºµ', 'æ¶®ç¾Šè‚‰', 'è±†æ±', 'é©¢æ‰“æ»¾', 'å†°ç³–è‘«è˜†', 'äº¬é†¬è‚‰çµ²', 'å®®ä¿é›ä¸', 'éº»è±†è…', 'çˆ†è‚š'],
        defaultSchedule: []
    },

    // ============ æ­æ´² (Europe) ============
    'ğŸ‡«ğŸ‡· å·´é»': {
        country: 'æ³•åœ‹', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'è‰¾è²çˆ¾éµå¡”', type: 'æ™¯é»', location: 'å·´é»ç¬¬ä¸ƒå€', time: '09:00-00:00' },
            { name: 'ç¾…æµ®å®®', type: 'æ™¯é»', location: 'å·´é»ç¬¬ä¸€å€', time: '09:00-18:00' },
            { name: 'å‡±æ—‹é–€', type: 'æ™¯é»', location: 'å·´é»ç¬¬å…«å€', time: '10:00-22:30' },
            { name: 'é¦™æ¦­éº—èˆå¤§é“', type: 'è³¼ç‰©', location: 'å·´é»ç¬¬å…«å€', time: '10:00-20:00' },
            { name: 'è–æ¯é™¢', type: 'æ™¯é»', location: 'å·´é»ç¬¬å››å€', time: '08:00-18:45' },
            { name: 'è’™é¦¬ç‰¹', type: 'æ™¯é»', location: 'å·´é»ç¬¬åå…«å€', time: '06:00-22:30' },
            { name: 'å‡¡çˆ¾è³½å®®', type: 'æ™¯é»', location: 'å‡¡çˆ¾è³½', time: '09:00-18:30' },
            { name: 'å¡ç´æ²³éŠèˆ¹', type: 'æ™¯é»', location: 'å·´é»', time: '10:00-22:00' },
            { name: 'å¥§è³½ç¾è¡“é¤¨', type: 'æ™¯é»', location: 'å·´é»ç¬¬ä¸ƒå€', time: '09:30-18:00' },
            { name: 'æ‹‰æ³•è‘‰ç™¾è²¨', type: 'è³¼ç‰©', location: 'å·´é»ç¬¬ä¹å€', time: '09:30-20:30' }
        ],
        foods: ['æ³•å¼å¯é Œ', 'é¦¬å¡é¾', 'æ³•å¼æ´‹è”¥æ¹¯', 'ç´…é…’ç‡‰ç‰›è‚‰', 'éµè‚é†¬', 'æ³•å¼è¸ç‰›', 'å¯éº—é¤…', 'æ³•æ£éºµåŒ…', 'èµ·å¸æ‹¼ç›¤', 'èˆ’èŠ™è•¾'],
        defaultSchedule: []
    },
    'ğŸ‡¬ğŸ‡§ å€«æ•¦': {
        country: 'è‹±åœ‹', continent: 'æ­æ´²', currency: 'GBP',
        spots: [
            { name: 'å¤§ç¬¨é˜', type: 'æ™¯é»', location: 'è¥¿æ•å¸‚', time: 'å…¨å¤©' },
            { name: 'ç™½é‡‘æ¼¢å®®', type: 'æ™¯é»', location: 'è¥¿æ•å¸‚', time: '09:30-19:00' },
            { name: 'å€«æ•¦å¡”', type: 'æ™¯é»', location: 'å¡”å“ˆå§†é›·ç‰¹å€', time: '09:00-17:30' },
            { name: 'å¤§è‹±åšç‰©é¤¨', type: 'æ™¯é»', location: 'å¡å§†ç™»å€', time: '10:00-17:00' },
            { name: 'å€«æ•¦çœ¼', type: 'æ™¯é»', location: 'è˜­è²æ–¯å€', time: '10:00-20:30' },
            { name: 'å¡”æ©‹', type: 'æ™¯é»', location: 'å¡”å“ˆå§†é›·ç‰¹å€', time: '09:30-18:00' },
            { name: 'æµ·å¾·å…¬åœ’', type: 'æ™¯é»', location: 'è¥¿æ•å¸‚', time: '05:00-00:00' },
            { name: 'æŸ¯èŠ¬åœ’', type: 'è³¼ç‰©', location: 'è¥¿æ•å¸‚', time: '10:00-20:00' },
            { name: 'ç‰›æ´¥è¡—', type: 'è³¼ç‰©', location: 'è¥¿æ•å¸‚', time: '09:30-21:00' },
            { name: 'è¥¿æ•å¯º', type: 'æ™¯é»', location: 'è¥¿æ•å¸‚', time: '09:30-15:30' }
        ],
        foods: ['ç‚¸é­šè–¯æ¢', 'è‹±å¼æ—©é¤', 'çƒ¤ç‰›è‚‰', 'ç‰§ç¾Šäººæ´¾', 'ç´„å…‹éƒ¡å¸ƒä¸', 'å¸åº·é¤…', 'è‹±å¼ä¸‹åˆèŒ¶', 'åº·æ²ƒçˆ¾è‚‰é¤¡é¤…', 'é»‘å¸ƒä¸', 'å¨éˆé “ç‰›æ’'],
        defaultSchedule: []
    },
    'ğŸ‡®ğŸ‡¹ ç¾…é¦¬': {
        country: 'ç¾©å¤§åˆ©', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'ç¾…é¦¬ç«¶æŠ€å ´', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: '08:30-19:00' },
            { name: 'ç‰¹é›·ç¶­å™´æ³‰', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: 'å…¨å¤©' },
            { name: 'è¥¿ç­ç‰™éšæ¢¯', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: 'å…¨å¤©' },
            { name: 'æ¢µè’‚å²¡åšç‰©é¤¨', type: 'æ™¯é»', location: 'æ¢µè’‚å²¡', time: '09:00-18:00' },
            { name: 'è–å½¼å¾—å¤§æ•™å ‚', type: 'æ™¯é»', location: 'æ¢µè’‚å²¡', time: '07:00-19:00' },
            { name: 'è¬ç¥æ®¿', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: '09:00-19:00' },
            { name: 'å¤ç¾…é¦¬å»£å ´', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: '08:30-19:00' },
            { name: 'ç´æ²ƒç´å»£å ´', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: 'å…¨å¤©' },
            { name: 'åšçˆ¾è“‹å¡ç¾è¡“é¤¨', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: '09:00-19:00' },
            { name: 'çœŸç†ä¹‹å£', type: 'æ™¯é»', location: 'ç¾…é¦¬', time: '09:30-17:50' }
        ],
        foods: ['ç¾©å¤§åˆ©éºµ', 'æŠ«è–©', 'ææ‹‰ç±³è˜‡', 'ç¾©å¼å†°æ·‡æ·‹', 'ç‡‰é£¯', 'åƒå±¤éºµ', 'å¡å¸ƒå¥‡è«¾', 'ç¾©å¼ç«è…¿', 'ç¾©å¼æ¿ƒç¸®å’–å•¡', 'ç‚¸é£¯çƒ'],
        defaultSchedule: []
    },
    'ğŸ‡®ğŸ‡¹ å¨å°¼æ–¯': {
        country: 'ç¾©å¤§åˆ©', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'è–é¦¬å¯å»£å ´', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: 'å…¨å¤©' },
            { name: 'è–é¦¬å¯å¤§æ•™å ‚', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: '09:30-17:00' },
            { name: 'ç¸½ç£å®®', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: '08:30-19:00' },
            { name: 'é‡Œäºæ‰˜æ©‹', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: 'å…¨å¤©' },
            { name: 'å˜†æ¯æ©‹', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: 'å…¨å¤©' },
            { name: 'å¸ƒæ‹‰è«¾å³¶', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: '09:00-17:00' },
            { name: 'ç©†æ‹‰è«¾å³¶', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: '09:00-17:00' },
            { name: 'è²¢å¤šæ‹‰éŠèˆ¹', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: '09:00-19:00' },
            { name: 'å­¸é™¢ç¾è¡“é¤¨', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: '08:15-19:15' },
            { name: 'è–å–¬æ²»é¦¬ç„¦é›·å³¶', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: '09:00-19:00' }
        ],
        foods: ['æµ·é®®ç¾©å¤§åˆ©éºµ', 'å¢¨é­šæ±éºµ', 'ç‚¸æµ·é®®', 'ç¾©å¼çƒ¤é­š', 'å¨å°¼æ–¯é¤…ä¹¾', 'é–‹èƒƒå°é»', 'ç¾©å¼å¥¶å‡', 'æ™®ç¾…è³½å…‹æ°£æ³¡é…’', 'ç‰ç±³ç³•', 'æ²™ä¸é­š'],
        defaultSchedule: []
    },
    'ğŸ‡ªğŸ‡¸ å·´å¡éš†ç´': {
        country: 'è¥¿ç­ç‰™', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'è–å®¶å ‚', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: '09:00-20:00' },
            { name: 'å¥çˆ¾å…¬åœ’', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: '09:30-19:30' },
            { name: 'è˜­å¸ƒæ‹‰å¤§é“', type: 'è³¼ç‰©', location: 'å·´å¡éš†ç´', time: 'å…¨å¤©' },
            { name: 'å·´ç‰¹å©ä¹‹å®¶', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: '09:00-21:00' },
            { name: 'ç±³æ‹‰ä¹‹å®¶', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: '09:00-20:30' },
            { name: 'å“¥å¾·å€', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: 'å…¨å¤©' },
            { name: 'æ³¢è“‹åˆ©äºå¸‚å ´', type: 'ç¾é£Ÿ', location: 'å·´å¡éš†ç´', time: '08:00-20:30' },
            { name: 'å·´å¡éš†ç´æµ·ç˜', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: 'å…¨å¤©' },
            { name: 'ç•¢å¡ç´¢ç¾è¡“é¤¨', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: '10:00-20:00' },
            { name: 'è«¾åæ™®çƒå ´', type: 'æ™¯é»', location: 'å·´å¡éš†ç´', time: '10:00-18:30' }
        ],
        foods: ['è¥¿ç­ç‰™æµ·é®®é£¯', 'Tapaså°èœ', 'è¥¿ç­ç‰™ç«è…¿', 'ç•ªèŒ„éºµåŒ…', 'çƒ¤ç« é­š', 'è¥¿ç­ç‰™è›‹é¤…', 'æ²¹æ¢å·§å…‹åŠ›', 'æ¡‘æ ¼åˆ©äºé…’', 'è¥¿ç­ç‰™å†·æ¹¯', 'ç‚¸å¯æ¨‚é¤…'],
        defaultSchedule: []
    },
    'ğŸ‡©ğŸ‡ª æ…•å°¼é»‘': {
        country: 'å¾·åœ‹', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'ç‘ªåˆ©äºå»£å ´', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: 'å…¨å¤©' },
            { name: 'æ–°å¸‚æ”¿å»³', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: '10:00-17:00' },
            { name: 'å¯§èŠ¬å ¡å®®', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: '09:00-18:00' },
            { name: 'è‹±åœ‹èŠ±åœ’', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: 'å…¨å¤©' },
            { name: 'çš‡å®¶å•¤é…’å±‹', type: 'ç¾é£Ÿ', location: 'æ…•å°¼é»‘', time: '09:00-23:30' },
            { name: 'å¯¶é¦¬åšç‰©é¤¨', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: '10:00-18:00' },
            { name: 'è€å½¼å¾—æ•™å ‚', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: '09:00-19:00' },
            { name: 'å¾·æ„å¿—åšç‰©é¤¨', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: '09:00-17:00' },
            { name: 'ç¶­å…‹åœ–é˜¿é€£å¸‚å ´', type: 'ç¾é£Ÿ', location: 'æ…•å°¼é»‘', time: '08:00-20:00' },
            { name: 'å¥§æ—åŒ¹å…‹å…¬åœ’', type: 'æ™¯é»', location: 'æ…•å°¼é»‘', time: 'å…¨å¤©' }
        ],
        foods: ['å¾·åœ‹é¦™è…¸', 'çƒ¤è±¬è…³', 'å¾·åœ‹å•¤é…’', 'æ¤’é¹½è„†é¤…', 'é…¸èœ', 'å¾·å¼åœŸè±†æ²™æ‹‰', 'ç™½é¦™è…¸', 'è˜‹æœæ²', 'è±¬æ’', 'é¦¬éˆ´è–¯é¤ƒå­'],
        defaultSchedule: []
    },
    'ğŸ‡³ğŸ‡± é˜¿å§†æ–¯ç‰¹ä¸¹': {
        country: 'è·è˜­', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'å®‰å¦®ä¹‹å®¶', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: '09:00-22:00' },
            { name: 'æ¢µè°·åšç‰©é¤¨', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: '09:00-18:00' },
            { name: 'åœ‹å®¶åšç‰©é¤¨', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: '09:00-17:00' },
            { name: 'æ°´å£©å»£å ´', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: 'å…¨å¤©' },
            { name: 'é‹æ²³éŠèˆ¹', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: '09:00-22:00' },
            { name: 'ç´…ç‡ˆå€', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: 'æ™šä¸Š' },
            { name: 'èŠ±å‰å¸‚å ´', type: 'è³¼ç‰©', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: '09:00-17:30' },
            { name: 'åº«è‚¯éœå¤«èŠ±åœ’', type: 'æ™¯é»', location: 'åˆ©ç‘Ÿ', time: '08:00-19:30' },
            { name: 'æµ·å°¼æ ¹é«”é©—é¤¨', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: '10:30-19:30' },
            { name: 'ç´„æ—¦å€', type: 'æ™¯é»', location: 'é˜¿å§†æ–¯ç‰¹ä¸¹', time: 'å…¨å¤©' }
        ],
        foods: ['è·è˜­é¬†é¤…', 'è·è˜­èµ·å¸', 'è–¯æ¢', 'ç”Ÿé¯¡é­š', 'è˜‹æœæ´¾', 'ç‚¸è‚‰ä¸¸', 'è±Œè±†æ¹¯', 'è·è˜­ç…é¤…', 'ç„¦ç³–é¤…ä¹¾', 'å¯æ¨‚é¤…'],
        defaultSchedule: []
    },
    'ğŸ‡¨ğŸ‡­ è˜‡é»ä¸–': {
        country: 'ç‘å£«', continent: 'æ­æ´²', currency: 'CHF',
        spots: [
            { name: 'ç­éœå¤«å¤§è¡—', type: 'è³¼ç‰©', location: 'è˜‡é»ä¸–', time: '09:00-20:00' },
            { name: 'è˜‡é»ä¸–æ¹–', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: 'å…¨å¤©' },
            { name: 'è€åŸå€', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: 'å…¨å¤©' },
            { name: 'è˜‡é»ä¸–å¤§æ•™å ‚', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: '10:00-18:00' },
            { name: 'è–æ¯å¤§æ•™å ‚', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: '10:00-18:00' },
            { name: 'æ—ç™»éœå¤«', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: 'å…¨å¤©' },
            { name: 'ç‘å£«åœ‹å®¶åšç‰©é¤¨', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: '10:00-17:00' },
            { name: 'å‹•ç‰©åœ’', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: '09:00-18:00' },
            { name: 'èŠèŒµç€‘å¸ƒ', type: 'æ™¯é»', location: 'æ²™å¤«è±ªæ£®', time: '09:00-19:00' },
            { name: 'ç‰ç‰¹åˆ©å±±', type: 'æ™¯é»', location: 'è˜‡é»ä¸–', time: 'å…¨å¤©' }
        ],
        foods: ['èµ·å¸ç«é‹', 'å·§å…‹åŠ›', 'ç‘å£«ä¹³é…ª', 'æ‹‰å…‹é›·ç‰¹èµ·å¸', 'ç‘å£«å¾·åœ‹é¦™è…¸', 'é¦¬éˆ´è–¯é¤…', 'æ´‹è”¥å¡”', 'è˜‡é»ä¸–å°ç‰›è‚‰', 'è¾®å­éºµåŒ…', 'ç‘å£«å·§å…‹åŠ›é£²å“'],
        defaultSchedule: []
    },
    'ğŸ‡¦ğŸ‡¹ ç¶­ä¹Ÿç´': {
        country: 'å¥§åœ°åˆ©', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'ç¾æ³‰å®®', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: '08:00-17:30' },
            { name: 'è–å²è’‚èŠ¬å¤§æ•™å ‚', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: '06:00-22:00' },
            { name: 'éœå¤«å ¡çš‡å®®', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: '09:00-17:30' },
            { name: 'æ™®æ‹‰ç‰¹éŠæ¨‚å ´', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: '10:00-00:00' },
            { name: 'ç¶­ä¹Ÿç´åœ‹å®¶æ­ŒåŠ‡é™¢', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: 'å°è¦½æ™‚é–“' },
            { name: 'è²çˆ¾ç¶­ç¬¬å®®', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: '09:00-18:00' },
            { name: 'ç´è¨±å¸‚å ´', type: 'ç¾é£Ÿ', location: 'ç¶­ä¹Ÿç´', time: '06:00-21:00' },
            { name: 'è—è¡“å²åšç‰©é¤¨', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: '10:00-18:00' },
            { name: 'ç™¾æ°´å…¬å¯“', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: 'å…¨å¤©' },
            { name: 'ç’°åŸå¤§é“', type: 'æ™¯é»', location: 'ç¶­ä¹Ÿç´', time: 'å…¨å¤©' }
        ],
        foods: ['ç¶­ä¹Ÿç´ç‚¸ç‰›æ’', 'è˜‹æœæ²', 'è–©èµ«è›‹ç³•', 'ç¶­ä¹Ÿç´é¦™è…¸', 'å¡”è²»çˆ¾æ–¯çš®èŒ¨', 'ç‰›è‚‰æ¹¯', 'å¸ç‹ç…é¤…', 'ææ¡ƒé¤ƒå­', 'ç¶­ä¹Ÿç´å’–å•¡', 'å¥§åœ°åˆ©ç‡‰ç‰›è‚‰'],
        defaultSchedule: []
    },
    'ğŸ‡¨ğŸ‡¿ å¸ƒæ‹‰æ ¼': {
        country: 'æ·å…‹', continent: 'æ­æ´²', currency: 'CZK',
        spots: [
            { name: 'æŸ¥ç†å¤§æ©‹', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: 'å…¨å¤©' },
            { name: 'å¸ƒæ‹‰æ ¼åŸå ¡', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: '09:00-17:00' },
            { name: 'è€åŸå»£å ´', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: 'å…¨å¤©' },
            { name: 'å¤©æ–‡é˜', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: '09:00-21:00' },
            { name: 'è–ç¶­ç‰¹å¤§æ•™å ‚', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: '09:00-17:00' },
            { name: 'çŒ¶å¤ªå€', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: '09:00-18:00' },
            { name: 'ä½©ç‰¹ä»»å±±', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: 'å…¨å¤©' },
            { name: 'ç“¦èŒ¨æ‹‰å¤«å»£å ´', type: 'è³¼ç‰©', location: 'å¸ƒæ‹‰æ ¼', time: 'å…¨å¤©' },
            { name: 'è·³èˆçš„æˆ¿å­', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: 'å…¨å¤©' },
            { name: 'å°åŸå€', type: 'æ™¯é»', location: 'å¸ƒæ‹‰æ ¼', time: 'å…¨å¤©' }
        ],
        foods: ['çƒ¤è±¬è†', 'æ·å…‹é¤ƒå­', 'æ·å…‹å•¤é…’', 'ç‡‰ç‰›è‚‰', 'ç‚¸èµ·å¸', 'æ·å…‹é¦™è…¸', 'è˜‹æœæ²', 'ç…™å›ªè›‹ç³•', 'ç”œèœæ¹¯', 'è±¬è‚‰æ’'],
        defaultSchedule: []
    },
    'ğŸ‡¬ğŸ‡· é›…å…¸': {
        country: 'å¸Œè‡˜', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'è¡›åŸ', type: 'æ™¯é»', location: 'é›…å…¸', time: '08:00-20:00' },
            { name: 'å¸•å¾·å«©ç¥æ®¿', type: 'æ™¯é»', location: 'é›…å…¸', time: '08:00-20:00' },
            { name: 'æ™®æ‹‰å¡å€', type: 'è³¼ç‰©', location: 'é›…å…¸', time: 'å…¨å¤©' },
            { name: 'æ†²æ³•å»£å ´', type: 'æ™¯é»', location: 'é›…å…¸', time: 'å…¨å¤©' },
            { name: 'è¡›åŸåšç‰©é¤¨', type: 'æ™¯é»', location: 'é›…å…¸', time: '08:00-20:00' },
            { name: 'å®™æ–¯ç¥æ®¿', type: 'æ™¯é»', location: 'é›…å…¸', time: '08:00-20:00' },
            { name: 'åˆ©å¡ç¶­å¤šæ–¯å±±', type: 'æ™¯é»', location: 'é›…å…¸', time: 'å…¨å¤©' },
            { name: 'å¤å¸‚é›†éºå€', type: 'æ™¯é»', location: 'é›…å…¸', time: '08:00-20:00' },
            { name: 'åœ‹å®¶è€ƒå¤åšç‰©é¤¨', type: 'æ™¯é»', location: 'é›…å…¸', time: '08:00-20:00' },
            { name: 'è’™ç´æ–¯ææ‹‰å¥‡å»£å ´', type: 'è³¼ç‰©', location: 'é›…å…¸', time: 'å…¨å¤©' }
        ],
        foods: ['çƒ¤è‚‰ä¸²', 'ç©†è–©å¡', 'å¸Œè‡˜æ²™æ‹‰', 'çš®å¡”é¤…', 'èŒ„å­é†¬', 'ç‚¸ä¹³é…ª', 'å¸Œè‡˜å„ªæ ¼', 'è‘¡è„è‘‰é£¯æ²', 'æµ·é®®', 'æœä»èœœé¤…'],
        defaultSchedule: []
    },
    'ğŸ‡¬ğŸ‡· è–æ‰˜é‡Œå°¼': {
        country: 'å¸Œè‡˜', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'ä¼Šäºæ—¥è½', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: '17:00-20:00' },
            { name: 'è²»æ‹‰é®', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: 'å…¨å¤©' },
            { name: 'è—é ‚æ•™å ‚', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: 'å…¨å¤©' },
            { name: 'ç´…æ²™ç˜', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: '09:00-18:00' },
            { name: 'é»‘æ²™ç˜', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: '09:00-18:00' },
            { name: 'é˜¿å…‹ç¾…è’‚é‡Œéºå€', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: '08:00-20:00' },
            { name: 'ç«å±±å³¶', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: '09:00-17:00' },
            { name: 'çš®çˆ¾æˆˆæ–¯æ‘', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: 'å…¨å¤©' },
            { name: 'é…’èŠä¹‹æ—…', type: 'ç¾é£Ÿ', location: 'è–æ‰˜é‡Œå°¼', time: '10:00-19:00' },
            { name: 'å¡é¦¬åˆ©æµ·ç˜', type: 'æ™¯é»', location: 'è–æ‰˜é‡Œå°¼', time: '09:00-18:00' }
        ],
        foods: ['çƒ¤ç« é­š', 'ç•ªèŒ„çƒ', 'èŒ„å­æ²™æ‹‰', 'å¸Œè‡˜ç™½é…’', 'æµ·é®®ç¾©å¤§åˆ©éºµ', 'çƒ¤ç¾Šè‚‰', 'è²é”ä¹³é…ª', 'èœ‚èœœç”œé»', 'æ©„æ¬–æ²¹éºµåŒ…', 'å¸Œè‡˜å’–å•¡'],
        defaultSchedule: []
    },
    'ğŸ‡µğŸ‡¹ é‡Œæ–¯æœ¬': {
        country: 'è‘¡è„ç‰™', continent: 'æ­æ´²', currency: 'EUR',
        spots: [
            { name: 'è²å€«å¡”', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: '10:00-17:30' },
            { name: 'ç†±ç¾…å°¼è«æ–¯ä¿®é“é™¢', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: '10:00-17:30' },
            { name: 'é˜¿æ³•ç‘ªå€', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: 'å…¨å¤©' },
            { name: 'è–å–¬æ²»åŸå ¡', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: '09:00-21:00' },
            { name: '28è™Ÿé›»è»Š', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: 'å…¨å¤©' },
            { name: 'ç¾…è¥¿æ­å»£å ´', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: 'å…¨å¤©' },
            { name: 'å¥§å¤æ–¯å¡”è¡—å‡±æ—‹é–€', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: '09:00-20:00' },
            { name: 'è¾›ç‰¹æ‹‰å®®', type: 'æ™¯é»', location: 'è¾›ç‰¹æ‹‰', time: '09:30-18:30' },
            { name: 'LXå·¥å» ', type: 'è³¼ç‰©', location: 'é‡Œæ–¯æœ¬', time: '10:00-00:00' },
            { name: 'æ³•æœµè¡¨æ¼”', type: 'æ™¯é»', location: 'é‡Œæ–¯æœ¬', time: '20:00-23:00' }
        ],
        foods: ['è‘¡å¼è›‹æ’»', 'çƒ¤æ²™ä¸é­š', 'è‘¡å¼ç‡‰é›œç¢', 'å·´å¡å‹é±ˆé­š', 'è±¬æ‰’åŒ…', 'æµ·é®®é£¯', 'è‘¡å¼çƒ¤é›', 'æ³¢ç‰¹é…’', 'èµ·å¸è›‹ç³•', 'ç¶ æ¹¯'],
        defaultSchedule: []
    },

    // ============ åŒ—ç¾æ´² (North America) ============
    'ğŸ‡ºğŸ‡¸ ç´ç´„': {
        country: 'ç¾åœ‹', continent: 'åŒ—ç¾æ´²', currency: 'USD',
        spots: [
            { name: 'è‡ªç”±å¥³ç¥åƒ', type: 'æ™¯é»', location: 'è‡ªç”±å³¶', time: '08:30-16:00' },
            { name: 'æ™‚ä»£å»£å ´', type: 'æ™¯é»', location: 'æ›¼å“ˆé “', time: 'å…¨å¤©' },
            { name: 'ä¸­å¤®å…¬åœ’', type: 'æ™¯é»', location: 'æ›¼å“ˆé “', time: '06:00-01:00' },
            { name: 'å¸åœ‹å¤§å»ˆ', type: 'æ™¯é»', location: 'æ›¼å“ˆé “', time: '10:00-00:00' },
            { name: 'å¤§éƒ½æœƒè—è¡“åšç‰©é¤¨', type: 'æ™¯é»', location: 'æ›¼å“ˆé “', time: '10:00-17:00' },
            { name: 'å¸ƒé­¯å…‹æ—å¤§æ©‹', type: 'æ™¯é»', location: 'å¸ƒé­¯å…‹æ—', time: 'å…¨å¤©' },
            { name: 'ç¬¬äº”å¤§é“', type: 'è³¼ç‰©', location: 'æ›¼å“ˆé “', time: '10:00-20:00' },
            { name: 'ç™¾è€åŒ¯', type: 'æ™¯é»', location: 'æ›¼å“ˆé “', time: 'æ™šä¸Š' },
            { name: 'æ´›å…‹æ–å‹’ä¸­å¿ƒ', type: 'æ™¯é»', location: 'æ›¼å“ˆé “', time: '08:00-00:00' },
            { name: 'è¯çˆ¾è¡—', type: 'æ™¯é»', location: 'æ›¼å“ˆé “', time: 'å…¨å¤©' }
        ],
        foods: ['ç´ç´„æŠ«è–©', 'ç´ç´„è²æœ', 'ç†±ç‹—', 'èµ·å¸è›‹ç³•', 'é¾è¦', 'ç‰›æ’', 'æ¼¢å ¡', 'é»‘ç™½é¤…ä¹¾', 'å¸•æ–¯ç‰¹æ‹‰ç±³ä¸‰æ˜æ²»', 'è˜‹æœæ´¾'],
        defaultSchedule: []
    },
    'ğŸ‡ºğŸ‡¸ æ´›æ‰ç£¯': {
        country: 'ç¾åœ‹', continent: 'åŒ—ç¾æ´²', currency: 'USD',
        spots: [
            { name: 'å¥½èŠå¡¢æ¨™èªŒ', type: 'æ™¯é»', location: 'å¥½èŠå¡¢', time: 'å…¨å¤©' },
            { name: 'ç’°çƒå½±åŸ', type: 'æ™¯é»', location: 'å¥½èŠå¡¢', time: '09:00-22:00' },
            { name: 'è¿ªå£«å°¼æ¨‚åœ’', type: 'æ™¯é»', location: 'é˜¿ç´æµ·å§†', time: '08:00-00:00' },
            { name: 'è–å¡”è«å°¼å¡æµ·ç˜', type: 'æ™¯é»', location: 'è–å¡”è«å°¼å¡', time: 'å…¨å¤©' },
            { name: 'æ¯”ä½›åˆ©å±±èŠ', type: 'è³¼ç‰©', location: 'æ¯”ä½›åˆ©å±±', time: '10:00-18:00' },
            { name: 'æ ¼é‡Œè²æ–¯å¤©æ–‡å°', type: 'æ™¯é»', location: 'æ´›æ‰ç£¯', time: '12:00-22:00' },
            { name: 'å¨å°¼æ–¯æµ·ç˜', type: 'æ™¯é»', location: 'å¨å°¼æ–¯', time: 'å…¨å¤©' },
            { name: 'å¥½èŠå¡¢æ˜Ÿå…‰å¤§é“', type: 'æ™¯é»', location: 'å¥½èŠå¡¢', time: 'å…¨å¤©' },
            { name: 'è“‹è’‚ä¸­å¿ƒ', type: 'æ™¯é»', location: 'æ´›æ‰ç£¯', time: '10:00-17:30' },
            { name: 'è¾²å¤«å¸‚å ´', type: 'ç¾é£Ÿ', location: 'æ´›æ‰ç£¯', time: '09:00-21:00' }
        ],
        foods: ['å¢¨è¥¿å“¥æ²é¤…', 'æ¼¢å ¡', 'å£½å¸', 'éŸ“å¼çƒ¤è‚‰', 'è¶Šå—æ²³ç²‰', 'In-N-Outæ¼¢å ¡', 'æ³•å¼æ²¾é†¬ä¸‰æ˜æ²»', 'ç‚¸é­šå¡”å¯', 'åŠ å·å·', 'æœæ˜”ç¢—'],
        defaultSchedule: []
    },
    'ğŸ‡ºğŸ‡¸ èˆŠé‡‘å±±': {
        country: 'ç¾åœ‹', continent: 'åŒ—ç¾æ´²', currency: 'USD',
        spots: [
            { name: 'é‡‘é–€å¤§æ©‹', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±', time: 'å…¨å¤©' },
            { name: 'æ¼äººç¢¼é ­', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±', time: '10:00-22:00' },
            { name: 'æƒ¡é­”å³¶', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±ç£', time: '09:00-18:30' },
            { name: 'ä¹æ›²èŠ±è¡—', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±', time: 'å…¨å¤©' },
            { name: 'è¯åˆå»£å ´', type: 'è³¼ç‰©', location: 'èˆŠé‡‘å±±', time: '10:00-20:00' },
            { name: 'å”äººè¡—', type: 'ç¾é£Ÿ', location: 'èˆŠé‡‘å±±', time: 'å…¨å¤©' },
            { name: 'çºœè»Š', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±', time: '06:00-00:30' },
            { name: 'é‡‘é–€å…¬åœ’', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±', time: 'å…¨å¤©' },
            { name: 'è—è¡“å®®', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±', time: 'å…¨å¤©' },
            { name: '39è™Ÿç¢¼é ­', type: 'æ™¯é»', location: 'èˆŠé‡‘å±±', time: '10:00-21:00' }
        ],
        foods: ['é…¸éºµåŒ…', 'è›¤èœŠå·§é”æ¹¯', 'èƒèŸ¹', 'æµ·é®®', 'æ„›çˆ¾è˜­å’–å•¡', 'å¢¨è¥¿å“¥æ²é¤…', 'é»å¿ƒ', 'æŠ«è–©', 'æœ‰æ©Ÿæ²™æ‹‰', 'ç²¾å“å’–å•¡'],
        defaultSchedule: []
    },
    'ğŸ‡ºğŸ‡¸ æ‹‰æ–¯ç¶­åŠ æ–¯': {
        country: 'ç¾åœ‹', continent: 'åŒ—ç¾æ´²', currency: 'USD',
        spots: [
            { name: 'æ‹‰æ–¯ç¶­åŠ æ–¯å¤§é“', type: 'æ™¯é»', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: 'å…¨å¤©' },
            { name: 'ç™¾æ¨‚å®®å™´æ³‰', type: 'æ™¯é»', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: '15:00-00:00' },
            { name: 'å¨å°¼æ–¯äººé…’åº—', type: 'æ™¯é»', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: 'å…¨å¤©' },
            { name: 'å¼—åˆ©è’™è¡—', type: 'æ™¯é»', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: '18:00-02:00' },
            { name: 'å¤§å³½è°·', type: 'æ™¯é»', location: 'äºåˆ©æ¡‘é‚£å·', time: 'å…¨å¤©' },
            { name: 'èƒ¡ä½›æ°´å£©', type: 'æ™¯é»', location: 'å…§è¯é”å·', time: '09:00-17:00' },
            { name: 'å¤ªé™½åŠ‡åœ˜', type: 'æ™¯é»', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: 'æ™šä¸Š' },
            { name: 'é«˜å¡”è§€æ™¯å°', type: 'æ™¯é»', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: '10:00-01:00' },
            { name: 'Caesars Palace', type: 'è³¼ç‰©', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: 'å…¨å¤©' },
            { name: 'ç´…å²©å³½è°·', type: 'æ™¯é»', location: 'æ‹‰æ–¯ç¶­åŠ æ–¯', time: '06:00-19:00' }
        ],
        foods: ['è‡ªåŠ©é¤', 'ç‰›æ’', 'é¾è¦', 'å£½å¸', 'æ¼¢å ¡', 'ç‚¸é›', 'ä¸­å¼æ–™ç†', 'ç¾©å¤§åˆ©é¤', 'æ³•å¼æ–™ç†', 'ç”œé»è‡ªåŠ©'],
        defaultSchedule: []
    },
    'ğŸ‡ºğŸ‡¸ å¤å¨å¤·': {
        country: 'ç¾åœ‹', continent: 'åŒ—ç¾æ´²', currency: 'USD',
        spots: [
            { name: 'å¨åŸºåŸºæµ·ç˜', type: 'æ™¯é»', location: 'æª€é¦™å±±', time: 'å…¨å¤©' },
            { name: 'çç æ¸¯', type: 'æ™¯é»', location: 'æª€é¦™å±±', time: '07:00-17:00' },
            { name: 'é‘½çŸ³é ­å±±', type: 'æ™¯é»', location: 'æª€é¦™å±±', time: '06:00-18:00' },
            { name: 'æé¾ç£', type: 'æ™¯é»', location: 'æ­èƒ¡å³¶', time: '06:00-16:00' },
            { name: 'åŒ—å²¸', type: 'æ™¯é»', location: 'æ­èƒ¡å³¶', time: 'å…¨å¤©' },
            { name: 'ç»é‡Œå°¼è¥¿äºæ–‡åŒ–ä¸­å¿ƒ', type: 'æ™¯é»', location: 'æ­èƒ¡å³¶', time: '12:00-21:00' },
            { name: 'ä¼Šå¥§æ‹‰å°¼å®®', type: 'æ™¯é»', location: 'æª€é¦™å±±', time: '09:00-16:00' },
            { name: 'é˜¿æ‹‰è«é˜¿é‚£ä¸­å¿ƒ', type: 'è³¼ç‰©', location: 'æª€é¦™å±±', time: '09:30-21:00' },
            { name: 'ç§‘ç´å’–å•¡åœ’', type: 'æ™¯é»', location: 'å¤§å³¶', time: '09:00-16:00' },
            { name: 'ç«å±±åœ‹å®¶å…¬åœ’', type: 'æ™¯é»', location: 'å¤§å³¶', time: 'å…¨å¤©' }
        ],
        foods: ['å¤å¨å¤·ç”Ÿé­šé£¯', 'çƒ¤è±¬è‚‰', 'å¤å¨å¤·é£¯ç³°', 'åˆ¨å†°', 'é³³æ¢¨', 'æ¤°å­', 'è’œè¦é£¯', 'å¤å¨å¤·æ¼¢å ¡æ’', 'èŠ‹é ­', 'å¤å¨å¤·æœä»'],
        defaultSchedule: []
    },
    'ğŸ‡¨ğŸ‡¦ æº«å“¥è¯': {
        country: 'åŠ æ‹¿å¤§', continent: 'åŒ—ç¾æ´²', currency: 'CAD',
        spots: [
            { name: 'å²ä¸¹åˆ©å…¬åœ’', type: 'æ™¯é»', location: 'æº«å“¥è¯', time: 'å…¨å¤©' },
            { name: 'å¡çš®æ‹‰è«¾åŠæ©‹', type: 'æ™¯é»', location: 'åŒ—æº«å“¥è¯', time: '09:00-18:00' },
            { name: 'æ ¼è˜­ç¶­çˆ¾å³¶', type: 'è³¼ç‰©', location: 'æº«å“¥è¯', time: '09:00-19:00' },
            { name: 'è“‹æ–¯é®', type: 'æ™¯é»', location: 'æº«å“¥è¯', time: 'å…¨å¤©' },
            { name: 'è‹±å‰åˆ©ç£', type: 'æ™¯é»', location: 'æº«å“¥è¯', time: 'å…¨å¤©' },
            { name: 'å”äººè¡—', type: 'ç¾é£Ÿ', location: 'æº«å“¥è¯', time: 'å…¨å¤©' },
            { name: 'æº«å“¥è¯æ°´æ—é¤¨', type: 'æ™¯é»', location: 'æº«å“¥è¯', time: '10:00-17:00' },
            { name: 'ç¾…å¸ƒæ£®è¡—', type: 'è³¼ç‰©', location: 'æº«å“¥è¯', time: '10:00-21:00' },
            { name: 'å¥³ç‹å…¬åœ’', type: 'æ™¯é»', location: 'æº«å“¥è¯', time: 'å…¨å¤©' },
            { name: 'æ ¼å‹æ–¯å±±', type: 'æ™¯é»', location: 'åŒ—æº«å“¥è¯', time: '09:00-22:00' }
        ],
        foods: ['ä¸‰æ–‡é­š', 'å£½å¸', 'æ—¥å¼æ‹‰éºµ', 'ç‚¸é­šè–¯æ¢', 'é¾è¦', 'æ¥“ç³–æ¼¿', 'è‚‰æ±è–¯æ¢', 'å¸Œè‡˜æ–™ç†', 'ç²¾é‡€å•¤é…’', 'ç”Ÿè ”'],
        defaultSchedule: []
    },
    'ğŸ‡¨ğŸ‡¦ å¤šå€«å¤š': {
        country: 'åŠ æ‹¿å¤§', continent: 'åŒ—ç¾æ´²', currency: 'CAD',
        spots: [
            { name: 'CNå¡”', type: 'æ™¯é»', location: 'å¤šå€«å¤š', time: '09:00-22:30' },
            { name: 'å°¼åŠ æ‹‰ç€‘å¸ƒ', type: 'æ™¯é»', location: 'å°¼åŠ æ‹‰', time: 'å…¨å¤©' },
            { name: 'çš‡å®¶å®‰å¤§ç•¥åšç‰©é¤¨', type: 'æ™¯é»', location: 'å¤šå€«å¤š', time: '10:00-17:30' },
            { name: 'è–ç¾…å€«æ–¯å¸‚å ´', type: 'ç¾é£Ÿ', location: 'å¤šå€«å¤š', time: '08:00-18:00' },
            { name: 'å¤®è¡—', type: 'è³¼ç‰©', location: 'å¤šå€«å¤š', time: '10:00-21:00' },
            { name: 'å¤šå€«å¤šç¾¤å³¶', type: 'æ™¯é»', location: 'å¤šå€«å¤š', time: 'å…¨å¤©' },
            { name: 'è‚¯è¾›é “å¸‚å ´', type: 'è³¼ç‰©', location: 'å¤šå€«å¤š', time: '09:00-19:00' },
            { name: 'å¡è–©ç¾…é¦¬åŸå ¡', type: 'æ™¯é»', location: 'å¤šå€«å¤š', time: '09:30-17:00' },
            { name: 'å¤šå€«å¤šå‹•ç‰©åœ’', type: 'æ™¯é»', location: 'å¤šå€«å¤š', time: '09:00-16:30' },
            { name: 'å®‰å¤§ç•¥ç¾è¡“é¤¨', type: 'æ™¯é»', location: 'å¤šå€«å¤š', time: '10:30-17:00' }
        ],
        foods: ['è‚‰æ±è–¯æ¢', 'è’™ç‰¹å©ç‡»è‚‰ä¸‰æ˜æ²»', 'æ¥“ç³–', 'æŠ«è–©', 'å¸Œè‡˜æ–™ç†', 'åŠ æ‹¿å¤§åŸ¹æ ¹', 'å¥¶æ²¹å¡”', 'é®®è ”', 'ç‰›æ’', 'ç²¾é‡€å•¤é…’'],
        defaultSchedule: []
    },
    'ğŸ‡²ğŸ‡½ åæ˜†': {
        country: 'å¢¨è¥¿å“¥', continent: 'åŒ—ç¾æ´²', currency: 'MXN',
        spots: [
            { name: 'åæ˜†æµ·ç˜', type: 'æ™¯é»', location: 'åæ˜†', time: 'å…¨å¤©' },
            { name: 'å¥‡ç´ä¼Šå¯Ÿ', type: 'æ™¯é»', location: 'å°¤å¡å¦', time: '08:00-17:00' },
            { name: 'å¥³äººå³¶', type: 'æ™¯é»', location: 'åæ˜†', time: 'å…¨å¤©' },
            { name: 'åœ–ç›§å§†éºå€', type: 'æ™¯é»', location: 'åœ–ç›§å§†', time: '08:00-17:00' },
            { name: 'è¥¿å¡èŠç‰¹å…¬åœ’', type: 'æ™¯é»', location: 'é‡Œç¶­åŸƒæ‹‰ç‘ªé›…', time: '08:30-22:00' },
            { name: 'La Islaè³¼ç‰©æ‘', type: 'è³¼ç‰©', location: 'åæ˜†', time: '10:00-22:00' },
            { name: 'æ°´ä¸‹åšç‰©é¤¨', type: 'æ™¯é»', location: 'åæ˜†', time: '09:00-14:00' },
            { name: 'å¤©ç„¶äº•', type: 'æ™¯é»', location: 'å°¤å¡å¦', time: '09:00-17:00' },
            { name: 'Coco Bongoå¤œåº—', type: 'æ™¯é»', location: 'åæ˜†', time: '22:00-04:00' },
            { name: 'å¯å¯æµ·ç˜', type: 'æ™¯é»', location: 'åæ˜†', time: 'å…¨å¤©' }
        ],
        foods: ['å¡”å¯', 'å¢¨è¥¿å“¥æ²é¤…', 'é…ªæ¢¨é†¬', 'å¢¨è¥¿å“¥è¾£æ¤’', 'è«é›·é†¬', 'ç‚¸ç‰ç±³é¤…', 'ç‰ç±³ç²¥', 'é¾èˆŒè˜­é…’', 'æµ·é®®æ¹¯', 'å¢¨è¥¿å“¥ä¸‰æ˜æ²»'],
        defaultSchedule: []
    },

    // ============ å¤§æ´‹æ´² (Oceania) ============
    'ğŸ‡¦ğŸ‡º é›ªæ¢¨': {
        country: 'æ¾³æ´²', continent: 'å¤§æ´‹æ´²', currency: 'AUD',
        spots: [
            { name: 'é›ªæ¢¨æ­ŒåŠ‡é™¢', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: '09:00-17:00' },
            { name: 'é›ªæ¢¨æµ·æ¸¯å¤§æ©‹', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: 'å…¨å¤©' },
            { name: 'é‚¦è¿ªæµ·ç˜', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: 'å…¨å¤©' },
            { name: 'é”ä»¤æ¸¯', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: 'å…¨å¤©' },
            { name: 'å¡”éš†åŠ å‹•ç‰©åœ’', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: '09:30-17:00' },
            { name: 'å²©çŸ³å€', type: 'è³¼ç‰©', location: 'é›ªæ¢¨', time: '10:00-18:00' },
            { name: 'çš‡å®¶æ¤ç‰©åœ’', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: '07:00-18:00' },
            { name: 'æ›¼åˆ©æµ·ç˜', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: 'å…¨å¤©' },
            { name: 'è—å±±', type: 'æ™¯é»', location: 'è—å±±', time: 'å…¨å¤©' },
            { name: 'é›ªæ¢¨å¡”', type: 'æ™¯é»', location: 'é›ªæ¢¨', time: '09:00-22:00' }
        ],
        foods: ['æ¾³æ´²ç‰›æ’', 'è‚‰æ´¾', 'ç‚¸é­šè–¯æ¢', 'è¢‹é¼ è‚‰', 'æå§†å¡”å§†é¤…ä¹¾', 'ç¶­å‰éº¥', 'é±·é­šè‚‰', 'æ‹‰æ˜é “è›‹ç³•', 'æ¾³æ´²å’–å•¡', 'è‚‰å·'],
        defaultSchedule: []
    },
    'ğŸ‡¦ğŸ‡º å¢¨çˆ¾æœ¬': {
        country: 'æ¾³æ´²', continent: 'å¤§æ´‹æ´²', currency: 'AUD',
        spots: [
            { name: 'è¯é‚¦å»£å ´', type: 'æ™¯é»', location: 'å¢¨çˆ¾æœ¬', time: 'å…¨å¤©' },
            { name: 'çš‡å®¶æ‹±å»Š', type: 'è³¼ç‰©', location: 'å¢¨çˆ¾æœ¬', time: '09:00-18:00' },
            { name: 'å°¤é‡Œå¡88è§€æ™¯å°', type: 'æ™¯é»', location: 'å¢¨çˆ¾æœ¬', time: '10:00-22:00' },
            { name: 'å¤§æ´‹è·¯', type: 'æ™¯é»', location: 'ç¶­å¤šåˆ©äºå·', time: 'å…¨å¤©' },
            { name: 'å¢¨çˆ¾æœ¬å‹•ç‰©åœ’', type: 'æ™¯é»', location: 'å¢¨çˆ¾æœ¬', time: '09:00-17:00' },
            { name: 'å¼—æ—å¾·æ–¯è¡—è»Šç«™', type: 'æ™¯é»', location: 'å¢¨çˆ¾æœ¬', time: 'å…¨å¤©' },
            { name: 'çš‡å† è³­å ´', type: 'æ™¯é»', location: 'å¢¨çˆ¾æœ¬', time: 'å…¨å¤©' },
            { name: 'å¡—é´‰å··', type: 'æ™¯é»', location: 'å¢¨çˆ¾æœ¬', time: 'å…¨å¤©' },
            { name: 'ç¶­å¤šåˆ©äºå¥³ç‹å¸‚å ´', type: 'ç¾é£Ÿ', location: 'å¢¨çˆ¾æœ¬', time: '06:00-14:00' },
            { name: 'è²åˆ©æ™®å³¶ä¼éµ', type: 'æ™¯é»', location: 'è²åˆ©æ™®å³¶', time: '17:00-20:00' }
        ],
        foods: ['å’–å•¡', 'è‚‰æ´¾', 'è˜‡å¤«è•¾ç…é¤…', 'ç‰›æ’', 'äºæ´²èåˆæ–™ç†', 'å¸Œè‡˜èœ', 'ç¾©å¤§åˆ©é¤', 'ç²¾é‡€å•¤é…’', 'æµ·é®®', 'æ‹‰æ˜é “è›‹ç³•'],
        defaultSchedule: []
    },
    'ğŸ‡³ğŸ‡¿ å¥§å…‹è˜­': {
        country: 'ç´è¥¿è˜­', continent: 'å¤§æ´‹æ´²', currency: 'NZD',
        spots: [
            { name: 'å¤©ç©ºå¡”', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: '08:30-22:30' },
            { name: 'å¥§å…‹è˜­æ¸¯', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: 'å…¨å¤©' },
            { name: 'ä¼Šç”¸å±±', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: '07:00-20:30' },
            { name: 'çš‡åè¡—', type: 'è³¼ç‰©', location: 'å¥§å…‹è˜­', time: '09:00-18:00' },
            { name: 'ä½¿å‘½ç£', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: 'å…¨å¤©' },
            { name: 'å¥§å…‹è˜­åšç‰©é¤¨', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: '10:00-17:00' },
            { name: 'æ‡·å¸ŒåŸºå³¶', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: 'å…¨å¤©' },
            { name: 'å‡±åˆ©å¡”é “æ°´æ—é¤¨', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: '09:30-17:00' },
            { name: 'åŒ—å²¬', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: 'å…¨å¤©' },
            { name: 'æœ—ä¼Šæ‰˜æ‰˜å³¶', type: 'æ™¯é»', location: 'å¥§å…‹è˜­', time: 'å…¨å¤©' }
        ],
        foods: ['ç¾Šè‚‰', 'ç¶ å”‡è²½è²', 'è‚‰æ´¾', 'å¥‡ç•°æœ', 'ç™½é›²çŸ³å¥¶æ²¹', 'å¸•ç“¦æ´›ç“¦è›‹ç³•', 'ç‡‰ç¾Šè‚‰', 'æµ·é®®', 'ç´è¥¿è˜­è‘¡è„é…’', 'æ¼¢å‰æ–™ç†'],
        defaultSchedule: []
    },
    'ğŸ‡³ğŸ‡¿ çš‡åé®': {
        country: 'ç´è¥¿è˜­', continent: 'å¤§æ´‹æ´²', currency: 'NZD',
        spots: [
            { name: 'ç±³çˆ¾ç¦å¾·å³½ç£', type: 'æ™¯é»', location: 'çš‡åé®', time: 'å…¨å¤©' },
            { name: 'å¤©ç©ºçºœè»Š', type: 'æ™¯é»', location: 'çš‡åé®', time: '09:00-21:00' },
            { name: 'ç“¦å¡è’‚æ™®æ¹–', type: 'æ™¯é»', location: 'çš‡åé®', time: 'å…¨å¤©' },
            { name: 'æ ¼æ—è«¾å¥‡', type: 'æ™¯é»', location: 'çš‡åé®', time: 'å…¨å¤©' },
            { name: 'ç®­é®', type: 'æ™¯é»', location: 'çš‡åé®', time: 'å…¨å¤©' },
            { name: 'å³½ç£å™´å°„å¿«è‰‡', type: 'æ™¯é»', location: 'çš‡åé®', time: '09:00-17:00' },
            { name: 'é«˜ç©ºå½ˆè·³', type: 'æ™¯é»', location: 'çš‡åé®', time: '09:00-17:00' },
            { name: 'æ»‘ç¿”å‚˜', type: 'æ™¯é»', location: 'çš‡åé®', time: '09:00-17:00' },
            { name: 'å¼—æ ¼æ¼¢å ¡', type: 'ç¾é£Ÿ', location: 'çš‡åé®', time: '08:00-21:00' },
            { name: 'è’¸æ±½èˆ¹éŠæ¹–', type: 'æ™¯é»', location: 'çš‡åé®', time: '10:00-16:00' }
        ],
        foods: ['å¼—æ ¼æ¼¢å ¡', 'ç¾Šè‚‰', 'é¹¿è‚‰', 'é±’é­š', 'è‚‰æ´¾', 'ç´è¥¿è˜­è‘¡è„é…’', 'ç™½é›²çŸ³å†°æ·‡æ·‹', 'æµ·é®®æ‹¼ç›¤', 'ç‡’çƒ¤', 'å¸•ç“¦æ´›ç“¦'],
        defaultSchedule: []
    },

    // ============ éæ´² (Africa) ============
    'ğŸ‡¿ğŸ‡¦ é–‹æ™®æ•¦': {
        country: 'å—é', continent: 'éæ´²', currency: 'ZAR',
        spots: [
            { name: 'æ¡Œå±±', type: 'æ™¯é»', location: 'é–‹æ™®æ•¦', time: '08:00-18:00' },
            { name: 'å¥½æœ›è§’', type: 'æ™¯é»', location: 'é–‹æ™®æ•¦', time: '06:00-18:00' },
            { name: 'V&Aç¢¼é ­', type: 'è³¼ç‰©', location: 'é–‹æ™®æ•¦', time: '09:00-21:00' },
            { name: 'ä¼éµæµ·ç˜', type: 'æ™¯é»', location: 'è¥¿è’™é®', time: '08:00-17:00' },
            { name: 'ä¿¡è™Ÿå±±', type: 'æ™¯é»', location: 'é–‹æ™®æ•¦', time: 'å…¨å¤©' },
            { name: 'ç¾…æœ¬å³¶', type: 'æ™¯é»', location: 'é–‹æ™®æ•¦', time: '09:00-15:00' },
            { name: 'å…‹æ–¯å¦åšæ¤ç‰©åœ’', type: 'æ™¯é»', location: 'é–‹æ™®æ•¦', time: '08:00-18:00' },
            { name: 'æ³¢å¡æ™®å€', type: 'æ™¯é»', location: 'é–‹æ™®æ•¦', time: 'å…¨å¤©' },
            { name: 'æ–¯æ³°å€«åšæ–¯é…’èŠ', type: 'ç¾é£Ÿ', location: 'æ–¯æ³°å€«åšæ–¯', time: '09:00-17:00' },
            { name: 'æŸ¥æ™®æ›¼å³°', type: 'æ™¯é»', location: 'é–‹æ™®æ•¦', time: '06:00-19:00' }
        ],
        foods: ['æ³¢æ³¢æ', 'çƒ¤è‚‰', 'é–‹æ™®é¦¬ä¾†å’–å“©', 'ç‰›å°¾', 'å—éä¹¾è‚‰', 'é¦¬ä¾†å’–å“©è§’', 'å—éç‡‰è‚‰', 'é´•é³¥è‚‰', 'è‘¡è„é…’', 'å¥¶å¡”'],
        defaultSchedule: []
    },
    'ğŸ‡ªğŸ‡¬ é–‹ç¾…': {
        country: 'åŸƒåŠ', continent: 'éæ´²', currency: 'EGP',
        spots: [
            { name: 'å‰è–©é‡‘å­—å¡”', type: 'æ™¯é»', location: 'å‰è–©', time: '08:00-17:00' },
            { name: 'äººé¢ç…èº«åƒ', type: 'æ™¯é»', location: 'å‰è–©', time: '08:00-17:00' },
            { name: 'åŸƒåŠåšç‰©é¤¨', type: 'æ™¯é»', location: 'é–‹ç¾…', time: '09:00-17:00' },
            { name: 'å“ˆåˆ©åˆ©å¸‚é›†', type: 'è³¼ç‰©', location: 'é–‹ç¾…', time: '10:00-23:00' },
            { name: 'ç©†ç½•é»˜å¾·é˜¿é‡Œæ¸…çœŸå¯º', type: 'æ™¯é»', location: 'é–‹ç¾…', time: '08:00-17:00' },
            { name: 'é–‹ç¾…å¡”', type: 'æ™¯é»', location: 'é–‹ç¾…', time: '08:00-00:00' },
            { name: 'è–©å¡æ‹‰', type: 'æ™¯é»', location: 'è–©å¡æ‹‰', time: '08:00-17:00' },
            { name: 'å°¼ç¾…æ²³éŠè¼ª', type: 'æ™¯é»', location: 'é–‹ç¾…', time: '19:00-23:00' },
            { name: 'è€é–‹ç¾…', type: 'æ™¯é»', location: 'é–‹ç¾…', time: 'å…¨å¤©' },
            { name: 'é˜¿èŒ²å“ˆçˆ¾å…¬åœ’', type: 'æ™¯é»', location: 'é–‹ç¾…', time: '09:00-22:00' }
        ],
        foods: ['çƒ¤è‚‰ä¸²', 'é·¹å˜´è±†æ³¥', 'ç‚¸è±†é¤…', 'åŸƒåŠç‡‰èœ', 'çƒ¤é´¿', 'åŸƒåŠéºµåŒ…', 'æ²™å¨ç‘ª', 'ç”œé»', 'åŸƒåŠèŒ¶', 'ç”˜è”—æ±'],
        defaultSchedule: []
    },
    'ğŸ‡²ğŸ‡¦ é¦¬æ‹‰å–€ä»€': {
        country: 'æ‘©æ´›å“¥', continent: 'éæ´²', currency: 'MAD',
        spots: [
            { name: 'å‚‘é¦¬å¤«ç´å»£å ´', type: 'æ™¯é»', location: 'é¦¬æ‹‰å–€ä»€', time: 'å…¨å¤©' },
            { name: 'åº«åœ–æ¯”äºæ¸…çœŸå¯º', type: 'æ™¯é»', location: 'é¦¬æ‹‰å–€ä»€', time: 'å¤–è§€åƒè§€' },
            { name: 'å·´ä¼Šäºå®®æ®¿', type: 'æ™¯é»', location: 'é¦¬æ‹‰å–€ä»€', time: '09:00-17:00' },
            { name: 'é¦¬è‹¥é›·å‹’èŠ±åœ’', type: 'æ™¯é»', location: 'é¦¬æ‹‰å–€ä»€', time: '08:00-18:00' },
            { name: 'è€åŸå€', type: 'è³¼ç‰©', location: 'é¦¬æ‹‰å–€ä»€', time: 'å…¨å¤©' },
            { name: 'è–©è¿ªæ©é™µå¢“', type: 'æ™¯é»', location: 'é¦¬æ‹‰å–€ä»€', time: '09:00-17:00' },
            { name: 'çš®é©æŸ“åŠ', type: 'æ™¯é»', location: 'é¦¬æ‹‰å–€ä»€', time: '09:00-18:00' },
            { name: 'æœ¬å„ªç´ å¤«ç¥å­¸é™¢', type: 'æ™¯é»', location: 'é¦¬æ‹‰å–€ä»€', time: '09:00-18:00' },
            { name: 'æ’’å“ˆæ‹‰æ²™æ¼ ', type: 'æ™¯é»', location: 'æ’’å“ˆæ‹‰', time: 'å…¨å¤©' },
            { name: 'é˜¿ç‰¹æ‹‰æ–¯å±±è„ˆ', type: 'æ™¯é»', location: 'é˜¿ç‰¹æ‹‰æ–¯', time: 'å…¨å¤©' }
        ],
        foods: ['å¡”å‰é‹', 'åº«æ–¯åº«æ–¯', 'æ‘©æ´›å“¥è–„è·èŒ¶', 'æ²™å¨ç‘ª', 'æ‘©æ´›å“¥é¤…', 'å“ˆé‡Œæ‹‰æ¹¯', 'çƒ¤ç¾Šè‚‰', 'è¸ç‰›æ¹¯', 'æä»ç³•é»', 'æ©™å­æ²™æ‹‰'],
        defaultSchedule: []
    },
    'ğŸ‡°ğŸ‡ª å¥ˆæ´›æ¯”': {
        country: 'è‚¯äº', continent: 'éæ´²', currency: 'KES',
        spots: [
            { name: 'é¦¬è³½é¦¬æ‹‰åœ‹å®¶ä¿è­·å€', type: 'æ™¯é»', location: 'é¦¬è³½é¦¬æ‹‰', time: '06:00-18:00' },
            { name: 'å¤§è±¡å­¤å…’é™¢', type: 'æ™¯é»', location: 'å¥ˆæ´›æ¯”', time: '11:00-12:00' },
            { name: 'é•·é ¸é¹¿ä¸­å¿ƒ', type: 'æ™¯é»', location: 'å¥ˆæ´›æ¯”', time: '09:00-17:00' },
            { name: 'å¥ˆæ´›æ¯”åœ‹å®¶å…¬åœ’', type: 'æ™¯é»', location: 'å¥ˆæ´›æ¯”', time: '06:00-18:00' },
            { name: 'è‚¯äºåœ‹å®¶åšç‰©é¤¨', type: 'æ™¯é»', location: 'å¥ˆæ´›æ¯”', time: '08:30-17:30' },
            { name: 'å¡å€«æ•…å±…', type: 'æ™¯é»', location: 'å¥ˆæ´›æ¯”', time: '09:00-18:00' },
            { name: 'ç´åº«é­¯æ¹–', type: 'æ™¯é»', location: 'ç´åº«é­¯', time: '06:00-18:00' },
            { name: 'å®‰åšå¡åˆ©åœ‹å®¶å…¬åœ’', type: 'æ™¯é»', location: 'å®‰åšå¡åˆ©', time: '06:00-18:00' },
            { name: 'å¸‚å ´', type: 'è³¼ç‰©', location: 'å¥ˆæ´›æ¯”', time: '08:00-18:00' },
            { name: 'è‚¯äºå¡”åœ‹éš›æœƒè­°ä¸­å¿ƒ', type: 'æ™¯é»', location: 'å¥ˆæ´›æ¯”', time: '08:00-17:00' }
        ],
        foods: ['çƒä¼½é»', 'å°¼äºé¦¬å–¬ç‘ª', 'ç©†åè«', 'è–©æ‘©è–©', 'æ›¼é”èŒ²', 'çš®æ‹‰çƒ', 'çƒ¤è‚‰', 'é…ªæ¢¨æ²™æ‹‰', 'è‚¯äºèŒ¶', 'ç”˜è”—æ±'],
        defaultSchedule: []
    }
};
        // ============================================
        // å¸¸æ•¸èˆ‡è®Šæ•¸
        // ============================================
        const STORAGE_KEY = 'travel_planner_v4';
        const TOKEN_KEY = 'travel_google_token';
        const TOKEN_SOFT_EXPIRE = 24 * 60 * 60;
        const DISCOVERY_DOCS = [
            'https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest',
            'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'
        ];
        const SCOPES = 'https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/drive.file';
        
        // è²¨å¹£åŒ¯ç‡ï¼ˆåƒè€ƒå°ç£éŠ€è¡Œ 2024/2025 ç´„ç•¥åŒ¯ç‡ï¼‰
        const EXCHANGE_RATES = {
            TWD: { symbol: 'NT$', name: 'å°å¹£', rate: 1, flag: 'ğŸ‡¹ğŸ‡¼' },
            JPY: { symbol: 'Â¥', name: 'æ—¥å¹£', rate: 0.21, flag: 'ğŸ‡¯ğŸ‡µ' },      // 1 JPY â‰ˆ 0.21 TWD
            KRW: { symbol: 'â‚©', name: 'éŸ“å…ƒ', rate: 0.024, flag: 'ğŸ‡°ğŸ‡·' },    // 1 KRW â‰ˆ 0.024 TWD
            HKD: { symbol: 'HK$', name: 'æ¸¯å¹£', rate: 4.1, flag: 'ğŸ‡­ğŸ‡°' },    // 1 HKD â‰ˆ 4.1 TWD
            USD: { symbol: '$', name: 'ç¾é‡‘', rate: 32, flag: 'ğŸ‡ºğŸ‡¸' },       // 1 USD â‰ˆ 32 TWD
            EUR: { symbol: 'â‚¬', name: 'æ­å…ƒ', rate: 34, flag: 'ğŸ‡ªğŸ‡º' },       // 1 EUR â‰ˆ 34 TWD
            GBP: { symbol: 'Â£', name: 'è‹±éŠ', rate: 40, flag: 'ğŸ‡¬ğŸ‡§' },       // 1 GBP â‰ˆ 40 TWD
            THB: { symbol: 'à¸¿', name: 'æ³°éŠ–', rate: 0.94, flag: 'ğŸ‡¹ğŸ‡­' },     // 1 THB â‰ˆ 0.94 TWD
            SGD: { symbol: 'S$', name: 'æ–°å¹£', rate: 24, flag: 'ğŸ‡¸ğŸ‡¬' },      // 1 SGD â‰ˆ 24 TWD
            MYR: { symbol: 'RM', name: 'é¦¬å¹£', rate: 7.2, flag: 'ğŸ‡²ğŸ‡¾' },     // 1 MYR â‰ˆ 7.2 TWD
            VND: { symbol: 'â‚«', name: 'è¶Šç›¾', rate: 0.0013, flag: 'ğŸ‡»ğŸ‡³' },  // 1 VND â‰ˆ 0.0013 TWD
            PHP: { symbol: 'â‚±', name: 'æŠ«ç´¢', rate: 0.57, flag: 'ğŸ‡µğŸ‡­' },     // 1 PHP â‰ˆ 0.57 TWD
            IDR: { symbol: 'Rp', name: 'å°å°¼ç›¾', rate: 0.002, flag: 'ğŸ‡®ğŸ‡©' }, // 1 IDR â‰ˆ 0.002 TWD
            AUD: { symbol: 'A$', name: 'æ¾³å¹£', rate: 21, flag: 'ğŸ‡¦ğŸ‡º' },      // 1 AUD â‰ˆ 21 TWD
            NZD: { symbol: 'NZ$', name: 'ç´å¹£', rate: 19, flag: 'ğŸ‡³ğŸ‡¿' },     // 1 NZD â‰ˆ 19 TWD
            CNY: { symbol: 'Â¥', name: 'äººæ°‘å¹£', rate: 4.4, flag: 'ğŸ‡¨ğŸ‡³' },    // 1 CNY â‰ˆ 4.4 TWD
            CHF: { symbol: 'CHF', name: 'ç‘å£«æ³•éƒ', rate: 36, flag: 'ğŸ‡¨ğŸ‡­' }, // 1 CHF â‰ˆ 36 TWD
            CZK: { symbol: 'KÄ', name: 'æ·å…‹å…‹æœ—', rate: 1.4, flag: 'ğŸ‡¨ğŸ‡¿' }, // 1 CZK â‰ˆ 1.4 TWD
            MOP: { symbol: 'MOP$', name: 'æ¾³é–€å¹£', rate: 4, flag: 'ğŸ‡²ğŸ‡´' },   // 1 MOP â‰ˆ 4 TWD
            CAD: { symbol: 'C$', name: 'åŠ å¹£', rate: 23, flag: 'ğŸ‡¨ğŸ‡¦' },      // 1 CAD â‰ˆ 23 TWD
            MXN: { symbol: 'MX$', name: 'å¢¨è¥¿å“¥æŠ«ç´¢', rate: 1.9, flag: 'ğŸ‡²ğŸ‡½' },
            ZAR: { symbol: 'R', name: 'å—éè˜­ç‰¹', rate: 1.8, flag: 'ğŸ‡¿ğŸ‡¦' },
            EGP: { symbol: 'EÂ£', name: 'åŸƒåŠéŠ', rate: 0.65, flag: 'ğŸ‡ªğŸ‡¬' },
            MAD: { symbol: 'MAD', name: 'æ‘©æ´›å“¥è¿ªæ‹‰å§†', rate: 3.2, flag: 'ğŸ‡²ğŸ‡¦' },
            KES: { symbol: 'KSh', name: 'è‚¯äºå…ˆä»¤', rate: 0.25, flag: 'ğŸ‡°ğŸ‡ª' }
        };
        
        // æ”¯ä»˜æ–¹å¼
        const PAYMENT_METHODS = {
            cash: { name: 'ç¾é‡‘', icon: 'ğŸ’µ', color: 'emerald' },
            credit: { name: 'ä¿¡ç”¨å¡', icon: 'ğŸ’³', color: 'purple' },
            debit: { name: 'ç°½å¸³é‡‘èå¡', icon: 'ğŸ’³', color: 'cyan' },
            epay: { name: 'é›»å­æ”¯ä»˜', icon: 'ğŸ“±', color: 'orange' },
            iccard: { name: 'äº¤é€šå¡', icon: 'ğŸšƒ', color: 'pink' }
        };
        
        let tokenClient, gapiInited = false, gisInited = false;
        
        let appData = {
            trip: { name: '', destination: '', customDestination: '', startDate: '', endDate: '', mainCurrency: 'JPY' },
            days: [],
            expenses: [],
            shopping: [],
            budget: 0, // ğŸ’° ç¸½é ç®—ï¼ˆå°å¹£ï¼‰
            dayCovers: {}, // ğŸ“¸ æ¯æ—¥å°é¢ç…§ç‰‡ { 'YYYY-MM-DD': 'base64...' }
            dailyNotes: {}, // âœï¸ æ¯æ—¥æ—…éŠé»æ»´ { 'YYYY-MM-DD': [{id, time, content, mood}] }
            members: ['æˆ‘'], // ğŸ‘¥ æ—…ä¼´åå–®
            spots: [], // ğŸ“ æ™¯é»æ¸…å–® [{id, name, type, note, checked, checkedAt}]
            checkins: [], // ğŸ“¸ æ‰“å¡è¨˜éŒ„ [{id, photo, spotId, spotName, date, note}]
            badges: {}, // ğŸ† å·²è§£é–æˆå°± { badgeId: unlockedAt }
            settings: { googleClientId: '', lineToken: '', lineUserId: '', gasUrl: '', gasSecret: '', storageEnabled: true }
        };
        
        // ğŸ† æˆå°±å®šç¾©
        const CHECKIN_BADGES = [
            { id: 'first_spot', name: 'åˆæ¬¡æ‰“å¡', desc: 'æ‰“å¡ç¬¬ä¸€å€‹æ™¯é»', icon: 'ğŸ¯', condition: d => d.spots.filter(s => s.checked).length >= 1 },
            { id: 'explorer_5', name: 'å°å°æ¢éšªå®¶', desc: 'æ‰“å¡ 5 å€‹æ™¯é»', icon: 'ğŸ§­', total: 5, getValue: d => d.spots.filter(s => s.checked).length, condition: d => d.spots.filter(s => s.checked).length >= 5 },
            { id: 'explorer_10', name: 'è³‡æ·±æ¢éšªå®¶', desc: 'æ‰“å¡ 10 å€‹æ™¯é»', icon: 'ğŸ—ºï¸', total: 10, getValue: d => d.spots.filter(s => s.checked).length, condition: d => d.spots.filter(s => s.checked).length >= 10 },
            { id: 'first_photo', name: 'æ”å½±æ–°æ‰‹', desc: 'ä¸Šå‚³ç¬¬ä¸€å¼µç…§ç‰‡', icon: 'ğŸ“·', condition: d => d.checkins.length >= 1 },
            { id: 'photographer_10', name: 'æ”å½±é”äºº', desc: 'ä¸Šå‚³ 10 å¼µç…§ç‰‡', icon: 'ğŸï¸', total: 10, getValue: d => d.checkins.length, condition: d => d.checkins.length >= 10 },
            { id: 'foodie', name: 'ç¾é£Ÿçµäºº', desc: 'æ‰“å¡ 3 å€‹ç¾é£Ÿæ™¯é»', icon: 'ğŸœ', total: 3, getValue: d => d.spots.filter(s => s.checked && s.type === 'ç¾é£Ÿ').length, condition: d => d.spots.filter(s => s.checked && s.type === 'ç¾é£Ÿ').length >= 3 },
            { id: 'shopper', name: 'è³¼ç‰©ç‹‚', desc: 'æ‰“å¡ 3 å€‹è³¼ç‰©æ™¯é»', icon: 'ğŸ›ï¸', total: 3, getValue: d => d.spots.filter(s => s.checked && s.type === 'è³¼ç‰©').length, condition: d => d.spots.filter(s => s.checked && s.type === 'è³¼ç‰©').length >= 3 },
            { id: 'complete', name: 'å®Œç¾æ—…ç¨‹', desc: 'æ‰“å¡æ‰€æœ‰æ™¯é»', icon: 'ğŸ†', condition: d => d.spots.length > 0 && d.spots.every(s => s.checked) }
        ];
        
        // ============================================
        // åˆå§‹åŒ–
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderAll();
            initGoogleAPI();
            
            // ğŸ¬ å•Ÿå‹•ç•«é¢æ·¡å‡º
            setTimeout(() => {
                const splash = document.getElementById('splashScreen');
                if (splash) {
                    splash.classList.add('hide');
                    setTimeout(() => splash.remove(), 500);
                }
            }, 1800); // 1.8 ç§’å¾Œæ·¡å‡º
            
            // ç¶å®š Google Doc åŒ¯å‡ºæŒ‰éˆ•ï¼ˆè§£æ±º iPhone è§¸æ§å•é¡Œï¼‰
            const btnExportDoc = document.getElementById('btnExportGoogleDoc');
            if (btnExportDoc) {
                btnExportDoc.addEventListener('click', function(e) {
                    e.preventDefault();
                    exportToGoogleDoc();
                });
                btnExportDoc.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    exportToGoogleDoc();
                });
            }
        });
        
        // ============================================
        // è‡ªå‹•ç”¢ç”Ÿå»ºè­°è¡Œç¨‹
        // ============================================
        function showAutoGenerateModal() {
            const dest = appData.trip.destination;
            const content = document.getElementById('autoGenerateContent');
            
            if (!dest || !appData.trip.startDate || !appData.trip.endDate) {
                content.innerHTML = `
                    <div style="text-align:center;padding:20px;color:var(--text-dim);">
                        <div style="font-size:2em;margin-bottom:10px;">âš ï¸</div>
                        <p>è«‹å…ˆåœ¨é¦–é è¨­å®š<strong>ç›®çš„åœ°</strong>å’Œ<strong>æ—¥æœŸ</strong></p>
                    </div>
                `;
                showModal('autoGenerateModal');
                return;
            }
            
            const dbData = ATTRACTIONS_DB[dest];
            if (!dbData) {
                content.innerHTML = `
                    <div style="text-align:center;padding:20px;color:var(--text-dim);">
                        <div style="font-size:2em;margin-bottom:10px;">ğŸ“</div>
                        <p>ç›®å‰ã€Œ${dest}ã€å°šç„¡å»ºè­°æ™¯é»è³‡æ–™åº«</p>
                        <p style="margin-top:10px;font-size:0.9em;">æ‚¨å¯ä»¥æ‰‹å‹•æ–°å¢è¡Œç¨‹</p>
                    </div>
                `;
                showModal('autoGenerateModal');
                return;
            }
            
            const dayCount = appData.days.length || calculateDays();
            
            content.innerHTML = `
                <div style="text-align:center;margin-bottom:20px;">
                    <div style="font-size:2em;margin-bottom:10px;">âœ¨</div>
                    <p style="color:var(--cyan);font-weight:600;">${dest}</p>
                    <p style="color:var(--text-dim);">${dayCount} å¤©è¡Œç¨‹å»ºè­°</p>
                </div>
                
                <div class="suggest-section">
                    <div class="suggest-title">ğŸ›ï¸ å¯é¸æ™¯é»ï¼ˆ${dbData.spots.length}å€‹ï¼‰</div>
                    <div class="suggest-chips" id="spotsChipsContainer">
                        ${dbData.spots.map((s, i) => `<span class="suggest-chip selected" data-index="${i}">${s.name}</span>`).join('')}
                    </div>
                </div>
                
                <div class="suggest-section">
                    <div class="suggest-title">ğŸœ æ¨è–¦ç¾é£Ÿ</div>
                    <div class="suggest-chips">
                        ${dbData.foods.map(f => `<span class="suggest-chip">${f}</span>`).join('')}
                    </div>
                </div>
                
                <div class="suggest-section" style="margin-top:15px;">
                    <div class="suggest-title">ğŸ”” æ‰¹æ¬¡è¨­å®šæé†’ï¼ˆæ‰€æœ‰è¡Œç¨‹ï¼‰</div>
                    <div class="reminder-grid" id="batchReminderGrid">
                        <label class="reminder-option" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">âœ“</div><span>å‰ 1 å¤©</span>
                            <input type="checkbox" value="1440" checked>
                        </label>
                        <label class="reminder-option checked" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">âœ“</div><span>å‰ 2 å°æ™‚</span>
                            <input type="checkbox" value="120">
                        </label>
                        <label class="reminder-option" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">âœ“</div><span>å‰ 1 å°æ™‚</span>
                            <input type="checkbox" value="60">
                        </label>
                        <label class="reminder-option" onclick="toggleReminder(this)">
                            <div class="reminder-checkbox">âœ“</div><span>å‰ 30 åˆ†é˜</span>
                            <input type="checkbox" value="30">
                        </label>
                    </div>
                </div>
                
                <div class="suggest-section" style="margin-top:10px;">
                    <label class="reminder-option" onclick="toggleReminder(this)" style="width:100%;">
                        <div class="reminder-checkbox">âœ“</div>
                        <span>ğŸ“† åŒæ­¥åˆ° Google æ—¥æ›†</span>
                        <input type="checkbox" id="batchSyncGoogle" value="google">
                    </label>
                </div>
                
                <p style="font-size:0.85em;color:var(--text-muted);text-align:center;margin-top:10px;">
                    é»æ“Šæ™¯é»å¯å–æ¶ˆé¸æ“‡ï¼Œç³»çµ±æœƒè‡ªå‹•åˆ†é…åˆ°å„å¤©
                </p>
            `;
            
            // ç¶å®šé»æ“Šäº‹ä»¶
            content.querySelectorAll('.suggest-chip').forEach(chip => {
                chip.addEventListener('click', () => chip.classList.toggle('selected'));
            });
            
            showModal('autoGenerateModal');
        }
        
        function calculateDays() {
            if (!appData.trip.startDate || !appData.trip.endDate) return 0;
            const start = new Date(appData.trip.startDate);
            const end = new Date(appData.trip.endDate);
            return Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
        }
        
        async function confirmAutoGenerate() {
            const dest = appData.trip.destination;
            const dbData = ATTRACTIONS_DB[dest];
            
            if (!dbData) {
                closeModal('autoGenerateModal');
                return;
            }
            
            // å–å¾—é¸ä¸­çš„æ™¯é»ï¼ˆå¾æ™¯é»å€å¡Šé¸å–ï¼‰
            const spotsContainer = document.getElementById('spotsChipsContainer');
            const selectedChips = spotsContainer ? spotsContainer.querySelectorAll('.suggest-chip.selected') : [];
            const selectedSpots = [];
            selectedChips.forEach(chip => {
                const idx = parseInt(chip.dataset.index);
                if (!isNaN(idx) && dbData.spots[idx]) {
                    selectedSpots.push(dbData.spots[idx]);
                }
            });
            
            if (selectedSpots.length === 0) {
                showToast('è«‹è‡³å°‘é¸æ“‡ä¸€å€‹æ™¯é»', 'error');
                return;
            }
            
            // å–å¾—æ‰¹æ¬¡æé†’è¨­å®š
            const batchReminders = [];
            document.querySelectorAll('#batchReminderGrid .reminder-option.checked input').forEach(input => {
                batchReminders.push(parseInt(input.value));
            });
            const batchSyncGoogle = document.getElementById('batchSyncGoogle')?.checked || false;
            
            // ç¢ºä¿å·²ç”¢ç”Ÿå¤©æ•¸
            if (appData.days.length === 0) {
                const start = new Date(appData.trip.startDate);
                const end = new Date(appData.trip.endDate);
                generateDays(start, end);
            }
            
            // åˆ†é…æ™¯é»åˆ°å„å¤©
            const spotsPerDay = Math.ceil(selectedSpots.length / appData.days.length);
            let spotIndex = 0;
            let totalSchedules = 0;
            
            showToast('ğŸ”„ ç”¢ç”Ÿè¡Œç¨‹ä¸­...', 'info');
            
            for (let dayIdx = 0; dayIdx < appData.days.length; dayIdx++) {
                const day = appData.days[dayIdx];
                
                // ç¬¬ä¸€å¤©åŠ å…¥æŠµé”è¡Œç¨‹
                if (dayIdx === 0 && dbData.defaultSchedule.length > 0) {
                    dbData.defaultSchedule.forEach(ds => {
                        const times = ds.time.split('-');
                        const schedule = {
                            id: Date.now() + Math.random(),
                            startTime: times[0],
                            endTime: times[1],
                            title: ds.title,
                            type: ds.type,
                            location: '',
                            note: '',
                            reminders: [...batchReminders],
                            synced: false
                        };
                        day.schedules.push(schedule);
                        
                        // å»ºç«‹ LINE æé†’
                        if (batchReminders.length > 0) {
                            createLineReminders(day, schedule);
                        }
                        totalSchedules++;
                    });
                }
                
                // åˆ†é…æ™¯é»
                for (let i = 0; i < spotsPerDay && spotIndex < selectedSpots.length; i++) {
                    const spot = selectedSpots[spotIndex++];
                    const times = spot.time.split('-');
                    
                    const schedule = {
                        id: Date.now() + Math.random() + spotIndex,
                        startTime: times[0],
                        endTime: times[1],
                        title: spot.name,
                        type: spot.type,
                        location: spot.location,
                        note: '',
                        reminders: [...batchReminders],
                        synced: false
                    };
                    
                    day.schedules.push(schedule);
                    
                    // å»ºç«‹ LINE æé†’
                    if (batchReminders.length > 0) {
                        createLineReminders(day, schedule);
                    }
                    
                    // åŒæ­¥åˆ° Google æ—¥æ›†
                    if (batchSyncGoogle) {
                        const success = await addEventToGoogleCalendar(schedule, day);
                        if (success) schedule.synced = true;
                    }
                    
                    totalSchedules++;
                }
                
                // æ’åºè¡Œç¨‹
                day.schedules.sort((a, b) => a.startTime.localeCompare(b.startTime));
            }
            
            saveData();
            renderItinerary();
            closeModal('autoGenerateModal');
            
            let msg = `âœ… å·²ç”¢ç”Ÿ ${totalSchedules} å€‹è¡Œç¨‹ï¼`;
            if (batchReminders.length > 0) msg += `\nğŸ”” å·²è¨­å®š LINE æé†’`;
            if (batchSyncGoogle) msg += `\nğŸ“† å·²åŒæ­¥ Google æ—¥æ›†`;
            showToast(msg, 'success');
            
            switchPage('itinerary');
        }
        
        // ============================================
        // å–å¾—å»ºè­°æ™¯é»ï¼ˆç”¨æ–¼æ‰‹å‹•æ–°å¢ï¼‰
        // ============================================
        function getSuggestions() {
            const dest = appData.trip.destination;
            const dbData = ATTRACTIONS_DB[dest];
            
            if (!dbData) return [];
            return dbData.spots;
        }
        
        function updateSuggestChips() {
            const container = document.getElementById('suggestChips');
            const suggestions = getSuggestions();
            
            if (suggestions.length === 0) {
                document.getElementById('suggestSection').style.display = 'none';
                return;
            }
            
            document.getElementById('suggestSection').style.display = 'block';
            container.innerHTML = suggestions.slice(0, 8).map(s => 
                `<span class="suggest-chip" onclick="selectSuggestion('${s.name}', '${s.type}', '${s.location}', '${s.time}')">${s.name}</span>`
            ).join('');
        }
        
        function selectSuggestion(name, type, location, time) {
            document.getElementById('scheduleTitle').value = name;
            document.getElementById('scheduleType').value = type;
            document.getElementById('scheduleLocation').value = location;
            
            const times = time.split('-');
            if (times.length === 2) {
                document.getElementById('scheduleStartTime').value = times[0];
                document.getElementById('scheduleEndTime').value = times[1];
            }
            
            // æ¨™è¨˜é¸ä¸­
            document.querySelectorAll('#suggestChips .suggest-chip').forEach(c => c.classList.remove('selected'));
            event.target.classList.add('selected');
        }
        
        // ============================================
        // é é¢åˆ‡æ›
        // ============================================
        function switchPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => {
                if (n.querySelector('.nav-label').textContent === {home:'é¦–é ',itinerary:'è¡Œç¨‹',expense:'è¨˜å¸³',shopping:'è³¼ç‰©',checkin:'æ‰“å¡',settings:'è¨­å®š'}[pageId]) {
                    n.classList.add('active');
                }
            });
            // åˆ‡æ›åˆ°æ‰“å¡é é¢æ™‚é‡æ–°æ¸²æŸ“
            if (pageId === 'checkin') renderCheckinPage();
        }
        
        // ============================================
        // æ—…éŠè³‡è¨Š
        // ============================================
        function handleDestinationChange() {
            const dest = document.getElementById('destination').value;
            document.getElementById('customDestGroup').style.display = dest === 'custom' ? 'block' : 'none';
            updateTripInfo();
        }
        
        function updateTripInfo() {
            const name = document.getElementById('tripName').value;
            const dest = document.getElementById('destination').value;
            const customDest = document.getElementById('customDestination').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            appData.trip.name = name;
            appData.trip.destination = dest === 'custom' ? customDest : dest;
            appData.trip.customDestination = customDest;
            appData.trip.startDate = startDate;
            appData.trip.endDate = endDate;
            
            document.getElementById('displayTripName').textContent = name || 'æˆ‘çš„æ—…è¡Œ';
            document.getElementById('displayDestination').textContent = appData.trip.destination || 'ğŸŒ é»æ“Šä¸‹æ–¹è¨­å®šç›®çš„åœ°';
            
            if (startDate && endDate) {
                const start = new Date(startDate);
                const end = new Date(endDate);
                const days = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
                document.getElementById('displayDates').textContent = `ğŸ“… ${formatDate(start)} ~ ${formatDate(end)} (${days}å¤©)`;
                document.getElementById('statDays').textContent = days;
                
                if (appData.days.length === 0) generateDays(start, end);
            }
            
            saveData();
        }
        
        function generateDays(start, end) {
            appData.days = [];
            let current = new Date(start);
            let dayNum = 1;
            while (current <= end) {
                appData.days.push({ id: Date.now() + dayNum, date: current.toISOString().split('T')[0], title: `Day ${dayNum}`, schedules: [] });
                current.setDate(current.getDate() + 1);
                dayNum++;
            }
            renderItinerary();
            saveData();
        }
        
        // ğŸ“… æ‰‹å‹•å»ºç«‹/æ›´æ–°è¡Œç¨‹è¡¨ï¼ˆä¿ç•™èˆŠè³‡æ–™ï¼‰
        function manualGenerateDays() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (!startDate || !endDate) {
                showToast('è«‹å…ˆè¨­å®šå‡ºç™¼å’ŒçµæŸæ—¥æœŸ', 'error');
                return;
            }
            
            const start = new Date(startDate);
            const end = new Date(endDate);
            
            if (start > end) {
                showToast('çµæŸæ—¥æœŸå¿…é ˆæ™šæ–¼å‡ºç™¼æ—¥æœŸ', 'error');
                return;
            }
            
            // å„²å­˜èˆŠçš„ schedulesï¼ˆæŒ‰æ—¥æœŸç´¢å¼•ï¼‰
            const oldSchedules = {};
            appData.days.forEach(day => {
                if (day.schedules.length > 0) {
                    oldSchedules[day.date] = day.schedules;
                }
            });
            
            // å»ºç«‹æ–°çš„æ—¥æœŸé™£åˆ—
            const newDays = [];
            let current = new Date(start);
            let dayNum = 1;
            
            while (current <= end) {
                const dateStr = current.toISOString().split('T')[0];
                
                // å¦‚æœèˆŠè³‡æ–™æœ‰é€™å€‹æ—¥æœŸçš„è¡Œç¨‹ï¼Œä¿ç•™å®ƒ
                const existingSchedules = oldSchedules[dateStr] || [];
                
                newDays.push({
                    id: Date.now() + dayNum,
                    date: dateStr,
                    title: `Day ${dayNum}`,
                    schedules: existingSchedules
                });
                
                current.setDate(current.getDate() + 1);
                dayNum++;
            }
            
            appData.days = newDays;
            
            // çµ±è¨ˆçµæœ
            const keptCount = Object.keys(oldSchedules).filter(d => {
                return newDays.some(nd => nd.date === d);
            }).length;
            
            renderItinerary();
            saveData();
            
            const totalDays = newDays.length;
            let msg = `âœ… å·²å»ºç«‹ ${totalDays} å¤©è¡Œç¨‹è¡¨`;
            if (keptCount > 0) {
                msg += `ï¼ˆä¿ç•™ ${keptCount} å¤©èˆŠè¡Œç¨‹ï¼‰`;
            }
            showToast(msg, 'success');
        }
        
        // ğŸ—‘ï¸ æ¸…é™¤æ­¤æ¬¡æ—…è¡Œï¼ˆé–‹å§‹æ–°æ—…éŠï¼‰- å«åŒ¯å‡ºé¸é …
        async function clearCurrentTrip() {
            // è¨ˆç®—ç¾æœ‰è³‡æ–™
            const scheduleCount = appData.days.reduce((sum, d) => sum + d.schedules.length, 0);
            const expenseCount = appData.expenses.length;
            const shoppingCount = appData.shopping.length;
            const notesCount = Object.keys(appData.dailyNotes || {}).length;
            const coversCount = Object.keys(appData.dayCovers || {}).length;
            const hasData = scheduleCount > 0 || expenseCount > 0 || notesCount > 0;
            
            // å¦‚æœæœ‰è³‡æ–™ï¼Œå…ˆè©¢å•æ˜¯å¦è¦åŒ¯å‡º
            if (hasData && (appData.trip.name || appData.trip.destination)) {
                const exportChoice = confirm(
                    `ğŸ“ æ˜¯å¦å…ˆå°‡æ­¤æ¬¡æ—…éŠè¨˜éŒ„åŒ¯å‡ºåˆ° Google Docï¼Ÿ\n\n` +
                    `å°‡åŒ¯å‡ºçš„å…§å®¹ï¼š\n` +
                    `${scheduleCount > 0 ? `â€¢ ${scheduleCount} å€‹è¡Œç¨‹å®‰æ’\n` : ''}` +
                    `${expenseCount > 0 ? `â€¢ ${expenseCount} ç­†èŠ±è²»ç´€éŒ„\n` : ''}` +
                    `${notesCount > 0 ? `â€¢ ${notesCount} å¤©çš„æ—…éŠé»æ»´\n` : ''}` +
                    `\nğŸ’¡ æ‰“å¡ç…§ç‰‡å’Œæˆå°±æœƒè‡ªå‹•ä¿ç•™\n` +
                    `\né»ã€Œç¢ºå®šã€â†’ å…ˆåŒ¯å‡ºå†æ¸…é™¤\né»ã€Œå–æ¶ˆã€â†’ ç›´æ¥æ¸…é™¤ï¼ˆä¸åŒ¯å‡ºï¼‰`
                );
                
                if (exportChoice) {
                    // å…ˆåŒ¯å‡ºåˆ° Google Doc
                    const token = getStoredToken();
                    if (!token) {
                        showToast('è«‹å…ˆæˆæ¬Š Google å¸³è™Ÿæ‰èƒ½åŒ¯å‡º', 'error');
                        return;
                    }
                    
                    showToast('ğŸ“ æ­£åœ¨åŒ¯å‡ºåˆ° Google Doc...', 'info');
                    
                    try {
                        const result = await exportTripToGoogleDoc();
                        const trip = appData.trip;
                        const docTitle = `${trip.name || trip.destination + 'ä¹‹æ—…'} - æ—…éŠç´€éŒ„`;
                        const docUrl = `https://docs.google.com/document/d/${result.id}/edit`;
                        
                        // é¡¯ç¤ºé€£çµ Modalï¼Œä¸¦æä¾›ç¹¼çºŒæ¸…é™¤çš„é¸é …
                        showDocLinkModal(docTitle, docUrl, true);
                        return; // ç­‰å¾…ç”¨æˆ¶åœ¨ Modal ä¸­é¸æ“‡
                        
                    } catch (err) {
                        console.error('åŒ¯å‡ºå¤±æ•—:', err);
                        if (!confirm('åŒ¯å‡ºå¤±æ•—ï¼Œæ˜¯å¦ä»è¦æ¸…é™¤è³‡æ–™ï¼Ÿ')) {
                            return;
                        }
                    }
                }
            }
            
            // æœ€å¾Œç¢ºèªæ¸…é™¤
            let msg = 'ç¢ºå®šè¦æ¸…é™¤æ­¤æ¬¡æ—…è¡Œå—ï¼Ÿ\n\n';
            msg += 'âš ï¸ ä»¥ä¸‹è³‡æ–™å°‡è¢«æ¸…é™¤ï¼š\n';
            msg += `â€¢ æ—…éŠè¨­å®šï¼ˆåç¨±ã€ç›®çš„åœ°ã€æ—¥æœŸï¼‰\n`;
            if (scheduleCount > 0) msg += `â€¢ ${scheduleCount} å€‹è¡Œç¨‹å®‰æ’\n`;
            if (expenseCount > 0) msg += `â€¢ ${expenseCount} ç­†èŠ±è²»ç´€éŒ„\n`;
            if (shoppingCount > 0) msg += `â€¢ ${shoppingCount} å€‹è³¼ç‰©æ¸…å–®\n`;
            if (coversCount > 0) msg += `â€¢ ${coversCount} å¼µæ¯æ—¥å°é¢\n`;
            msg += '\nğŸ’¾ æœƒä¿ç•™çš„è³‡æ–™ï¼š\n';
            msg += 'â€¢ API è¨­å®šï¼ˆé‡‘é‘°ï¼‰\n';
            msg += 'â€¢ âœï¸ æ—…éŠé»æ»´æ—¥è¨˜\n';
            msg += 'â€¢ ğŸ“¸ æ‰“å¡ç…§ç‰‡å’Œæ™¯é»\n';
            msg += 'â€¢ ğŸ† æˆå°±å¾½ç« ';
            
            if (!confirm(msg)) return;
            
            // åŸ·è¡Œæ¸…é™¤
            doResetTrip();
        }
        
        // å¯¦éš›åŸ·è¡Œæ¸…é™¤
        function doResetTrip() {
            appData.trip = { name: '', destination: '', customDestination: '', startDate: '', endDate: '', mainCurrency: 'JPY', budget: 100000 };
            appData.days = [];
            appData.expenses = [];
            appData.shopping = [];
            // appData.dailyNotes = {}; // âœï¸ ä¿ç•™æ—…éŠé»æ»´ï¼
            appData.dayCovers = {};
            appData.members = ['æˆ‘'];
            // ğŸ“¸ ä¿ç•™æ‰“å¡è³‡æ–™ä½œç‚ºæ—…éŠå›æ†¶ï¼
            // appData.spots, appData.checkins, appData.badges ä¸æ¸…é™¤
            
            // é‡ç½®è¡¨å–®
            document.getElementById('tripName').value = '';
            document.getElementById('destination').value = '';
            document.getElementById('customDestination').value = '';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            document.getElementById('customDestGroup').style.display = 'none';
            
            // æ›´æ–°é¡¯ç¤º
            document.getElementById('displayTripName').textContent = 'æˆ‘çš„æ—…è¡Œ';
            document.getElementById('displayDestination').textContent = 'ğŸŒ é»æ“Šä¸‹æ–¹è¨­å®šç›®çš„åœ°';
            document.getElementById('displayDates').textContent = 'ğŸ“… è¨­å®šæ—…éŠæ—¥æœŸ';
            document.getElementById('statDays').textContent = '0';
            
            renderAll();
            saveData();
            
            showToast('âœ… å·²æ¸…é™¤ï¼Œå¯ä»¥é–‹å§‹æ–°çš„æ—…éŠè¦åŠƒï¼', 'success');
        }
        
        // ğŸ“ åŒ¯å‡ºæ—…éŠè¨˜éŒ„åˆ° Google Docï¼ˆä¸é¡¯ç¤ºç¢ºèªæ¡†ï¼Œç”¨æ–¼è‡ªå‹•åŒ¯å‡ºï¼‰
        async function exportTripToGoogleDoc() {
            const token = getStoredToken();
            if (!token) throw new Error('æœªæˆæ¬Š');
            
            const trip = appData.trip;
            const docTitle = `${trip.name || trip.destination + 'ä¹‹æ—…'} - æ—…éŠç´€éŒ„ (${new Date().toLocaleDateString('zh-TW')})`;
            
            // çµ„åˆ HTML å…§å®¹
            let htmlContent = `
                <html>
                <head><meta charset="utf-8"></head>
                <body style="font-family: Arial, sans-serif; line-height: 1.8;">
                
                <h1 style="color: #06b6d4; border-bottom: 3px solid #06b6d4; padding-bottom: 10px;">
                    âœˆï¸ ${trip.name || trip.destination + 'ä¹‹æ—…'}
                </h1>
                
                <table style="margin: 20px 0; font-size: 14px;">
                    <tr><td>ğŸ“ <strong>ç›®çš„åœ°</strong></td><td style="padding-left: 20px;">${trip.destination}</td></tr>
                    <tr><td>ğŸ“… <strong>æ—¥æœŸ</strong></td><td style="padding-left: 20px;">${formatDate(new Date(trip.startDate))} ~ ${formatDate(new Date(trip.endDate))}</td></tr>
                    <tr><td>ğŸ’° <strong>ä¸»è¦è²¨å¹£</strong></td><td style="padding-left: 20px;">${trip.mainCurrency}</td></tr>
                </table>
                
                <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 30px 0;">
            `;
            
            // æ¯æ—¥è¡Œç¨‹èˆ‡é»æ»´
            appData.days.forEach(day => {
                htmlContent += `
                    <h2 style="color: #a855f7; margin-top: 30px;">
                        ğŸ“… ${day.title} - ${formatDate(new Date(day.date))}
                    </h2>
                `;
                
                // è¡Œç¨‹
                if (day.schedules.length > 0) {
                    htmlContent += `<h3 style="color: #10b981;">ğŸ“‹ è¡Œç¨‹å®‰æ’</h3><ul>`;
                    day.schedules.forEach(s => {
                        htmlContent += `
                            <li style="margin-bottom: 10px;">
                                <strong>${s.startTime} - ${s.endTime}</strong> ${getTypeEmoji(s.type)} ${escapeHtml(s.title)}
                                ${s.location ? `<br><span style="color: #666;">ğŸ“ ${escapeHtml(s.location)}</span>` : ''}
                                ${s.note ? `<br><span style="color: #888;">ğŸ’¬ ${escapeHtml(s.note)}</span>` : ''}
                            </li>
                        `;
                    });
                    htmlContent += `</ul>`;
                }
                
                // æ—…éŠé»æ»´
                const notes = appData.dailyNotes?.[day.date] || [];
                if (notes.length > 0) {
                    htmlContent += `<h3 style="color: #ec4899;">âœï¸ æ—…éŠé»æ»´</h3>`;
                    notes.forEach(note => {
                        htmlContent += `
                            <div style="background: #f8f9fa; border-left: 4px solid #a855f7; padding: 15px; margin: 10px 0; border-radius: 0 8px 8px 0;">
                                <div style="font-size: 1.2em; margin-bottom: 5px;">
                                    ${note.mood} <span style="color: #666; font-size: 0.85em;">ğŸ• ${note.time}</span>
                                </div>
                                <div style="white-space: pre-wrap;">${escapeHtml(note.content)}</div>
                            </div>
                        `;
                    });
                }
                
                if (appData.dayCovers?.[day.date]) {
                    htmlContent += `<p style="color: #06b6d4;">ğŸ“¸ <em>æœ¬æ—¥æœ‰å°é¢ç…§ç‰‡ï¼ˆå„²å­˜æ–¼ APP ä¸­ï¼‰</em></p>`;
                }
                
                htmlContent += `<hr style="border: none; border-top: 1px solid #e2e8f0; margin: 20px 0;">`;
            });
            
            // ğŸ’° èŠ±è²»ç´€éŒ„ï¼ˆå«åˆ†å¸³è³‡è¨Šï¼‰
            if (appData.expenses.length > 0) {
                // è¨ˆç®—ç¸½èŠ±è²»
                let totalTWD = 0;
                appData.expenses.forEach(e => {
                    const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                    totalTWD += e.amount * rate;
                });
                
                htmlContent += `
                    <h2 style="color: #f59e0b; margin-top: 30px;">ğŸ’° èŠ±è²»ç´€éŒ„</h2>
                    <p style="font-size: 1.2em; color: #f59e0b;"><strong>ç¸½èŠ±è²»ï¼šNT$ ${Math.round(totalTWD).toLocaleString()}</strong></p>
                    <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                        <tr style="background: #1e293b; color: white;">
                            <th style="padding: 10px; text-align: left;">æ—¥æœŸ</th>
                            <th style="padding: 10px; text-align: left;">é¡åˆ¥</th>
                            <th style="padding: 10px; text-align: left;">é …ç›®</th>
                            <th style="padding: 10px; text-align: right;">é‡‘é¡</th>
                            <th style="padding: 10px; text-align: left;">å¢Šä»˜äºº</th>
                            <th style="padding: 10px; text-align: left;">åˆ†æ”¤</th>
                        </tr>
                `;
                appData.expenses.forEach((e, i) => {
                    const bg = i % 2 === 0 ? '#f8f9fa' : '#ffffff';
                    const splitInfo = e.splitWith ? e.splitWith.join(', ') : 'å…¨å“¡';
                    htmlContent += `
                        <tr style="background: ${bg};">
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${e.date}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${e.category}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${escapeHtml(e.item)}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right;">${e.currency} ${e.amount.toLocaleString()}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${e.paidBy || 'æˆ‘'}</td>
                            <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">${splitInfo}</td>
                        </tr>
                    `;
                });
                htmlContent += `</table>`;
                
                // ğŸ‘¥ åˆ†å¸³çµç®—
                if (appData.members && appData.members.length > 1) {
                    const splitData = calculateSplit();
                    htmlContent += `
                        <h3 style="color: #10b981; margin-top: 20px;">ğŸ‘¥ åˆ†å¸³çµç®—</h3>
                        <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                            <tr style="background: #10b981; color: white;">
                                <th style="padding: 10px; text-align: left;">æˆå“¡</th>
                                <th style="padding: 10px; text-align: right;">å·²å¢Šä»˜</th>
                                <th style="padding: 10px; text-align: right;">æ‡‰åˆ†æ”¤</th>
                                <th style="padding: 10px; text-align: right;">çµç®—</th>
                            </tr>
                    `;
                    Object.keys(splitData).forEach((m, i) => {
                        const data = splitData[m];
                        const balance = Math.round(data.balance);
                        const balanceText = balance >= 0 ? `+NT$${balance.toLocaleString()}` : `-NT$${Math.abs(balance).toLocaleString()}`;
                        const balanceColor = balance >= 0 ? '#10b981' : '#f59e0b';
                        const bg = i % 2 === 0 ? '#f8f9fa' : '#ffffff';
                        htmlContent += `
                            <tr style="background: ${bg};">
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0;">ğŸ‘¤ ${m}</td>
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right; color: #06b6d4;">NT$${Math.round(data.paid).toLocaleString()}</td>
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right; color: #f59e0b;">NT$${Math.round(data.shouldPay).toLocaleString()}</td>
                                <td style="padding: 8px; border-bottom: 1px solid #e2e8f0; text-align: right; color: ${balanceColor}; font-weight: bold;">${balanceText}</td>
                            </tr>
                        `;
                    });
                    htmlContent += `</table>`;
                }
            }
            
            // è³¼ç‰©æ¸…å–®
            if (appData.shopping.length > 0) {
                htmlContent += `<h2 style="color: #ec4899; margin-top: 30px;">ğŸ›ï¸ è³¼ç‰©æ¸…å–®</h2><ul>`;
                appData.shopping.forEach(s => {
                    const checked = s.bought ? 'âœ…' : 'â¬œ';
                    const style = s.bought ? 'text-decoration: line-through; color: #888;' : '';
                    htmlContent += `
                        <li style="${style}">
                            ${checked} ${escapeHtml(s.item)}
                            ${s.price > 0 ? ` - ${s.currency || trip.mainCurrency} ${s.price.toLocaleString()}` : ''}
                        </li>
                    `;
                });
                htmlContent += `</ul>`;
            }
            
            // çµå°¾
            htmlContent += `
                <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 30px 0;">
                <p style="text-align: center; color: #888; font-size: 0.9em;">
                    âœˆï¸ æ—…éŠç´€éŒ„ç”±ã€Œæ—…éŠç§˜æ›¸ã€è‡ªå‹•ç”¢ç”Ÿ<br>
                    ğŸ“… åŒ¯å‡ºæ™‚é–“ï¼š${new Date().toLocaleString('zh-TW')}
                </p>
                </body></html>
            `;
            
            // ä½¿ç”¨ Google Drive API å‰µå»º Google Doc
            const metadata = {
                name: docTitle,
                mimeType: 'application/vnd.google-apps.document'
            };
            
            const boundary = '-------314159265358979323846';
            const delimiter = "\r\n--" + boundary + "\r\n";
            const closeDelim = "\r\n--" + boundary + "--";
            
            const multipartRequestBody =
                delimiter +
                'Content-Type: application/json\r\n\r\n' +
                JSON.stringify(metadata) +
                delimiter +
                'Content-Type: text/html\r\n\r\n' +
                htmlContent +
                closeDelim;
            
            const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + token.access_token,
                    'Content-Type': 'multipart/related; boundary="' + boundary + '"'
                },
                body: multipartRequestBody
            });
            
            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'å»ºç«‹å¤±æ•—');
            }
            
            return await response.json();
        }
        
        // ============================================
        // è¡Œç¨‹ç®¡ç†
        // ============================================
        function renderItinerary() {
            const container = document.getElementById('itineraryList');
            if (appData.days.length === 0) {
                const hasDate = appData.trip.startDate && appData.trip.endDate;
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“…</div>
                        <div>å°šæœªè¨­å®šè¡Œç¨‹</div>
                        ${hasDate 
                            ? `<button class="btn btn-primary btn-sm" style="margin-top:15px;" onclick="manualGenerateDays()">ğŸ“… å»ºç«‹è¡Œç¨‹è¡¨</button>`
                            : `<div style="margin-top:10px;font-size:0.9em;color:var(--text-dim);">è«‹å…ˆåœ¨é¦–é è¨­å®šæ—…éŠæ—¥æœŸ</div>`
                        }
                    </div>
                `;
                return;
            }
            container.innerHTML = appData.days.map(day => {
                const coverPhoto = appData.dayCovers?.[day.date];
                const scheduleHtml = day.schedules.length > 0 
                    ? day.schedules.map(s => `
                        <div class="schedule-item ${s.reminders?.length > 0 ? 'has-reminder' : ''} ${s.synced ? 'synced' : ''}">
                            <div class="schedule-time">${s.startTime} - ${s.endTime}</div>
                            <div class="schedule-title">${getTypeEmoji(s.type)} ${s.title}</div>
                            ${s.location ? `<div class="schedule-location">ğŸ“ ${s.location} <a class="map-btn" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.location)}" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation();">ğŸ—ºï¸</a></div>` : ''}
                            <div class="schedule-actions">
                                ${s.reminders?.length > 0 ? '<span class="schedule-badge reminder">ğŸ”” å·²è¨­æé†’</span>' : ''}
                                ${s.synced ? '<span class="schedule-badge synced">ğŸ“† å·²åŒæ­¥</span>' : ''}
                            </div>
                            <div class="schedule-actions" style="margin-top:6px;">
                                <button class="btn btn-outline btn-xs" onclick="deleteSchedule(${day.id}, ${s.id})">ğŸ—‘ï¸</button>
                                ${!s.synced ? `<button class="btn btn-secondary btn-xs" onclick="syncSingleToGoogle(${day.id}, ${s.id})">ğŸ“†</button>` : ''}
                            </div>
                        </div>
                    `).join('')
                    : '<div style="color:var(--text-muted);font-size:0.9em;padding:10px 0;">å°šç„¡è¡Œç¨‹å®‰æ’</div>';
                
                // ğŸ“¸ å°é¢ç…§ç‰‡å€åŸŸ
                const coverHtml = coverPhoto 
                    ? `<div class="day-cover">
                        <img src="${coverPhoto}" alt="æœ¬æ—¥å°é¢">
                        <button class="cover-edit-btn" onclick="event.stopPropagation();showPhotoModal('${day.date}')">ğŸ“· æ›´æ›å°é¢</button>
                       </div>`
                    : `<div class="day-cover" onclick="showPhotoModal('${day.date}')">
                        <div class="day-cover-placeholder">
                            <div class="icon">ğŸ“·</div>
                            <div>é»æ“Šè¨­å®šæœ¬æ—¥å°é¢</div>
                        </div>
                       </div>`;
                
                return `
                    <div class="day-card ${coverPhoto ? 'day-card-with-cover' : ''}">
                        ${coverHtml}
                        <div class="day-header" onclick="toggleDayContent(${day.id})">
                            <div><div class="day-title">${day.title}</div><div class="day-date">${formatDate(new Date(day.date))} â€¢ ${day.schedules.length} å€‹è¡Œç¨‹</div></div>
                            <span id="dayArrow${day.id}">â–¼</span>
                        </div>
                        <div class="day-content" id="dayContent${day.id}">
                            ${scheduleHtml}
                            <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;">
                                <button class="btn btn-outline btn-sm" onclick="showAddScheduleModal(${day.id})" style="flex:1;">â• æ–°å¢è¡Œç¨‹</button>
                                <button class="notes-btn" onclick="showDailyNotesModal('${day.date}', '${day.title}')">
                                    âœï¸ æ—…éŠé»æ»´ ${(appData.dailyNotes?.[day.date]?.length || 0) > 0 ? `<span class="count">${appData.dailyNotes[day.date].length}</span>` : ''}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleDayContent(dayId) {
            const content = document.getElementById('dayContent' + dayId);
            const arrow = document.getElementById('dayArrow' + dayId);
            content.classList.toggle('show');
            arrow.textContent = content.classList.contains('show') ? 'â–²' : 'â–¼';
        }
        
        function showAddScheduleModal(dayId) {
            const select = document.getElementById('scheduleDay');
            select.innerHTML = appData.days.map(d => `<option value="${d.id}" ${d.id === dayId ? 'selected' : ''}>${d.title} (${formatDate(new Date(d.date))})</option>`).join('');
            
            document.getElementById('scheduleStartTime').value = '09:00';
            document.getElementById('scheduleEndTime').value = '10:00';
            document.getElementById('scheduleTitle').value = '';
            document.getElementById('scheduleType').value = 'æ™¯é»';
            document.getElementById('scheduleLocation').value = '';
            document.getElementById('scheduleNote').value = '';
            document.querySelectorAll('#scheduleModal .reminder-option').forEach(r => r.classList.remove('checked'));
            
            updateSuggestChips();
            showModal('scheduleModal');
        }
        
        // ğŸ†• å…¨åŸŸæ–°å¢è¡Œç¨‹ï¼ˆå¾è¡Œç¨‹é é¢é ‚éƒ¨æŒ‰éˆ•ï¼‰
        function showAddScheduleModalGlobal() {
            if (appData.days.length === 0) {
                showToast('è«‹å…ˆè¨­å®šæ—…éŠæ—¥æœŸä¸¦å»ºç«‹è¡Œç¨‹è¡¨', 'error');
                return;
            }
            // é è¨­é¸æ“‡ç¬¬ä¸€å¤©
            showAddScheduleModal(appData.days[0].id);
        }
        
        function showAddDayModal() {
            document.getElementById('newDayDate').value = '';
            document.getElementById('newDayTitle').value = '';
            showModal('dayModal');
        }
        
        function saveNewDay() {
            const date = document.getElementById('newDayDate').value;
            const title = document.getElementById('newDayTitle').value;
            if (!date) { showToast('è«‹é¸æ“‡æ—¥æœŸ', 'error'); return; }
            const dayNum = appData.days.length + 1;
            appData.days.push({ id: Date.now(), date, title: title || `Day ${dayNum}`, schedules: [] });
            appData.days.sort((a, b) => new Date(a.date) - new Date(b.date));
            saveData();
            renderItinerary();
            closeModal('dayModal');
            showToast('å·²æ–°å¢è¡Œç¨‹æ—¥', 'success');
        }
        
        async function saveSchedule() {
            const dayId = parseInt(document.getElementById('scheduleDay').value);
            const startTime = document.getElementById('scheduleStartTime').value;
            const endTime = document.getElementById('scheduleEndTime').value;
            const title = document.getElementById('scheduleTitle').value;
            const type = document.getElementById('scheduleType').value;
            const location = document.getElementById('scheduleLocation').value;
            const note = document.getElementById('scheduleNote').value;
            const syncToGoogle = document.getElementById('syncToGoogle').checked;
            
            if (!title) { showToast('è«‹è¼¸å…¥æ´»å‹•åç¨±', 'error'); return; }
            
            const reminders = [];
            document.querySelectorAll('#scheduleModal .reminder-option.checked input[value]:not([id="syncToGoogle"])').forEach(input => {
                if (input.value !== 'google') reminders.push(parseInt(input.value));
            });
            
            const day = appData.days.find(d => d.id === dayId);
            if (day) {
                const schedule = { id: Date.now(), startTime, endTime, title, type, location, note, reminders, synced: false };
                day.schedules.push(schedule);
                day.schedules.sort((a, b) => a.startTime.localeCompare(b.startTime));
                
                if (syncToGoogle) {
                    const success = await addEventToGoogleCalendar(schedule, day);
                    if (success) schedule.synced = true;
                }
                
                if (reminders.length > 0) createLineReminders(day, schedule);
                
                saveData();
                renderItinerary();
                closeModal('scheduleModal');
                showToast('å·²æ–°å¢è¡Œç¨‹', 'success');
            }
        }
        
        function deleteSchedule(dayId, scheduleId) {
            if (!confirm('ç¢ºå®šè¦åˆªé™¤ï¼Ÿ')) return;
            const day = appData.days.find(d => d.id === dayId);
            if (day) {
                day.schedules = day.schedules.filter(s => s.id !== scheduleId);
                saveData();
                renderItinerary();
                showToast('å·²åˆªé™¤', 'success');
            }
        }
        
        // ============================================
        // Google Calendar
        // ============================================
        function initGoogleAPI() {
            if (typeof gapi !== 'undefined') {
                gapi.load('client', async function() {
                    try {
                        await gapi.client.init({ discoveryDocs: DISCOVERY_DOCS });
                        gapiInited = true;
                        loadSavedToken();
                    } catch (err) { console.error('GAPI init failed:', err); }
                });
            }
        }
        
        function saveGoogleToken(token) {
            try {
                localStorage.setItem(TOKEN_KEY, JSON.stringify({ token, savedAt: Date.now(), expiresIn: TOKEN_SOFT_EXPIRE, actualExpiresIn: token.expires_in || 3600 }));
            } catch (e) {}
        }
        
        function loadSavedToken() {
            try {
                const saved = localStorage.getItem(TOKEN_KEY);
                if (!saved) return false;
                const tokenData = JSON.parse(saved);
                const elapsed = (Date.now() - tokenData.savedAt) / 1000;
                if (elapsed < tokenData.expiresIn - 300) {
                    gapi.client.setToken(tokenData.token);
                    gisInited = true;
                    const remaining = Math.floor((tokenData.expiresIn - elapsed) / 3600);
                    const mins = Math.floor(((tokenData.expiresIn - elapsed) % 3600) / 60);
                    const statusEl = document.getElementById('googleAuthStatus');
                    statusEl.innerHTML = `âœ… å·²æˆæ¬Šï¼ˆå‰©é¤˜ç´„ ${remaining > 0 ? remaining + ' å°æ™‚ ' : ''}${mins} åˆ†é˜ï¼‰`;
                    statusEl.className = 'auth-status success';
                    statusEl.style.display = 'block';
                    return true;
                } else {
                    localStorage.removeItem(TOKEN_KEY);
                    return false;
                }
            } catch (e) { return false; }
        }
        
        function isTokenValid() {
            const token = gapi.client.getToken();
            if (!token) return false;
            try {
                const saved = localStorage.getItem(TOKEN_KEY);
                if (!saved) return !!token;
                const tokenData = JSON.parse(saved);
                return (Date.now() - tokenData.savedAt) / 1000 < tokenData.expiresIn - 60;
            } catch (e) { return !!token; }
        }
        
        // å–å¾—å·²å„²å­˜çš„ Tokenï¼ˆç”¨æ–¼ API å‘¼å«ï¼‰
        function getStoredToken() {
            try {
                // å…ˆå˜—è©¦å¾ gapi å–å¾—
                const gapiToken = gapi.client.getToken();
                if (gapiToken) return gapiToken;
                
                // å¾ localStorage å–å¾—
                const saved = localStorage.getItem(TOKEN_KEY);
                if (!saved) return null;
                const tokenData = JSON.parse(saved);
                const elapsed = (Date.now() - tokenData.savedAt) / 1000;
                if (elapsed < tokenData.expiresIn - 60) {
                    return tokenData.token;
                }
                return null;
            } catch (e) { return null; }
        }
        
        function initTokenClient() {
            const clientId = document.getElementById('googleClientId').value.trim();
            if (!clientId) { showToast('è«‹å…ˆè¼¸å…¥ Google Client ID', 'error'); return false; }
            if (typeof google === 'undefined' || !google.accounts) { showToast('Google API å°šæœªè¼‰å…¥', 'error'); return false; }
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: clientId,
                scope: SCOPES,
                callback: function(response) {
                    if (response.error) { showToast('æˆæ¬Šå¤±æ•—: ' + response.error, 'error'); return; }
                    gisInited = true;
                    saveGoogleToken(response);
                    const statusEl = document.getElementById('googleAuthStatus');
                    statusEl.innerHTML = 'âœ… å·²æˆæ¬Šï¼ˆ24 å°æ™‚æœ‰æ•ˆï¼‰';
                    statusEl.className = 'auth-status success';
                    statusEl.style.display = 'block';
                    showToast('âœ… Google æ—¥æ›†æˆæ¬ŠæˆåŠŸï¼', 'success');
                }
            });
            return true;
        }
        
        function handleGoogleAuthorize() {
            if (isTokenValid()) { showToast('æˆæ¬Šä»ç„¶æœ‰æ•ˆ', 'success'); return; }
            if (!initTokenClient()) return;
            tokenClient.requestAccessToken({ prompt: '' });
        }
        
        // ğŸ”„ é‡æ–°æˆæ¬Š Googleï¼ˆæ¸…é™¤èˆŠ Tokenï¼Œå« Drive æ¬Šé™ï¼‰
        function reauthorizeGoogle() {
            if (!confirm('ç¢ºå®šè¦é‡æ–°æˆæ¬Šå—ï¼Ÿ\n\né€™æœƒæ¸…é™¤ç¾æœ‰çš„ Google æˆæ¬Šï¼Œéœ€è¦é‡æ–°ç™»å…¥ä¸¦å…è¨±æ¬Šé™ã€‚\n\nâš ï¸ æ—…éŠè³‡æ–™ä¸æœƒæ¶ˆå¤±ï¼')) {
                return;
            }
            
            // æ¸…é™¤èˆŠ Token
            localStorage.removeItem(TOKEN_KEY);
            
            // é‡æ–°åˆå§‹åŒ–ä¸¦è«‹æ±‚æˆæ¬Šï¼ˆå¼·åˆ¶é¡¯ç¤ºåŒæ„ç•«é¢ï¼‰
            if (!initTokenClient()) return;
            
            showToast('ğŸ”„ æ­£åœ¨é‡æ–°æˆæ¬Š...', 'info');
            
            // ä½¿ç”¨ prompt: 'consent' å¼·åˆ¶é¡¯ç¤ºåŒæ„ç•«é¢ï¼Œé€™æ¨£æ‰æœƒåŒ…å«æ–°çš„ scope
            tokenClient.requestAccessToken({ prompt: 'consent' });
        }
        
        async function addEventToGoogleCalendar(schedule, day) {
            if (!isTokenValid()) return false;
            const calendarEvent = {
                summary: schedule.title,
                location: schedule.location || '',
                description: schedule.note || '',
                start: { dateTime: day.date + 'T' + schedule.startTime + ':00', timeZone: 'Asia/Taipei' },
                end: { dateTime: day.date + 'T' + schedule.endTime + ':00', timeZone: 'Asia/Taipei' },
                reminders: { useDefault: false, overrides: [{ method: 'popup', minutes: 60 }] }
            };
            try {
                await gapi.client.calendar.events.insert({ calendarId: 'primary', resource: calendarEvent });
                return true;
            } catch (err) { return false; }
        }
        
        async function syncSingleToGoogle(dayId, scheduleId) {
            const day = appData.days.find(d => d.id === dayId);
            const schedule = day?.schedules.find(s => s.id === scheduleId);
            if (!day || !schedule) return;
            showToast('ğŸ”„ åŒæ­¥ä¸­...', 'info');
            if (await addEventToGoogleCalendar(schedule, day)) {
                schedule.synced = true;
                saveData();
                renderItinerary();
                showToast('âœ… åŒæ­¥æˆåŠŸ', 'success');
            } else {
                showToast('âŒ åŒæ­¥å¤±æ•—', 'error');
            }
        }
        
        async function syncAllToGoogleCalendar() {
            if (!isTokenValid()) { showToast('è«‹å…ˆæˆæ¬Š Google æ—¥æ›†', 'error'); return; }
            showToast('ğŸ”„ åŒæ­¥ä¸­...', 'info');
            let count = 0;
            for (const day of appData.days) {
                for (const schedule of day.schedules) {
                    if (!schedule.synced && await addEventToGoogleCalendar(schedule, day)) {
                        schedule.synced = true;
                        count++;
                    }
                }
            }
            saveData();
            renderItinerary();
            showToast(count > 0 ? `âœ… å·²åŒæ­¥ ${count} å€‹è¡Œç¨‹` : 'æ‰€æœ‰è¡Œç¨‹å·²åŒæ­¥', 'success');
        }
        
        // ============================================
        // LINE æé†’
        // ============================================
        function createLineReminders(day, schedule) {
            const { lineToken, lineUserId, gasUrl, gasSecret } = appData.settings;
            if (!lineToken || !lineUserId || !gasUrl || !gasSecret) return;
            const schedules = [];
            const startDateTime = new Date(day.date + 'T' + schedule.startTime + ':00');
            const endDateTime = new Date(day.date + 'T' + schedule.endTime + ':00');
            const labels = { 1440: 'å‰ 1 å¤©', 120: 'å‰ 2 å°æ™‚', 60: 'å‰ 1 å°æ™‚', 30: 'å‰ 30 åˆ†é˜' };
            schedule.reminders.forEach(mins => {
                const reminderTime = new Date(startDateTime.getTime() - mins * 60 * 1000);
                if (reminderTime > new Date()) {
                    schedules.push({ workshopTitle: schedule.title, workshopStart: startDateTime.toISOString(), workshopEnd: endDateTime.toISOString(), workshopLocation: schedule.location || '', reminderTime: reminderTime.toISOString(), reminderMinutes: mins, reminderLabel: labels[mins] || '' });
                }
            });
            if (schedules.length === 0) return;
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'createSchedules', secret: gasSecret, token: lineToken, userId: lineUserId, schedules }) }).then(r => r.json()).then(result => { if (result.success) showToast('ğŸ”” å·²å»ºç«‹æé†’', 'success'); });
        }
        
        function testLineNotification() {
            const { lineToken, lineUserId, gasUrl, gasSecret } = appData.settings;
            if (!lineToken || !lineUserId || !gasUrl || !gasSecret) { showToast('è«‹å¡«å¯«å®Œæ•´è¨­å®š', 'error'); return; }
            showToast('ğŸ“¨ ç™¼é€ä¸­...', 'info');
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ secret: gasSecret, token: lineToken, userId: lineUserId, message: 'ğŸ§ª æ¸¬è©¦é€šçŸ¥\n\nâœˆï¸ æ—…éŠç§˜æ›¸å·²æˆåŠŸé€£æ¥ï¼' }) })
                .then(r => r.json())
                .then(result => showToast(result.success ? 'âœ… ç™¼é€æˆåŠŸ' : 'âŒ ' + result.error, result.success ? 'success' : 'error'))
                .catch(err => showToast('âŒ ' + err.message, 'error'));
        }
        
        function viewSchedules() {
            const { gasUrl, gasSecret } = appData.settings;
            if (!gasUrl || !gasSecret) { showToast('è«‹å…ˆè¨­å®š GAS', 'error'); return; }
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'getSchedules', secret: gasSecret }) })
                .then(r => r.json())
                .then(result => showToast(result.success ? `ğŸ“‹ ${result.schedules?.length || 0} å€‹æ’ç¨‹` : 'âŒ æŸ¥è©¢å¤±æ•—', result.success ? 'success' : 'error'));
        }
        
        function clearAllSchedules() {
            const { gasUrl, gasSecret } = appData.settings;
            if (!gasUrl || !gasSecret) { showToast('è«‹å…ˆè¨­å®š GAS', 'error'); return; }
            
            if (!confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰ LINE æé†’æ’ç¨‹ï¼Ÿ\n\nâš ï¸ é€™æœƒåˆªé™¤è³‡æ–™åº«ä¸­æ‰€æœ‰å¾…ç™¼é€çš„æé†’')) return;
            
            showToast('ğŸ—‘ï¸ æ¸…é™¤ä¸­...', 'info');
            
            fetch(gasUrl, { method: 'POST', headers: { 'Content-Type': 'text/plain' }, body: JSON.stringify({ action: 'clearSchedules', secret: gasSecret }) })
                .then(r => r.json())
                .then(result => {
                    if (result.success) {
                        showToast('âœ… å·²æ¸…é™¤æ‰€æœ‰æ’ç¨‹', 'success');
                    } else {
                        showToast('âŒ ' + (result.error || 'æ¸…é™¤å¤±æ•—'), 'error');
                    }
                })
                .catch(err => showToast('âŒ ' + err.message, 'error'));
        }
        
        // ============================================
        // æ‰¹æ¬¡è¨­å®šæé†’
        // ============================================
        function showBatchReminderModal() {
            // çµ±è¨ˆè¡Œç¨‹æ•¸é‡
            let totalSchedules = 0;
            let withReminders = 0;
            let withoutReminders = 0;
            
            appData.days.forEach(day => {
                day.schedules.forEach(s => {
                    totalSchedules++;
                    if (s.reminders && s.reminders.length > 0) {
                        withReminders++;
                    } else {
                        withoutReminders++;
                    }
                });
            });
            
            const statsHtml = `
                <div style="display:flex;justify-content:space-around;text-align:center;">
                    <div>
                        <div style="font-size:1.5em;font-weight:bold;color:var(--cyan);">${totalSchedules}</div>
                        <div style="font-size:0.8em;color:var(--text-muted);">ç¸½è¡Œç¨‹æ•¸</div>
                    </div>
                    <div>
                        <div style="font-size:1.5em;font-weight:bold;color:var(--orange);">${withReminders}</div>
                        <div style="font-size:0.8em;color:var(--text-muted);">å·²æœ‰æé†’</div>
                    </div>
                    <div>
                        <div style="font-size:1.5em;font-weight:bold;color:var(--text-dim);">${withoutReminders}</div>
                        <div style="font-size:0.8em;color:var(--text-muted);">ç„¡æé†’</div>
                    </div>
                </div>
            `;
            document.getElementById('batchReminderStats').innerHTML = statsHtml;
            
            // é‡ç½®é¸é …
            document.querySelectorAll('#batchReminderOptions .reminder-option').forEach(opt => {
                const input = opt.querySelector('input');
                if (input.value === '1440' || input.value === '60') {
                    opt.classList.add('checked');
                    input.checked = true;
                } else {
                    opt.classList.remove('checked');
                    input.checked = false;
                }
            });
            
            showModal('batchReminderModal');
        }
        
        async function applyBatchReminders() {
            const { lineToken, lineUserId, gasUrl, gasSecret } = appData.settings;
            
            if (!lineToken || !lineUserId || !gasUrl || !gasSecret) {
                showToast('è«‹å…ˆåœ¨è¨­å®šé é¢å¡«å¯« LINE å’Œ GAS è³‡è¨Š', 'error');
                return;
            }
            
            // å–å¾—é¸ä¸­çš„æé†’æ™‚é–“
            const selectedReminders = [];
            document.querySelectorAll('#batchReminderOptions .reminder-option.checked input').forEach(input => {
                selectedReminders.push(parseInt(input.value));
            });
            
            if (selectedReminders.length === 0) {
                showToast('è«‹è‡³å°‘é¸æ“‡ä¸€å€‹æé†’æ™‚é–“', 'error');
                return;
            }
            
            const overwrite = document.getElementById('overwriteReminders')?.checked || false;
            const clearOld = document.getElementById('clearOldSchedules')?.checked || false;
            
            showToast('ğŸ”„ è¨­å®šä¸­...', 'info');
            
            // å¦‚æœé¸æ“‡æ¸…é™¤èˆŠæ’ç¨‹
            if (clearOld) {
                try {
                    const clearResult = await fetch(gasUrl, { 
                        method: 'POST', 
                        headers: { 'Content-Type': 'text/plain' }, 
                        body: JSON.stringify({ action: 'clearSchedules', secret: gasSecret }) 
                    }).then(r => r.json());
                    
                    if (clearResult.success) {
                        console.log('å·²æ¸…é™¤èˆŠæ’ç¨‹');
                    }
                } catch (err) {
                    console.error('æ¸…é™¤æ’ç¨‹å¤±æ•—:', err);
                }
            }
            
            let updatedCount = 0;
            let reminderCount = 0;
            
            appData.days.forEach(day => {
                day.schedules.forEach(schedule => {
                    // æª¢æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°
                    const hasReminders = schedule.reminders && schedule.reminders.length > 0;
                    if (hasReminders && !overwrite) return;
                    
                    // æ›´æ–°æé†’è¨­å®š
                    schedule.reminders = [...selectedReminders];
                    updatedCount++;
                    
                    // å»ºç«‹ LINE æé†’
                    createLineReminders(day, schedule);
                    reminderCount += selectedReminders.length;
                });
            });
            
            saveData();
            renderItinerary();
            closeModal('batchReminderModal');
            
            showToast(`âœ… å·²ç‚º ${updatedCount} å€‹è¡Œç¨‹è¨­å®šæé†’ï¼`, 'success');
        }
        
        // ============================================
        // è¨˜å¸³ & è³¼ç‰©
        // ============================================
        function updateExpenseFilterOptions() {
            const select = document.getElementById('expenseFilterDate');
            select.innerHTML = '<option value="all">å…¨éƒ¨æ—¥æœŸ</option>' + appData.days.map(d => `<option value="${d.date}">${d.title}</option>`).join('');
        }
        
        function renderExpenses() {
            const filter = document.getElementById('expenseFilterDate').value;
            let filtered = filter === 'all' ? appData.expenses : appData.expenses.filter(e => e.date === filter);
            
            // è¨ˆç®—ç¸½èŠ±è²»ï¼ˆè½‰æ›ç‚ºå°å¹£ï¼‰
            let totalTWD = 0;
            let totalForeign = 0;
            const mainCurrency = appData.trip.mainCurrency || 'JPY';
            
            // æŒ‰æ”¯ä»˜æ–¹å¼çµ±è¨ˆ
            const paymentStats = {};
            
            appData.expenses.forEach(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                const twdAmount = e.amount * rate;
                totalTWD += twdAmount;
                if (e.currency === mainCurrency) {
                    totalForeign += e.amount;
                }
                // æ”¯ä»˜æ–¹å¼çµ±è¨ˆ
                if (!paymentStats[e.payment]) paymentStats[e.payment] = 0;
                paymentStats[e.payment] += twdAmount;
            });
            
            const currencyInfo = EXCHANGE_RATES[mainCurrency] || { symbol: '$', flag: 'ğŸ’°', name: 'å¤–å¹£' };
            document.getElementById('expenseJPY').textContent = currencyInfo.symbol + totalForeign.toLocaleString();
            document.getElementById('expenseForeignLabel').textContent = currencyInfo.name;
            document.getElementById('expenseTWD').textContent = 'NT$' + Math.round(totalTWD).toLocaleString();
            document.getElementById('expenseCount').textContent = appData.expenses.length;
            document.getElementById('statExpenseJPY').textContent = currencyInfo.symbol + totalForeign.toLocaleString();
            document.getElementById('statExpenseTWD').textContent = 'NT$' + Math.round(totalTWD).toLocaleString();
            
            // é¡¯ç¤ºæ”¯ä»˜æ–¹å¼çµ±è¨ˆ
            const paymentSummary = document.getElementById('paymentSummary');
            const paymentBreakdown = document.getElementById('paymentBreakdown');
            if (Object.keys(paymentStats).length > 0) {
                paymentSummary.style.display = 'block';
                paymentBreakdown.innerHTML = Object.entries(paymentStats)
                    .sort((a, b) => b[1] - a[1])
                    .map(([method, amount]) => `
                        <div style="background:var(--bg-dark);padding:6px 10px;border-radius:8px;font-size:0.8em;">
                            ${getPaymentIcon(method)} ${method}: <span style="color:var(--emerald);">NT$${Math.round(amount).toLocaleString()}</span>
                        </div>
                    `).join('');
            } else {
                paymentSummary.style.display = 'none';
            }
            
            const container = document.getElementById('expenseList');
            if (filtered.length === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ’°</div><div>å°šç„¡èŠ±è²»ç´€éŒ„</div></div>';
                return;
            }
            container.innerHTML = filtered.slice().reverse().map(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                const twdAmount = Math.round(e.amount * rate);
                const paidByInfo = e.paidBy && e.paidBy !== 'æˆ‘' ? `<span style="color:var(--cyan);margin-left:6px;">ğŸ’³${e.paidBy}å¢Š</span>` : '';
                const splitInfo = e.splitWith && e.splitWith.length > 0 && e.splitWith.length < (appData.members?.length || 1) 
                    ? `<span style="color:var(--text-dim);font-size:0.75em;"> â€¢ ${e.splitWith.length}äººåˆ†</span>` : '';
                return `
                <div class="expense-item">
                    <div class="expense-info">
                        <div class="expense-category">${getCategoryEmoji(e.category)} ${e.category}${paidByInfo}</div>
                        <div class="expense-name">${e.item}${splitInfo}</div>
                        <div class="expense-meta">${getPaymentIcon(e.payment)} ${e.payment}</div>
                    </div>
                    <div style="text-align:right;">
                        <div class="expense-amount">${getCurrencySymbol(e.currency)}${e.amount.toLocaleString()}</div>
                        <div style="font-size:0.7em;color:var(--text-muted);">â‰ˆ NT$${twdAmount.toLocaleString()}</div>
                    </div>
                    <div class="expense-delete" onclick="deleteExpense(${e.id})">ğŸ—‘ï¸</div>
                </div>
            `}).join('');
            
            // æ›´æ–°é ç®—åœ“ç’°
            updateBudgetRing();
            
            // æ›´æ–°åˆ†å¸³çµç®—
            renderSplitSummary();
        }
        
        function getPaymentIcon(payment) {
            if (payment.includes('ç¾é‡‘')) return 'ğŸ’µ';
            if (payment.includes('ä¿¡ç”¨å¡') || payment.includes('ç°½å¸³')) return 'ğŸ’³';
            if (payment.includes('Pay') || payment.includes('æ”¯ä»˜') || payment.includes('å¾®ä¿¡')) return 'ğŸ“±';
            if (payment.includes('Suica') || payment.includes('æ‚ éŠ') || payment.includes('T-money') || payment.includes('å…«é”é€š')) return 'ğŸšƒ';
            return 'ğŸ“Œ';
        }
        
        // ============================================
        // ğŸ’° é ç®—å®ˆè­·ç’°åŠŸèƒ½
        // ============================================
        function updateBudgetRing() {
            const budget = appData.budget || 0;
            let totalSpent = 0;
            
            appData.expenses.forEach(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                totalSpent += e.amount * rate;
            });
            
            totalSpent = Math.round(totalSpent);
            const remain = budget - totalSpent;
            const percent = budget > 0 ? Math.min((totalSpent / budget) * 100, 100) : 0;
            
            // æ›´æ–°åœ“ç’°
            const ring = document.getElementById('budgetRingProgress');
            const circumference = 2 * Math.PI * 42; // r=42
            const offset = circumference - (percent / 100) * circumference;
            ring.style.strokeDashoffset = offset;
            
            // æ ¹æ“šç™¾åˆ†æ¯”è®Šè‰²
            ring.classList.remove('warning', 'danger');
            if (percent >= 90) ring.classList.add('danger');
            else if (percent >= 70) ring.classList.add('warning');
            
            // æ›´æ–°æ–‡å­—
            document.getElementById('budgetPercent').textContent = Math.round(percent) + '%';
            document.getElementById('budgetTotal').textContent = 'NT$' + budget.toLocaleString();
            document.getElementById('budgetSpent').textContent = 'NT$' + totalSpent.toLocaleString();
            
            const remainEl = document.getElementById('budgetRemain');
            if (remain >= 0) {
                remainEl.textContent = 'NT$' + remain.toLocaleString();
                remainEl.className = 'budget-value remain';
            } else {
                remainEl.textContent = '-NT$' + Math.abs(remain).toLocaleString();
                remainEl.className = 'budget-value over';
            }
        }
        
        function showBudgetModal() {
            document.getElementById('budgetAmount').value = appData.budget || '';
            showModal('budgetModal');
        }
        
        function saveBudget() {
            const amount = parseInt(document.getElementById('budgetAmount').value) || 0;
            appData.budget = amount;
            saveData();
            updateBudgetRing();
            closeModal('budgetModal');
            showToast('é ç®—è¨­å®šå®Œæˆï¼', 'success');
        }
        
        // ============================================
        // ğŸ—ºï¸ ä¸€éµå°èˆªåŠŸèƒ½
        // ============================================
        function openMap(location) {
            if (!location) return;
            const url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location)}`;
            // ä½¿ç”¨ <a> æ¨™ç±¤æ–¹å¼é–‹å•Ÿï¼Œåœ¨ PWA æ¨¡å¼ä¸‹æ›´å¯é 
            const a = document.createElement('a');
            a.href = url;
            a.target = '_blank';
            a.rel = 'noopener noreferrer';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
        
        // ============================================
        // ğŸ“¸ æ¯æ—¥å°é¢ç…§ç‰‡åŠŸèƒ½
        // ============================================
        let currentPhotoDay = null;
        let selectedPhotoData = null;
        
        function showPhotoModal(dayDate) {
            currentPhotoDay = dayDate;
            selectedPhotoData = appData.dayCovers?.[dayDate] || null;
            
            const preview = document.getElementById('photoPreview');
            if (selectedPhotoData) {
                preview.innerHTML = `<img src="${selectedPhotoData}" style="width:100%;height:100%;object-fit:cover;">`;
            } else {
                preview.innerHTML = `<div style="text-align:center;color:var(--text-dim);"><div style="font-size:2em;">ğŸ“·</div><div>é»æ“Šé¸æ“‡ç…§ç‰‡</div></div>`;
            }
            
            showModal('photoModal');
        }
        
        function handlePhotoSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // å£“ç¸®ç…§ç‰‡
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const maxWidth = 800;
                    const maxHeight = 450;
                    let { width, height } = img;
                    
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    if (height > maxHeight) {
                        width = (width * maxHeight) / height;
                        height = maxHeight;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    selectedPhotoData = canvas.toDataURL('image/jpeg', 0.7);
                    document.getElementById('photoPreview').innerHTML = `<img src="${selectedPhotoData}" style="width:100%;height:100%;object-fit:cover;">`;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function saveDayCover() {
            if (!currentPhotoDay) return;
            if (!appData.dayCovers) appData.dayCovers = {};
            
            if (selectedPhotoData) {
                appData.dayCovers[currentPhotoDay] = selectedPhotoData;
            }
            
            saveData();
            renderDays();
            closeModal('photoModal');
            showToast('å°é¢ç…§ç‰‡å·²å„²å­˜ï¼', 'success');
        }
        
        function removeDayCover() {
            if (!currentPhotoDay) return;
            if (appData.dayCovers?.[currentPhotoDay]) {
                delete appData.dayCovers[currentPhotoDay];
                saveData();
                renderDays();
            }
            closeModal('photoModal');
            showToast('å°é¢ç…§ç‰‡å·²ç§»é™¤', 'success');
        }
        
        // ============================================
        // âœï¸ æ¯æ—¥æ—…éŠé»æ»´åŠŸèƒ½
        // ============================================
        function showDailyNotesModal(dayDate, dayTitle) {
            document.getElementById('currentNoteDate').value = dayDate;
            document.getElementById('currentNoteDayTitle').value = dayTitle;
            document.getElementById('notesModalDayTitle').textContent = dayTitle;
            document.getElementById('notesModalDayDate').textContent = formatDate(new Date(dayDate));
            document.getElementById('noteContent').value = '';
            document.getElementById('selectedMood').value = 'ğŸ˜Š';
            
            // é‡è¨­å¿ƒæƒ…é¸æ“‡
            document.querySelectorAll('.mood-option').forEach(m => m.classList.remove('selected'));
            document.querySelector('.mood-option[data-mood="ğŸ˜Š"]').classList.add('selected');
            
            renderDailyNotes(dayDate);
            showModal('dailyNotesModal');
        }
        
        function selectMood(el) {
            document.querySelectorAll('.mood-option').forEach(m => m.classList.remove('selected'));
            el.classList.add('selected');
            document.getElementById('selectedMood').value = el.dataset.mood;
        }
        
        function renderDailyNotes(dayDate) {
            const container = document.getElementById('dailyNotesList');
            if (!appData.dailyNotes) appData.dailyNotes = {};
            const notes = appData.dailyNotes[dayDate] || [];
            
            if (notes.length === 0) {
                container.innerHTML = `
                    <div class="note-empty">
                        <div class="icon">ğŸ“</div>
                        <div>é‚„æ²’æœ‰ä»»ä½•é»æ»´è¨˜éŒ„</div>
                        <div style="font-size:0.85em;margin-top:5px;color:var(--text-muted);">å¯«ä¸‹ä»Šå¤©çš„æ—…éŠå¿ƒæƒ…å§ï¼</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = notes.map(note => `
                <div class="note-item">
                    <button class="note-delete" onclick="deleteDailyNote('${dayDate}', ${note.id})" title="åˆªé™¤">ğŸ—‘ï¸</button>
                    <div class="note-header">
                        <span class="note-time">ğŸ• ${note.time}</span>
                        <span class="note-mood">${note.mood}</span>
                    </div>
                    <div class="note-content">${escapeHtml(note.content)}</div>
                </div>
            `).join('');
        }
        
        function addDailyNote() {
            const dayDate = document.getElementById('currentNoteDate').value;
            const content = document.getElementById('noteContent').value.trim();
            const mood = document.getElementById('selectedMood').value;
            
            if (!content) {
                showToast('è«‹è¼¸å…¥å¿ƒå¾—å…§å®¹', 'error');
                return;
            }
            
            if (!appData.dailyNotes) appData.dailyNotes = {};
            if (!appData.dailyNotes[dayDate]) appData.dailyNotes[dayDate] = [];
            
            const now = new Date();
            const note = {
                id: Date.now(),
                time: now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' }),
                mood: mood,
                content: content
            };
            
            appData.dailyNotes[dayDate].push(note);
            saveData();
            
            document.getElementById('noteContent').value = '';
            renderDailyNotes(dayDate);
            renderDays();
            showToast('æ—…éŠé»æ»´å·²è¨˜éŒ„ âœ¨', 'success');
        }
        
        function deleteDailyNote(dayDate, noteId) {
            if (!confirm('ç¢ºå®šè¦åˆªé™¤é€™å‰‡é»æ»´å—ï¼Ÿ')) return;
            
            if (appData.dailyNotes?.[dayDate]) {
                appData.dailyNotes[dayDate] = appData.dailyNotes[dayDate].filter(n => n.id !== noteId);
                if (appData.dailyNotes[dayDate].length === 0) {
                    delete appData.dailyNotes[dayDate];
                }
                saveData();
                renderDailyNotes(dayDate);
                renderDays();
                showToast('é»æ»´å·²åˆªé™¤', 'success');
            }
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // ============================================
        // ğŸ“ åŒ¯å‡º Google Docï¼ˆæ—…éŠç´€éŒ„ï¼‰
        // ============================================
        async function exportToGoogleDoc() {
            console.log('exportToGoogleDoc é–‹å§‹åŸ·è¡Œ');
            
            if (!appData.trip.name && !appData.trip.destination) {
                showToast('è«‹å…ˆè¨­å®šæ—…éŠè³‡è¨Š', 'error');
                return;
            }
            
            // æª¢æŸ¥ Google æˆæ¬Š
            const token = getStoredToken();
            console.log('Token ç‹€æ…‹:', token ? 'æœ‰æ•ˆ' : 'ç„¡æ•ˆ');
            
            if (!token) {
                showToast('è«‹å…ˆæˆæ¬Š Google å¸³è™Ÿï¼ˆå« Drive æ¬Šé™ï¼‰', 'error');
                closeModal('exportModal');
                return;
            }
            
            showToast('æ­£åœ¨å»ºç«‹ Google Doc...', 'success');
            closeModal('exportModal');
            
            try {
                const result = await exportTripToGoogleDoc();
                const trip = appData.trip;
                const docTitle = `${trip.name || trip.destination + 'ä¹‹æ—…'} - æ—…éŠç´€éŒ„`;
                const docUrl = `https://docs.google.com/document/d/${result.id}/edit`;
                
                // é¡¯ç¤ºé€£çµ Modalï¼ˆæ‰‹æ©Ÿå‹å¥½ï¼‰
                showDocLinkModal(docTitle, docUrl);
                
            } catch (error) {
                console.error('å»ºç«‹ Google Doc å¤±æ•—:', error);
                showToast('å»ºç«‹å¤±æ•—ï¼š' + error.message, 'error');
                
                // å¦‚æœæ˜¯æˆæ¬Šå•é¡Œï¼Œæç¤ºé‡æ–°æˆæ¬Š
                if (error.message.includes('401') || error.message.includes('auth')) {
                    localStorage.removeItem(TOKEN_KEY);
                    showToast('è«‹é‡æ–°æˆæ¬Š Google å¸³è™Ÿ', 'error');
                }
            }
        }
        
        // ğŸ“ é¡¯ç¤º Google Doc é€£çµ Modalï¼ˆæ‰‹æ©Ÿå‹å¥½ï¼‰
        let pendingClearTrip = false;
        
        function showDocLinkModal(title, url, afterClear = false) {
            document.getElementById('docLinkTitle').textContent = title;
            const linkEl = document.getElementById('docLinkUrl');
            linkEl.href = url;
            
            // æ ¹æ“šæ˜¯å¦ç‚ºæ¸…é™¤æµç¨‹é¡¯ç¤ºä¸åŒæŒ‰éˆ•
            const actionsEl = document.getElementById('docLinkActions');
            if (afterClear) {
                pendingClearTrip = true;
                actionsEl.innerHTML = `
                    <button class="btn btn-danger" style="width:100%;margin-bottom:10px;" onclick="closeDocLinkAndClear()">
                        ğŸ—‘ï¸ ç¹¼çºŒæ¸…é™¤æ—…è¡Œè³‡æ–™
                    </button>
                    <button class="btn btn-outline" style="width:100%;" onclick="closeDocLinkModal()">
                        å–æ¶ˆï¼ˆä¿ç•™è³‡æ–™ï¼‰
                    </button>
                `;
            } else {
                pendingClearTrip = false;
                actionsEl.innerHTML = `
                    <button class="btn btn-outline" style="width:100%;" onclick="closeDocLinkModal()">é—œé–‰</button>
                `;
            }
            
            showModal('docLinkModal');
            showToast('âœ… Google Doc å»ºç«‹æˆåŠŸï¼', 'success');
        }
        
        function closeDocLinkModal() {
            pendingClearTrip = false;
            closeModal('docLinkModal');
        }
        
        function closeDocLinkAndClear() {
            closeModal('docLinkModal');
            // ç›´æ¥åŸ·è¡Œæ¸…é™¤ï¼Œä¸å†è©¢å•
            doResetTrip();
        }
        
        // ============================================
        // ğŸ‘¥ æ—…ä¼´ç®¡ç†èˆ‡åˆ†å¸³åŠŸèƒ½
        // ============================================
        function renderMembers() {
            const container = document.getElementById('membersList');
            if (!container) return;
            if (!appData.members) appData.members = ['æˆ‘'];
            
            container.innerHTML = appData.members.map((m, i) => `
                <span class="member-tag ${i === 0 ? 'me' : ''}">
                    ğŸ‘¤ ${m}
                    ${i > 0 ? `<span class="remove" onclick="removeMember(${i})">âœ•</span>` : ''}
                </span>
            `).join('');
        }
        
        function addMember() {
            const input = document.getElementById('newMemberName');
            const name = input.value.trim();
            if (!name) { showToast('è«‹è¼¸å…¥æ—…ä¼´åç¨±', 'error'); return; }
            if (appData.members.includes(name)) { showToast('æ­¤åç¨±å·²å­˜åœ¨', 'error'); return; }
            
            appData.members.push(name);
            saveData();
            renderMembers();
            input.value = '';
            showToast(`å·²æ–°å¢æ—…ä¼´ï¼š${name}`, 'success');
        }
        
        function removeMember(index) {
            if (index === 0) return; // ä¸èƒ½ç§»é™¤ã€Œæˆ‘ã€
            const name = appData.members[index];
            if (!confirm(`ç¢ºå®šç§»é™¤æ—…ä¼´ã€Œ${name}ã€ï¼Ÿ\nç›¸é—œçš„åˆ†å¸³è¨˜éŒ„å°‡ä¿ç•™ã€‚`)) return;
            
            appData.members.splice(index, 1);
            saveData();
            renderMembers();
            showToast(`å·²ç§»é™¤æ—…ä¼´ï¼š${name}`, 'success');
        }
        
        function updateSplitOptions() {
            // æ›´æ–°å¢Šä»˜äººé¸å–®
            const paidBySelect = document.getElementById('expensePaidBy');
            paidBySelect.innerHTML = appData.members.map(m => `<option value="${m}">${m}</option>`).join('');
            
            // æ›´æ–°åˆ†æ”¤å°è±¡ checkbox
            const container = document.getElementById('splitWithCheckboxes');
            container.innerHTML = appData.members.map(m => `
                <label class="split-checkbox checked" onclick="toggleSplitCheckbox(this)">
                    <span class="check">âœ“</span>
                    <span>${m}</span>
                    <input type="checkbox" value="${m}" checked>
                </label>
            `).join('');
        }
        
        function toggleSplitCheckbox(el) {
            el.classList.toggle('checked');
            el.querySelector('input').checked = el.classList.contains('checked');
        }
        
        function calculateSplit() {
            const members = appData.members || ['æˆ‘'];
            const result = {};
            
            // åˆå§‹åŒ–æ¯å€‹äººçš„æ•¸æ“š
            members.forEach(m => {
                result[m] = { paid: 0, shouldPay: 0, balance: 0 };
            });
            
            // è¨ˆç®—æ¯ç­†æ¶ˆè²»
            appData.expenses.forEach(e => {
                const rate = EXCHANGE_RATES[e.currency]?.rate || 1;
                const twdAmount = e.amount * rate;
                const paidBy = e.paidBy || 'æˆ‘';
                const splitWith = e.splitWith || members;
                
                // å¢Šä»˜äººå¢åŠ  paid
                if (result[paidBy]) {
                    result[paidBy].paid += twdAmount;
                }
                
                // åˆ†æ”¤é‡‘é¡
                const splitCount = splitWith.length || 1;
                const perPerson = twdAmount / splitCount;
                
                splitWith.forEach(person => {
                    if (result[person]) {
                        result[person].shouldPay += perPerson;
                    }
                });
            });
            
            // è¨ˆç®—é¤˜é¡ï¼ˆpaid - shouldPay = æ‡‰æ”¶/æ‡‰ä»˜ï¼‰
            members.forEach(m => {
                result[m].balance = result[m].paid - result[m].shouldPay;
            });
            
            return result;
        }
        
        function renderSplitSummary() {
            const card = document.getElementById('splitSummaryCard');
            const container = document.getElementById('splitSummary');
            
            if (!appData.members || appData.members.length <= 1 || appData.expenses.length === 0) {
                card.style.display = 'none';
                return;
            }
            
            const splitData = calculateSplit();
            const members = Object.keys(splitData);
            
            // è¨ˆç®—è½‰å¸³å»ºè­°
            const debtors = []; // æ‡‰ä»˜çš„äºº
            const creditors = []; // æ‡‰æ”¶çš„äºº
            
            members.forEach(m => {
                const balance = Math.round(splitData[m].balance);
                if (balance < -10) { // æ¬ éŒ¢
                    debtors.push({ name: m, amount: Math.abs(balance) });
                } else if (balance > 10) { // è©²æ”¶éŒ¢
                    creditors.push({ name: m, amount: balance });
                }
            });
            
            // ç”Ÿæˆè½‰å¸³å»ºè­°
            const transactions = [];
            debtors.sort((a, b) => b.amount - a.amount);
            creditors.sort((a, b) => b.amount - a.amount);
            
            let di = 0, ci = 0;
            while (di < debtors.length && ci < creditors.length) {
                const debtor = debtors[di];
                const creditor = creditors[ci];
                const amount = Math.min(debtor.amount, creditor.amount);
                
                if (amount > 10) {
                    transactions.push({ from: debtor.name, to: creditor.name, amount: Math.round(amount) });
                }
                
                debtor.amount -= amount;
                creditor.amount -= amount;
                
                if (debtor.amount < 10) di++;
                if (creditor.amount < 10) ci++;
            }
            
            // æ¸²æŸ“çµæœ
            card.style.display = 'block';
            container.innerHTML = `
                ${members.map(m => {
                    const data = splitData[m];
                    const balance = Math.round(data.balance);
                    return `
                        <div class="split-person">
                            <div class="split-person-header">
                                <span class="split-person-name">ğŸ‘¤ ${m}</span>
                                <div class="split-person-stats">
                                    <div class="split-stat">
                                        <span class="split-stat-label">å·²å¢Šä»˜</span>
                                        <span class="split-stat-value paid">NT$${Math.round(data.paid).toLocaleString()}</span>
                                    </div>
                                    <div class="split-stat">
                                        <span class="split-stat-label">æ‡‰åˆ†æ”¤</span>
                                        <span class="split-stat-value owe">NT$${Math.round(data.shouldPay).toLocaleString()}</span>
                                    </div>
                                    <div class="split-stat">
                                        <span class="split-stat-label">${balance >= 0 ? 'æ‡‰æ”¶' : 'æ‡‰ä»˜'}</span>
                                        <span class="split-stat-value ${balance >= 0 ? 'receive' : 'owe'}">${balance >= 0 ? '+' : '-'}NT$${Math.abs(balance).toLocaleString()}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('')}
                
                ${transactions.length > 0 ? `
                    <div class="split-transactions">
                        <div style="font-size:0.85em;color:var(--emerald);margin-bottom:10px;">ğŸ’¸ å»ºè­°è½‰å¸³æ–¹å¼</div>
                        ${transactions.map(tx => `
                            <div class="split-tx">
                                <span>ğŸ‘¤ ${tx.from}</span>
                                <span class="split-tx-arrow">â†’</span>
                                <span>ğŸ‘¤ ${tx.to}</span>
                                <span class="split-tx-amount">NT$${tx.amount.toLocaleString()}</span>
                            </div>
                        `).join('')}
                    </div>
                ` : '<div style="text-align:center;color:var(--emerald);padding:10px;">âœ… å¤ªæ£’äº†ï¼å¤§å®¶å·²ç¶“çµæ¸…äº†ï¼</div>'}
            `;
        }
        
        function showAddExpenseModal() {
            const select = document.getElementById('expenseDay');
            select.innerHTML = appData.days.map(d => `<option value="${d.date}">${d.title}</option>`).join('');
            document.getElementById('expenseItem').value = '';
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseNote').value = '';
            updateSplitOptions(); // æ›´æ–°åˆ†å¸³é¸é …
            showModal('expenseModal');
        }
        
        function saveExpense() {
            const date = document.getElementById('expenseDay').value;
            const category = document.getElementById('expenseCategory').value;
            const item = document.getElementById('expenseItem').value;
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const currency = document.getElementById('expenseCurrency').value;
            const payment = document.getElementById('expensePayment').value;
            
            // ğŸ‘¥ åˆ†å¸³è³‡è¨Š
            const paidBy = document.getElementById('expensePaidBy').value || 'æˆ‘';
            const splitWithChecks = document.querySelectorAll('#splitWithCheckboxes .split-checkbox.checked input');
            const splitWith = Array.from(splitWithChecks).map(c => c.value);
            
            if (!item || !amount) { showToast('è«‹å¡«å¯«é …ç›®å’Œé‡‘é¡', 'error'); return; }
            if (splitWith.length === 0) { showToast('è«‹è‡³å°‘é¸æ“‡ä¸€ä½åˆ†æ”¤å°è±¡', 'error'); return; }
            
            appData.expenses.push({ id: Date.now(), date, category, item, amount, currency, payment, paidBy, splitWith });
            saveData();
            renderExpenses();
            closeModal('expenseModal');
            showToast('å·²è¨˜éŒ„', 'success');
        }
        
        function deleteExpense(id) {
            if (!confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) return;
            appData.expenses = appData.expenses.filter(e => e.id !== id);
            saveData();
            renderExpenses();
        }
        
        function renderShopping() {
            const total = appData.shopping.length;
            const bought = appData.shopping.filter(s => s.bought).length;
            const progress = total > 0 ? Math.round((bought / total) * 100) : 0;
            document.getElementById('shoppingProgress').textContent = progress + '%';
            document.getElementById('shoppingProgressBar').style.width = progress + '%';
            
            const container = document.getElementById('shoppingList');
            if (total === 0) {
                container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ›’</div><div>è³¼ç‰©æ¸…å–®æ˜¯ç©ºçš„</div></div>';
                return;
            }
            const sorted = [...appData.shopping].sort((a, b) => {
                if (a.bought !== b.bought) return a.bought ? 1 : -1;
                const p = { high: 0, medium: 1, low: 2 };
                return p[a.priority] - p[b.priority];
            });
            container.innerHTML = sorted.map(s => `
                <div class="shop-item ${s.bought ? 'bought' : ''}" onclick="toggleShopping(${s.id})">
                    <div class="shop-checkbox">${s.bought ? 'âœ“' : ''}</div>
                    <div class="shop-info">
                        <div class="shop-name">${s.item}</div>
                        <div class="shop-meta">${s.budget ? 'Â¥' + s.budget.toLocaleString() : ''}${s.store ? ' â€¢ ' + s.store : ''}</div>
                    </div>
                    <span class="shop-priority ${s.priority}">${{ high: 'å¿…è²·', medium: 'æƒ³è²·', low: 'éš¨æ„' }[s.priority]}</span>
                </div>
            `).join('');
        }
        
        function showAddShoppingModal() {
            document.getElementById('shopItem').value = '';
            document.getElementById('shopBudget').value = '';
            showModal('shoppingModal');
        }
        
        function saveShopping() {
            const item = document.getElementById('shopItem').value;
            const budget = parseFloat(document.getElementById('shopBudget').value) || 0;
            const priority = document.getElementById('shopPriority').value;
            const store = document.getElementById('shopStore').value;
            if (!item) { showToast('è«‹è¼¸å…¥å•†å“åç¨±', 'error'); return; }
            appData.shopping.push({ id: Date.now(), item, budget, priority, store, bought: false });
            saveData();
            renderShopping();
            closeModal('shoppingModal');
            showToast('å·²åŠ å…¥', 'success');
        }
        
        function toggleShopping(id) {
            const item = appData.shopping.find(s => s.id === id);
            if (item) { item.bought = !item.bought; saveData(); renderShopping(); }
        }
        
        // ============================================
        // åŒ¯å‡º & å„²å­˜
        // ============================================
        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet([['æ—…éŠåç¨±', appData.trip.name], ['ç›®çš„åœ°', appData.trip.destination], ['æ—¥æœŸ', appData.trip.startDate + ' ~ ' + appData.trip.endDate]]), 'æ—…éŠè³‡è¨Š');
            const scheduleData = [['æ—¥æœŸ', 'æ™‚é–“', 'æ´»å‹•', 'é¡å‹', 'åœ°é»']];
            appData.days.forEach(d => d.schedules.forEach(s => scheduleData.push([d.date, s.startTime + '-' + s.endTime, s.title, s.type, s.location])));
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(scheduleData), 'è¡Œç¨‹');
            const expenseData = [['æ—¥æœŸ', 'é¡åˆ¥', 'é …ç›®', 'é‡‘é¡', 'å¹£åˆ¥']];
            appData.expenses.forEach(e => expenseData.push([e.date, e.category, e.item, e.amount, e.currency]));
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(expenseData), 'èŠ±è²»');
            XLSX.writeFile(wb, (appData.trip.name || 'æ—…éŠè¦åŠƒ') + '.xlsx');
            closeModal('exportModal');
            showToast('âœ… å·²ä¸‹è¼‰', 'success');
        }
        
        function saveData() {
            if (!appData.settings.storageEnabled) return;
            try { localStorage.setItem(STORAGE_KEY, JSON.stringify(appData)); } catch (e) {}
        }
        
        function loadData() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) appData = { ...appData, ...JSON.parse(saved) };
            } catch (e) {}
        }
        
        function saveSettings() {
            appData.settings.googleClientId = document.getElementById('googleClientId').value;
            appData.settings.lineToken = document.getElementById('lineToken').value;
            appData.settings.lineUserId = document.getElementById('lineUserId').value;
            appData.settings.gasUrl = document.getElementById('gasUrl').value;
            appData.settings.gasSecret = document.getElementById('gasSecret').value;
            saveData();
        }
        
        function toggleStorage() {
            const toggle = document.getElementById('storageToggle');
            toggle.classList.toggle('active');
            appData.settings.storageEnabled = toggle.classList.contains('active');
            if (appData.settings.storageEnabled) saveData();
            showToast(appData.settings.storageEnabled ? 'âœ… å·²å•Ÿç”¨å„²å­˜' : 'âš ï¸ å·²åœç”¨å„²å­˜', 'success');
        }
        
        function clearAllData() {
            if (!confirm('ç¢ºå®šæ¸…é™¤æ‰€æœ‰è³‡æ–™ï¼Ÿ')) return;
            localStorage.removeItem(STORAGE_KEY);
            localStorage.removeItem(TOKEN_KEY);
            location.reload();
        }
        
        function renderAll() {
            document.getElementById('tripName').value = appData.trip.name || '';
            document.getElementById('destination').value = appData.trip.customDestination ? 'custom' : (appData.trip.destination || '');
            if (appData.trip.customDestination) {
                document.getElementById('customDestGroup').style.display = 'block';
                document.getElementById('customDestination').value = appData.trip.customDestination;
            }
            document.getElementById('startDate').value = appData.trip.startDate || '';
            document.getElementById('endDate').value = appData.trip.endDate || '';
            document.getElementById('mainCurrency').value = appData.trip.mainCurrency || 'JPY';
            document.getElementById('googleClientId').value = appData.settings.googleClientId || '';
            document.getElementById('lineToken').value = appData.settings.lineToken || '';
            document.getElementById('lineUserId').value = appData.settings.lineUserId || '';
            document.getElementById('gasUrl').value = appData.settings.gasUrl || '';
            document.getElementById('gasSecret').value = appData.settings.gasSecret || '';
            if (appData.settings.storageEnabled) document.getElementById('storageToggle').classList.add('active');
            updateTripInfo();
            renderItinerary();
            renderExpenses();
            renderShopping();
            renderMembers(); // ğŸ‘¥ æ¸²æŸ“æ—…ä¼´åˆ—è¡¨
            renderCheckinPage(); // ğŸ“¸ æ¸²æŸ“æ‰“å¡é é¢
        }
        
        // ============================================
        // UI è¼”åŠ©
        // ============================================
        function showModal(id) { document.getElementById(id).classList.add('show'); }
        function closeModal(id) { document.getElementById(id).classList.remove('show'); }
        function toggleReminder(el) { el.classList.toggle('checked'); }
        function toggleVisibility(id) { const el = document.getElementById(id); el.type = el.type === 'password' ? 'text' : 'password'; }
        function showToast(msg, type = 'info') { const t = document.getElementById('toast'); t.textContent = msg; t.className = 'toast show ' + type; setTimeout(() => t.classList.remove('show'), 3000); }
        function formatDate(d) { const w = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­']; return `${d.getMonth()+1}/${d.getDate()} (${w[d.getDay()]})`; }
        function getTypeEmoji(t) { return { 'æ™¯é»': 'ğŸ›ï¸', 'ç¾é£Ÿ': 'ğŸœ', 'äº¤é€š': 'ğŸšƒ', 'ä½å®¿': 'ğŸ¨', 'è³¼ç‰©': 'ğŸ›ï¸', 'å…¶ä»–': 'ğŸ“Œ' }[t] || 'ğŸ“Œ'; }
        function getCategoryEmoji(c) { return { 'é£²é£Ÿ': 'ğŸœ', 'äº¤é€š': 'ğŸšƒ', 'ä½å®¿': 'ğŸ¨', 'è³¼ç‰©': 'ğŸ›ï¸', 'é–€ç¥¨': 'ğŸ«', 'å…¶ä»–': 'ğŸ“Œ' }[c] || 'ğŸ“Œ'; }
        function getCurrencySymbol(c) { 
            const symbols = { 
                'JPY': 'Â¥', 'KRW': 'â‚©', 'THB': 'à¸¿', 'USD': '$', 'TWD': 'NT$',
                'EUR': 'â‚¬', 'GBP': 'Â£', 'HKD': 'HK$', 'SGD': 'S$', 'MYR': 'RM',
                'VND': 'â‚«', 'PHP': 'â‚±', 'IDR': 'Rp', 'AUD': 'A$', 'NZD': 'NZ$',
                'CNY': 'Â¥', 'CHF': 'CHF', 'CZK': 'KÄ', 'MOP': 'MOP$', 'CAD': 'C$',
                'MXN': 'MX$', 'ZAR': 'R', 'EGP': 'EÂ£', 'MAD': 'MAD', 'KES': 'KSh'
            };
            return symbols[c] || ''; 
        }
        
        document.querySelectorAll('.modal-overlay').forEach(o => o.addEventListener('click', function(e) { if (e.target === this) this.classList.remove('show'); }));
        
        // ============================================
        // ğŸ“¸ æ™¯é»æ‰“å¡åŠŸèƒ½
        // ============================================
        function switchCheckinTab(tab) {
            document.querySelectorAll('.checkin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.checkin-section').forEach(s => s.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('checkinSection' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
            
            if (tab === 'memoir') renderMemoir();
            if (tab === 'badges') renderBadges();
        }
        
        function renderCheckinPage() {
            if (!appData.spots) appData.spots = [];
            if (!appData.checkins) appData.checkins = [];
            if (!appData.badges) appData.badges = {};
            
            // æ›´æ–°çµ±è¨ˆ
            document.getElementById('checkinPhotoCount').textContent = appData.checkins.length;
            const checked = appData.spots.filter(s => s.checked).length;
            document.getElementById('checkinSpotCount').textContent = `${checked}/${appData.spots.length}`;
            document.getElementById('checkinBadgeCount').textContent = Object.keys(appData.badges).length;
            
            renderSpots();
            renderCheckinPhotos();
            renderBadges();
        }
        
        // ğŸ“ æ™¯é»ç®¡ç†
        function showAddSpotModal() {
            document.getElementById('newSpotName').value = '';
            document.getElementById('newSpotNote').value = '';
            showModal('spotModal');
        }
        
        function addSpot() {
            const name = document.getElementById('newSpotName').value.trim();
            const type = document.getElementById('newSpotType').value;
            const note = document.getElementById('newSpotNote').value.trim();
            
            if (!name) { showToast('è«‹è¼¸å…¥æ™¯é»åç¨±', 'error'); return; }
            
            appData.spots.push({ id: Date.now(), name, type, note, checked: false, checkedAt: null });
            saveData();
            renderCheckinPage();
            closeModal('spotModal');
            showToast('å·²æ–°å¢æ™¯é» ğŸ“', 'success');
        }
        
        function toggleSpot(id) {
            const spot = appData.spots.find(s => s.id === id);
            if (spot) {
                spot.checked = !spot.checked;
                spot.checkedAt = spot.checked ? new Date().toISOString() : null;
                saveData();
                renderCheckinPage();
                checkBadges();
                if (spot.checked) showToast(`ğŸ‰ æ‰“å¡æˆåŠŸï¼š${spot.name}`, 'success');
            }
        }
        
        function deleteSpot(id, e) {
            e.stopPropagation();
            if (!confirm('ç¢ºå®šåˆªé™¤æ­¤æ™¯é»ï¼Ÿ')) return;
            appData.spots = appData.spots.filter(s => s.id !== id);
            saveData();
            renderCheckinPage();
            showToast('å·²åˆªé™¤æ™¯é»', 'success');
        }
        
        function renderSpots() {
            const container = document.getElementById('spotList');
            if (appData.spots.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ“</div><div>é‚„æ²’æœ‰æ™¯é»</div><div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">æ–°å¢æƒ³å»çš„æ™¯é»é–‹å§‹æ‰“å¡å§ï¼</div></div>`;
                return;
            }
            container.innerHTML = appData.spots.map(spot => `
                <div class="spot-card ${spot.checked ? 'checked' : ''}" onclick="toggleSpot(${spot.id})">
                    <div class="spot-checkbox">${spot.checked ? 'âœ“' : ''}</div>
                    <div class="spot-info">
                        <div class="spot-name">${getTypeEmoji(spot.type)} ${spot.name}</div>
                        <div class="spot-meta">
                            <span>${spot.type}</span>
                            ${spot.note ? `<span>â€¢ ${spot.note}</span>` : ''}
                        </div>
                    </div>
                    <button class="spot-delete" onclick="deleteSpot(${spot.id}, event)">ğŸ—‘ï¸</button>
                </div>
            `).join('');
        }
        
        // ğŸ“¸ æ‹ç…§æ‰“å¡
        let currentCheckinPhoto = null;
        
        function showAddCheckinModal() {
            currentCheckinPhoto = null;
            document.getElementById('checkinUploadArea').innerHTML = `<div class="photo-upload-icon">ğŸ“·</div><div class="photo-upload-text">é»æ“Šä¸Šå‚³ç…§ç‰‡æˆ–æ‹ç…§</div>`;
            document.getElementById('checkinUploadArea').classList.remove('has-photo');
            document.getElementById('checkinDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('checkinNote').value = '';
            
            // æ›´æ–°æ™¯é»ä¸‹æ‹‰é¸å–®
            const select = document.getElementById('checkinSpot');
            select.innerHTML = '<option value="">-- ä¸é¸æ“‡ --</option>' + 
                appData.spots.map(s => `<option value="${s.id}">${getTypeEmoji(s.type)} ${s.name}</option>`).join('');
            
            showModal('checkinModal');
        }
        
        function handleCheckinPhoto(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                // å£“ç¸®ç…§ç‰‡
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const maxSize = 800;
                    let { width, height } = img;
                    if (width > height && width > maxSize) { height = (height * maxSize) / width; width = maxSize; }
                    else if (height > maxSize) { width = (width * maxSize) / height; height = maxSize; }
                    canvas.width = width;
                    canvas.height = height;
                    canvas.getContext('2d').drawImage(img, 0, 0, width, height);
                    currentCheckinPhoto = canvas.toDataURL('image/jpeg', 0.7);
                    document.getElementById('checkinUploadArea').innerHTML = `<img src="${currentCheckinPhoto}" alt="é è¦½">`;
                    document.getElementById('checkinUploadArea').classList.add('has-photo');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function saveCheckin() {
            if (!currentCheckinPhoto) { showToast('è«‹å…ˆä¸Šå‚³ç…§ç‰‡', 'error'); return; }
            
            const spotId = document.getElementById('checkinSpot').value;
            const date = document.getElementById('checkinDate').value;
            const note = document.getElementById('checkinNote').value.trim();
            
            let spotName = 'æœªæ¨™è¨˜æ™¯é»';
            if (spotId) {
                const spot = appData.spots.find(s => s.id == spotId);
                if (spot) {
                    spotName = spot.name;
                    if (!spot.checked) {
                        spot.checked = true;
                        spot.checkedAt = new Date().toISOString();
                    }
                }
            }
            
            appData.checkins.push({ id: Date.now(), photo: currentCheckinPhoto, spotId: spotId || null, spotName, date, note });
            saveData();
            renderCheckinPage();
            closeModal('checkinModal');
            checkBadges();
            showToast('ğŸ“¸ æ‰“å¡æˆåŠŸï¼', 'success');
        }
        
        function renderCheckinPhotos() {
            const container = document.getElementById('checkinPhotoGrid');
            if (appData.checkins.length === 0) {
                container.innerHTML = `<div class="empty-state" style="grid-column:1/-1;"><div class="empty-icon">ğŸ“·</div><div>é‚„æ²’æœ‰ç…§ç‰‡</div><div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">ä¸Šå‚³ç…§ç‰‡è¨˜éŒ„ç¾å¥½æ™‚åˆ»ï¼</div></div>`;
                return;
            }
            container.innerHTML = appData.checkins.map((c, i) => `
                <div class="checkin-photo" onclick="viewPhoto(${i})">
                    <img src="${c.photo}" alt="${c.spotName}">
                    <div class="checkin-photo-overlay">ğŸ“ ${c.spotName}</div>
                </div>
            `).join('');
        }
        
        function viewPhoto(index) {
            const c = appData.checkins[index];
            document.getElementById('viewerPhoto').src = c.photo;
            document.getElementById('viewerSpot').textContent = 'ğŸ“ ' + c.spotName;
            document.getElementById('viewerNote').textContent = c.note || '';
            document.getElementById('photoViewerOverlay').classList.add('show');
        }
        
        function closePhotoViewer() {
            document.getElementById('photoViewerOverlay').classList.remove('show');
        }
        
        // ğŸ† æˆå°±å¾½ç« 
        function checkBadges() {
            let newBadge = null;
            CHECKIN_BADGES.forEach(badge => {
                if (!appData.badges[badge.id] && badge.condition(appData)) {
                    appData.badges[badge.id] = new Date().toISOString();
                    newBadge = badge;
                }
            });
            if (newBadge) {
                saveData();
                renderCheckinPage();
                showToast(`ğŸ† è§£é–æˆå°±ï¼š${newBadge.name}`, 'success');
            }
        }
        
        function renderBadges() {
            const container = document.getElementById('badgeGrid');
            container.innerHTML = CHECKIN_BADGES.map(badge => {
                const unlocked = !!appData.badges[badge.id];
                const progress = badge.getValue ? badge.getValue(appData) : 0;
                const total = badge.total || 1;
                const percent = Math.min((progress / total) * 100, 100);
                
                return `
                    <div class="badge-card ${unlocked ? 'unlocked' : 'locked'}">
                        <div class="badge-icon">${badge.icon}</div>
                        <div class="badge-name">${badge.name}</div>
                        <div class="badge-desc">${badge.desc}</div>
                        ${badge.total ? `<div class="badge-progress"><div class="badge-progress-fill" style="width:${percent}%"></div></div>` : ''}
                    </div>
                `;
            }).join('');
        }
        
        // ğŸ“– å›æ†¶éŒ„
        function renderMemoir() {
            const container = document.getElementById('memoirTimeline');
            if (appData.checkins.length === 0) {
                container.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ“–</div><div>é–‹å§‹è¨˜éŒ„ä½ çš„æ—…ç¨‹</div><div style="font-size:0.85em;color:var(--text-dim);margin-top:5px;">æ‰“å¡æ™¯é»ä¸¦ä¸Šå‚³ç…§ç‰‡ï¼Œè‡ªå‹•ç”¢ç”Ÿå›æ†¶éŒ„</div></div>`;
                return;
            }
            
            // æŒ‰æ—¥æœŸåˆ†çµ„
            const grouped = {};
            appData.checkins.forEach(c => {
                if (!grouped[c.date]) grouped[c.date] = [];
                grouped[c.date].push(c);
            });
            
            const sortedDates = Object.keys(grouped).sort((a, b) => new Date(a) - new Date(b));
            container.innerHTML = sortedDates.map((date, i) => `
                <div class="memoir-day">
                    <div class="memoir-day-title">Day ${i + 1} â€¢ ${formatDate(new Date(date))}</div>
                    ${grouped[date].map(c => `
                        <div class="memoir-entry">
                            <img class="memoir-entry-photo" src="${c.photo}" alt="${c.spotName}">
                            <div class="memoir-entry-content">
                                <div class="memoir-entry-spot">ğŸ“ ${c.spotName}</div>
                                ${c.note ? `<div class="memoir-entry-note">${c.note}</div>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }
        
        function exportMemoirHtml() {
            const hasCheckins = appData.checkins && appData.checkins.length > 0;
            const hasNotes = appData.dailyNotes && Object.keys(appData.dailyNotes).length > 0;
            
            if (!hasCheckins && !hasNotes) { 
                showToast('æ²’æœ‰å›æ†¶å¯åŒ¯å‡º', 'error'); 
                return; 
            }
            
            // æ”¶é›†æ‰€æœ‰æ—¥æœŸ
            const allDates = new Set();
            if (hasCheckins) appData.checkins.forEach(c => allDates.add(c.date));
            if (hasNotes) Object.keys(appData.dailyNotes).forEach(d => allDates.add(d));
            const sortedDates = Array.from(allDates).sort((a, b) => new Date(a) - new Date(b));
            
            // åˆ†çµ„æ‰“å¡ç…§ç‰‡
            const photosByDate = {};
            if (hasCheckins) {
                appData.checkins.forEach(c => {
                    if (!photosByDate[c.date]) photosByDate[c.date] = [];
                    photosByDate[c.date].push(c);
                });
            }
            
            let html = `<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>${appData.trip.name || 'æˆ‘çš„æ—…ç¨‹'} - å›æ†¶éŒ„</title>
    <style>
        body { font-family: -apple-system, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        h1 { text-align: center; color: #ec4899; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
        .day { margin-bottom: 40px; }
        .day-title { color: #ec4899; font-weight: bold; font-size: 1.3em; border-bottom: 3px solid #ec4899; padding-bottom: 10px; margin-bottom: 20px; }
        .section-title { color: #a855f7; font-weight: bold; margin: 20px 0 15px 0; }
        .photo-entry { background: #fff; border-radius: 12px; overflow: hidden; margin-bottom: 15px; box-shadow: 0 2px 10px rgba(0,0,0,.1); }
        .photo-entry img { width: 100%; max-height: 400px; object-fit: cover; }
        .photo-entry-content { padding: 15px; }
        .photo-entry-spot { font-weight: bold; margin-bottom: 8px; }
        .photo-entry-note { color: #666; }
        .diary-entry { background: #fdf2f8; border-left: 4px solid #ec4899; padding: 15px; margin: 10px 0; border-radius: 0 8px 8px 0; }
        .diary-mood { font-size: 1.3em; margin-bottom: 5px; }
        .diary-time { color: #999; font-size: 0.85em; }
        .diary-content { margin-top: 10px; white-space: pre-wrap; }
        .stats { display: flex; justify-content: center; gap: 30px; margin-bottom: 30px; }
        .stat { text-align: center; }
        .stat-value { font-size: 2em; font-weight: bold; color: #ec4899; }
        .stat-label { color: #666; font-size: 0.9em; }
        .badges { margin-top: 30px; padding: 20px; background: #fff; border-radius: 12px; }
        .badge { display: inline-block; margin: 5px; padding: 8px 15px; background: linear-gradient(135deg, #ec4899, #a855f7); color: #fff; border-radius: 20px; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>ğŸ“¸ ${appData.trip.name || 'æˆ‘çš„æ—…ç¨‹'}</h1>
    <p class="subtitle">${appData.trip.destination ? 'ğŸ“ ' + appData.trip.destination + ' â€¢ ' : ''}${appData.trip.startDate ? formatDate(new Date(appData.trip.startDate)) + ' - ' + formatDate(new Date(appData.trip.endDate)) : ''}</p>
    
    <div class="stats">
        <div class="stat"><div class="stat-value">${appData.checkins?.length || 0}</div><div class="stat-label">å¼µç…§ç‰‡</div></div>
        <div class="stat"><div class="stat-value">${appData.spots?.filter(s => s.checked).length || 0}</div><div class="stat-label">å€‹æ™¯é»</div></div>
        <div class="stat"><div class="stat-value">${Object.keys(appData.badges || {}).length}</div><div class="stat-label">å€‹æˆå°±</div></div>
    </div>`;
            
            // æŒ‰æ—¥æœŸè¼¸å‡º
            sortedDates.forEach((date, i) => {
                const photos = photosByDate[date] || [];
                const notes = appData.dailyNotes?.[date] || [];
                
                html += `<div class="day"><div class="day-title">Day ${i + 1} â€¢ ${formatDate(new Date(date))}</div>`;
                
                // ç…§ç‰‡
                if (photos.length > 0) {
                    html += `<div class="section-title">ğŸ“¸ æ‰“å¡ç…§ç‰‡</div>`;
                    photos.forEach(c => {
                        html += `<div class="photo-entry"><img src="${c.photo}" alt="${c.spotName}"><div class="photo-entry-content"><div class="photo-entry-spot">ğŸ“ ${c.spotName}</div>${c.note ? `<div class="photo-entry-note">${c.note}</div>` : ''}</div></div>`;
                    });
                }
                
                // é»æ»´
                if (notes.length > 0) {
                    html += `<div class="section-title">âœï¸ æ—…éŠé»æ»´</div>`;
                    notes.forEach(note => {
                        html += `<div class="diary-entry"><div class="diary-mood">${note.mood} <span class="diary-time">ğŸ• ${note.time}</span></div><div class="diary-content">${note.content}</div></div>`;
                    });
                }
                
                html += `</div>`;
            });
            
            // æˆå°±
            const unlockedBadges = CHECKIN_BADGES.filter(b => appData.badges?.[b.id]);
            if (unlockedBadges.length > 0) {
                html += `<div class="badges"><h3>ğŸ† ç²å¾—çš„æˆå°±</h3>`;
                unlockedBadges.forEach(b => {
                    html += `<span class="badge">${b.icon} ${b.name}</span>`;
                });
                html += `</div>`;
            }
            
            html += `<p style="text-align:center;color:#999;margin-top:40px;font-size:0.85em;">ğŸ“¸ æ—…éŠå›æ†¶éŒ„ç”±ã€Œæ—…éŠç§˜æ›¸ã€åŒ¯å‡º â€¢ ${new Date().toLocaleString('zh-TW')}</p></body></html>`;
            
            const blob = new Blob([html], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `${appData.trip.name || 'æ—…éŠå›æ†¶éŒ„'}_${new Date().toISOString().split('T')[0]}.html`;
            a.click();
            URL.revokeObjectURL(a.href);
            showToast('å›æ†¶éŒ„å·²åŒ¯å‡º ğŸ“–', 'success');
        }
        
        // ğŸ—‘ï¸ æ¸…é™¤æ‰“å¡å›æ†¶ï¼ˆç”¨æˆ¶ä¸»å‹•æ“ä½œï¼‰
        function clearCheckinMemories() {
            const photoCount = appData.checkins?.length || 0;
            const spotCount = appData.spots?.length || 0;
            const badgeCount = Object.keys(appData.badges || {}).length;
            
            if (photoCount === 0 && spotCount === 0 && badgeCount === 0) {
                showToast('æ²’æœ‰æ‰“å¡å›æ†¶éœ€è¦æ¸…é™¤', 'info');
                return;
            }
            
            const msg = `âš ï¸ ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰æ‰“å¡å›æ†¶å—ï¼Ÿ\n\n` +
                `å³å°‡åˆªé™¤ï¼š\n` +
                `${photoCount > 0 ? `â€¢ ${photoCount} å¼µæ‰“å¡ç…§ç‰‡\n` : ''}` +
                `${spotCount > 0 ? `â€¢ ${spotCount} å€‹æ™¯é»è¨˜éŒ„\n` : ''}` +
                `${badgeCount > 0 ? `â€¢ ${badgeCount} å€‹æˆå°±å¾½ç« \n` : ''}` +
                `\nğŸ’¡ å»ºè­°å…ˆåŒ¯å‡º HTML å›æ†¶éŒ„ä¿å­˜ï¼\n\næ­¤æ“ä½œç„¡æ³•å¾©åŸï¼`;
            
            if (!confirm(msg)) return;
            if (!confirm('å†æ¬¡ç¢ºèªï¼šçœŸçš„è¦åˆªé™¤æ‰€æœ‰æ‰“å¡å›æ†¶å—ï¼Ÿ')) return;
            
            appData.spots = [];
            appData.checkins = [];
            appData.badges = {};
            saveData();
            renderCheckinPage();
            showToast('å·²æ¸…é™¤æ‰€æœ‰æ‰“å¡å›æ†¶', 'success');
        }
        
        // ğŸ“ åŒ¯å‡ºå›æ†¶éŒ„åˆ° Google Docï¼ˆå«ç…§ç‰‡å’Œæ—…éŠé»æ»´ï¼‰
        async function exportMemoirToGoogleDoc() {
            const token = getStoredToken();
            if (!token) {
                showToast('è«‹å…ˆæˆæ¬Š Google å¸³è™Ÿ', 'error');
                return;
            }
            
            const hasCheckins = appData.checkins && appData.checkins.length > 0;
            const hasNotes = appData.dailyNotes && Object.keys(appData.dailyNotes).length > 0;
            
            if (!hasCheckins && !hasNotes) {
                showToast('æ²’æœ‰å›æ†¶å¯åŒ¯å‡º', 'error');
                return;
            }
            
            showToast('ğŸ“ æ­£åœ¨åŒ¯å‡ºåˆ° Google Docï¼ˆå«ç…§ç‰‡ï¼‰...', 'info');
            
            try {
                const trip = appData.trip;
                const docTitle = `${trip.name || 'æ—…éŠå›æ†¶éŒ„'} - ${new Date().toLocaleDateString('zh-TW')}`;
                
                // æ”¶é›†æ‰€æœ‰æ—¥æœŸ
                const allDates = new Set();
                if (hasCheckins) appData.checkins.forEach(c => allDates.add(c.date));
                if (hasNotes) Object.keys(appData.dailyNotes).forEach(d => allDates.add(d));
                const sortedDates = Array.from(allDates).sort((a, b) => new Date(a) - new Date(b));
                
                // åˆ†çµ„æ‰“å¡ç…§ç‰‡
                const photosByDate = {};
                if (hasCheckins) {
                    appData.checkins.forEach(c => {
                        if (!photosByDate[c.date]) photosByDate[c.date] = [];
                        photosByDate[c.date].push(c);
                    });
                }
                
                // çµ„åˆ HTML å…§å®¹ï¼ˆå«ç…§ç‰‡ï¼‰
                let htmlContent = `
                    <html><head><meta charset="utf-8"></head>
                    <body style="font-family: Arial, sans-serif; line-height: 1.8; max-width: 800px; margin: 0 auto;">
                    <h1 style="color: #ec4899; border-bottom: 3px solid #ec4899; padding-bottom: 10px; text-align: center;">
                        ğŸ“¸ ${trip.name || 'æˆ‘çš„æ—…éŠå›æ†¶'}
                    </h1>
                    <p style="color: #666; text-align: center; margin-bottom: 30px;">
                        ${trip.destination ? 'ğŸ“ ' + trip.destination : ''} 
                        ${trip.startDate ? 'â€¢ ' + formatDate(new Date(trip.startDate)) + ' - ' + formatDate(new Date(trip.endDate)) : ''}
                    </p>
                    
                    <table style="width: 100%; margin-bottom: 30px;">
                        <tr>
                            <td style="text-align: center; padding: 15px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ec4899;">${appData.checkins?.length || 0}</div>
                                <div style="color: #666;">å¼µç…§ç‰‡</div>
                            </td>
                            <td style="text-align: center; padding: 15px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ffd700;">${appData.spots?.filter(s => s.checked).length || 0}</div>
                                <div style="color: #666;">å€‹æ™¯é»</div>
                            </td>
                            <td style="text-align: center; padding: 15px;">
                                <div style="font-size: 2em; font-weight: bold; color: #06b6d4;">${Object.keys(appData.badges || {}).length}</div>
                                <div style="color: #666;">å€‹æˆå°±</div>
                            </td>
                        </tr>
                    </table>
                    <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 30px 0;">
                `;
                
                // æŒ‰æ—¥æœŸè¼¸å‡º
                sortedDates.forEach((date, dayIndex) => {
                    const photos = photosByDate[date] || [];
                    const notes = appData.dailyNotes?.[date] || [];
                    
                    htmlContent += `
                        <h2 style="color: #a855f7; margin-top: 40px; border-bottom: 2px solid #a855f7; padding-bottom: 8px;">
                            Day ${dayIndex + 1} â€¢ ${formatDate(new Date(date))}
                        </h2>
                    `;
                    
                    // ğŸ“¸ æ‰“å¡ç…§ç‰‡ï¼ˆå«åœ–ç‰‡ï¼‰
                    if (photos.length > 0) {
                        htmlContent += `<h3 style="color: #ec4899;">ğŸ“¸ æ‰“å¡ç…§ç‰‡</h3>`;
                        photos.forEach(c => {
                            htmlContent += `
                                <div style="margin: 20px 0; background: #f8f9fa; border-radius: 12px; overflow: hidden;">
                                    <img src="${c.photo}" style="width: 100%; max-height: 400px; object-fit: cover; display: block;">
                                    <div style="padding: 15px;">
                                        <div style="font-weight: bold; font-size: 1.1em; margin-bottom: 8px;">ğŸ“ ${c.spotName}</div>
                                        ${c.note ? `<div style="color: #666;">${escapeHtml(c.note)}</div>` : ''}
                                    </div>
                                </div>
                            `;
                        });
                    }
                    
                    // âœï¸ æ—…éŠé»æ»´
                    if (notes.length > 0) {
                        htmlContent += `<h3 style="color: #06b6d4;">âœï¸ æ—…éŠé»æ»´</h3>`;
                        notes.forEach(note => {
                            htmlContent += `
                                <div style="background: #fdf2f8; border-left: 4px solid #ec4899; padding: 15px; margin: 15px 0; border-radius: 0 8px 8px 0;">
                                    <div style="font-size: 1.3em; margin-bottom: 8px;">
                                        ${note.mood} <span style="color: #999; font-size: 0.7em;">ğŸ• ${note.time}</span>
                                    </div>
                                    <div style="white-space: pre-wrap; line-height: 1.6;">${escapeHtml(note.content)}</div>
                                </div>
                            `;
                        });
                    }
                });
                
                // ğŸ† æˆå°±
                const unlockedBadges = CHECKIN_BADGES.filter(b => appData.badges?.[b.id]);
                if (unlockedBadges.length > 0) {
                    htmlContent += `
                        <h2 style="color: #ffd700; margin-top: 40px;">ğŸ† ç²å¾—çš„æˆå°±</h2>
                        <table style="width: 100%;">
                    `;
                    unlockedBadges.forEach(badge => {
                        htmlContent += `
                            <tr>
                                <td style="padding: 10px; font-size: 1.5em;">${badge.icon}</td>
                                <td style="padding: 10px;">
                                    <strong>${badge.name}</strong><br>
                                    <span style="color: #666; font-size: 0.9em;">${badge.desc}</span>
                                </td>
                            </tr>
                        `;
                    });
                    htmlContent += `</table>`;
                }
                
                // çµå°¾
                htmlContent += `
                    <hr style="border: none; border-top: 2px solid #e2e8f0; margin: 40px 0 20px 0;">
                    <p style="text-align: center; color: #999; font-size: 0.85em;">
                        ğŸ“¸ æ—…éŠå›æ†¶éŒ„ç”±ã€Œæ—…éŠç§˜æ›¸ã€åŒ¯å‡º<br>
                        ğŸ“… ${new Date().toLocaleString('zh-TW')}
                    </p>
                    </body></html>
                `;
                
                // å»ºç«‹ Google Doc
                const metadata = { name: docTitle, mimeType: 'application/vnd.google-apps.document' };
                const boundary = '-------314159265358979323846';
                const multipartBody = 
                    '\r\n--' + boundary + '\r\n' +
                    'Content-Type: application/json\r\n\r\n' +
                    JSON.stringify(metadata) +
                    '\r\n--' + boundary + '\r\n' +
                    'Content-Type: text/html\r\n\r\n' +
                    htmlContent +
                    '\r\n--' + boundary + '--';
                
                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token.access_token,
                        'Content-Type': 'multipart/related; boundary="' + boundary + '"'
                    },
                    body: multipartBody
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'å»ºç«‹å¤±æ•—');
                }
                
                const result = await response.json();
                const docUrl = `https://docs.google.com/document/d/${result.id}/edit`;
                
                showDocLinkModal(docTitle, docUrl);
                
            } catch (error) {
                console.error('åŒ¯å‡ºå¤±æ•—:', error);
                showToast('åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
            }
        }
        
        // ğŸ“¸ ä¸‹è¼‰æ‰€æœ‰ç…§ç‰‡ï¼ˆZIP æ‰“åŒ…ï¼‰
        async function downloadAllPhotos() {
            if (!appData.checkins || appData.checkins.length === 0) {
                showToast('æ²’æœ‰ç…§ç‰‡å¯ä¸‹è¼‰', 'error');
                return;
            }
            
            // æª¢æŸ¥ JSZip æ˜¯å¦è¼‰å…¥
            if (typeof JSZip === 'undefined') {
                showToast('æ­£åœ¨è¼‰å…¥æ‰“åŒ…å·¥å…·...', 'info');
                // å˜—è©¦å‹•æ…‹è¼‰å…¥
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js';
                script.onload = () => downloadAllPhotos();
                document.head.appendChild(script);
                return;
            }
            
            showToast('ğŸ“¦ æ­£åœ¨æ‰“åŒ…ç…§ç‰‡...', 'info');
            
            try {
                const zip = new JSZip();
                const folder = zip.folder(appData.trip.name || 'æ—…éŠç…§ç‰‡');
                
                // æŒ‰æ—¥æœŸåˆ†çµ„
                const grouped = {};
                appData.checkins.forEach(c => {
                    if (!grouped[c.date]) grouped[c.date] = [];
                    grouped[c.date].push(c);
                });
                
                const sortedDates = Object.keys(grouped).sort((a, b) => new Date(a) - new Date(b));
                
                sortedDates.forEach((date, dayIndex) => {
                    const dayFolder = folder.folder(`Day${dayIndex + 1}_${date}`);
                    grouped[date].forEach((c, photoIndex) => {
                        // å¾ base64 è½‰æ›ç‚º blob
                        const base64Data = c.photo.split(',')[1];
                        const fileName = `${photoIndex + 1}_${c.spotName.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, '_')}.jpg`;
                        dayFolder.file(fileName, base64Data, { base64: true });
                    });
                });
                
                // ç”¢ç”Ÿ ZIP ä¸¦ä¸‹è¼‰
                const content = await zip.generateAsync({ type: 'blob' });
                const url = URL.createObjectURL(content);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${appData.trip.name || 'æ—…éŠç…§ç‰‡'}_${new Date().toISOString().split('T')[0]}.zip`;
                a.click();
                URL.revokeObjectURL(url);
                
                showToast(`âœ… å·²æ‰“åŒ… ${appData.checkins.length} å¼µç…§ç‰‡`, 'success');
                
            } catch (error) {
                console.error('æ‰“åŒ…å¤±æ•—:', error);
                showToast('æ‰“åŒ…å¤±æ•—ï¼š' + error.message, 'error');
            }
        }
    </script>
</body>
</html>
